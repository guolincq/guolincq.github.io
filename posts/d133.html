<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guolincq.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="photometric correction： 将反射率校正到相同的光照几何条件下，一般为入射角30°，出射角0°（NASA实验室所采用的）。比值法  R_{f-\text {corrected}}&#x3D;R_{f} \frac{\cos 30^{\circ} &#x2F;\left(\cos 30^{\circ}+\cos 0^{\circ}\right)}{\cos i^{\prime} &#x2F;\left(\co">
<meta property="og:type" content="article">
<meta property="og:title" content="Hapke函数">
<meta property="og:url" content="https://guolincq.github.io/posts/d133.html">
<meta property="og:site_name" content="Growing">
<meta property="og:description" content="photometric correction： 将反射率校正到相同的光照几何条件下，一般为入射角30°，出射角0°（NASA实验室所采用的）。比值法  R_{f-\text {corrected}}&#x3D;R_{f} \frac{\cos 30^{\circ} &#x2F;\left(\cos 30^{\circ}+\cos 0^{\circ}\right)}{\cos i^{\prime} &#x2F;\left(\co">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599184667796-1599184667978.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/image-20191203192523571-1599185186884.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599186970690-1599186970691.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599187032691-1599187032692.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/image-20201020210908801-1608690280317.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599186729747-1599186729748.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142037383-1599142037466.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142094855-1599142094855.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142116109-1599142116110.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/1608696754062-1608696754064.png">
<meta property="og:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/1608702945384-1608702945385.png">
<meta property="article:published_time" content="2021-12-15T08:25:45.000Z">
<meta property="article:modified_time" content="2021-12-15T09:10:46.807Z">
<meta property="article:author" content="Lin Guo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599184667796-1599184667978.png">

<link rel="canonical" href="https://guolincq.github.io/posts/d133.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Hapke函数 | Growing</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Growing</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">日拱一卒。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-pdf">

    <a href="/book/" rel="section"><i class="fa fa-file-pdf fa-fw"></i>PDF</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://guolincq.github.io/posts/d133.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/48752043?v=4">
      <meta itemprop="name" content="Lin Guo">
      <meta itemprop="description" content="怕什么真理无穷，进一寸有进一寸的欢喜。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Growing">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hapke函数
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-15 16:25:45 / 修改时间：17:10:46" itemprop="dateCreated datePublished" datetime="2021-12-15T16:25:45+08:00">2021-12-15</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>photometric correction</strong>： 将反射率校正到相同的光照几何条件下，一般为入射角30°，出射角0°（NASA实验室所采用的）。比值法</p>
<script type="math/tex; mode=display">
R_{f-\text {corrected}}=R_{f} \frac{\cos 30^{\circ} /\left(\cos 30^{\circ}+\cos 0^{\circ}\right)}{\cos i^{\prime} /\left(\cos i^{\prime}+\cos e^{\prime}\right)} \frac{f\left(30^{\circ}\right)}{f(g)}</script><ul>
<li>REFF（Reflectance factor）: solar irradiance calibration method</li>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599184667796-1599184667978.png" alt="title"></li>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/image-20191203192523571-1599185186884.png" alt="title"></li>
</ul>
<ul>
<li>经验公式：</li>
</ul>
<blockquote>
<p>注：有两种方法获取绝对反射率</p>
<ul>
<li>定标板</li>
<li>太阳辐照度定标方法</li>
</ul>
</blockquote>
<ul>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599186970690-1599186970691.png" alt="title"></li>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599187032691-1599187032692.png" alt="title"></li>
<li>光度校正的公式（注意式子中的约等号）</li>
<li>用Hapke光度模型可以作光度校正，可以反解物性。</li>
</ul>
<hr>
<ul>
<li>月表光度模型研究进展（许学森，遥感技术与应用）</li>
</ul>
<blockquote>
<ol>
<li>经验模型(hapke8.5节)</li>
<li>几何光学模型</li>
<li>辐射传输模型:Hapke光度模型</li>
<li>计算机数值模拟方法： 蒙托卡罗数值模拟方法</li>
</ol>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/image-20201020210908801-1608690280317.png" alt=""></p>
<hr>
<p><strong>Hapke’s photometric model</strong>（地大师姐推荐文章(Sato, Robinson et al. 2014)）：也见（Hapke书9.4节（9.47）式）</p>
<script type="math/tex; mode=display">
I / F=L S\left(i_{e}, e_{e}\right) K \frac{w}{4}\left[p(g)\left(1+B_{S 0} B_{S}(g)\right)+M\left(i_{e}, e_{e}\right)\right]\left[1+B_{C 0} B_{C}(g)\right] S(i, e, \psi)</script><blockquote>
<p>注：$I/F$为radiance factor，而reflectance factor(REFF)为${I/F\over \pi}$,这里的I/F就是一种表示方法（RADF），不要分开看。</p>
<ol>
<li>LS is the Lommel-Seeliger function,$i_e$ and $e_e$ are effective angle of incidence and emission respectively</li>
<li>K is porosity factor,$\phi$,[0,1]</li>
<li>w is single scattering albedo,[0,1]</li>
<li>p(g) is phase function:b,c；The probability that a photon will be scattered in the direction g is given by p(g)。b,[0,1];c,p(g)&gt;0;</li>
<li>$B_{S0}$ is amplitude of Shadow Hiding Opposition Effect (SHOE),Bs,[0,1]</li>
<li>$B_S(g)$ is SHOE function,$h_S$</li>
<li>$M(i_e, e_e)$ is Isotropic Multiple-Scattering Approximation (IMSA)</li>
<li>$B_{C0}$ is amplitude of Coherent Backscatter Opposition Effect (CBOE)，[0,1]</li>
<li>$B_C(g)$ is CBOE function,$h_C$</li>
<li><code>S(i,e,𝜓)</code> is shadowing function, and 𝜓 is azimuthal angle between the planes of incidence and emergence；The term $\bar{\theta}_p$ is the shadowing function and corrects for macroscopic roughness of the surface and depends on mean slope angle 𝜃.</li>
</ol>
</blockquote>
<ol>
<li>Henyey-Greenstein double-lobed single particle phase function</li>
</ol>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b (0 ≤ b ≤ 1) is the shape-controlling parameter, and c (−1 ≤ c ≤ 1) is the relative strength of backward and forward lobes.<br>b is the angular width of the backward (first term) or forward (second term) scattering lobe and c is the magnitude of the lobe.<br>c&gt;0,后向；c&lt;0 前向</p>
<p>b控制形状：b越大，侧向散射越弱（b=1例外）</p>
<p>$p(g)=1$ 表示各向同性；$p(g)\neq 1$ 表示各项异性；$p(g) =0$ 表示完全吸收。</p>
<ul>
<li>‘hockey-stick” diagram</li>
</ul>
<script type="math/tex; mode=display">
c=3.29 \exp \left(-17.4 b^{2}\right)-0.908</script><p>Narrow lobes have b values close to 1, wide lobes have values &lt;&lt; 1, and isotropically scattering particles have b = 0; 0 &lt;= b &lt; 1.</p>
<p>Hapke2012,p121</p>
</blockquote>
<ol>
<li>The SHOE function BS(g) is given by</li>
</ol>
<script type="math/tex; mode=display">
B_{S}(g)=1 /\left[1+\tan (g / 2) / h_{S}\right]</script><blockquote>
<p>$h_S$ is the angular width parameter of SHOE,</p>
</blockquote>
<ol>
<li>The IMSA function $M(i_e, e_e)$ is given by</li>
</ol>
<script type="math/tex; mode=display">
M\left(i_{e}, e_{e}\right)=H\left(\frac{\cos \left(i_{e}\right)}{K}, w\right) H\left(\frac{\cos \left(e_{e}\right)}{K}, w\right)-1</script><blockquote>
<p>where H(x,w) is Ambartsumian-Chandrasekhar H function, which is approximated by</p>
<script type="math/tex; mode=display">
H(x, w) \simeq\left\{1-w x\left[r_{0}+\frac{1-2 r_{0} x}{2} \ln \left(\frac{1+x}{x}\right)\right]\right\}^{-1}</script><p>简化版：</p>
<script type="math/tex; mode=display">H(x)={1+2x\over 1+2\gamma x}</script><p>$r_0$ is diffusive reflectance, given by</p>
<script type="math/tex; mode=display">
r_{0}=\frac{1-\sqrt{1-w}}{1+\sqrt{1-w}}</script></blockquote>
<ol>
<li>The CBOE function $B_C(g)$ is given by</li>
</ol>
<script type="math/tex; mode=display">
B_{C}(g)=\frac{1+\frac{1-\exp \left[-\tan (g / 2) / h_{C}\right]}{\tan (g / 2) / h_{C}}}{2\left[1+\tan (g / 2) / h_{C}\right]^{2}}</script><blockquote>
<p>where $h_C$ is angular width of CBOE</p>
<ul>
<li>$h_C = \lambda/4\pi\Lambda$;$\Lambda$ is the transport mean free path in the medium.</li>
</ul>
</blockquote>
<ol>
<li>The porosity factor K is</li>
</ol>
<script type="math/tex; mode=display">
K=\frac{-\ln \left(1-1.209 \phi^{2 / 3}\right)}{1.209 \phi^{2 / 3}}</script><blockquote>
<p>where 𝜙 is filling factor that is equivalent to 1− porosity. The K monotonically increases with the filling factor 𝜙 (= 1− porosity)</p>
<p>孔隙度因子K不同于孔隙度（porosity）</p>
</blockquote>
<ol>
<li>The $i_e, e_e,$(注：下标e表示effective) and the <strong>shadowing function</strong> S(i, e,𝜓) are the functions of $\bar{\theta}_p$ (the mean slope angle), the effective value of the photometric roughness.宏观粗糙度。</li>
</ol>
<p>公式很复杂，待补充</p>
<p>拟合数据得到如上九个参数，这些参数中有些与物性有关</p>
<p><strong>简化的5参数Hapke模型(地大师姐)</strong>：SHOE-only.</p>
<script type="math/tex; mode=display">
I / F={\cos i \over \cos i+\cos e}\frac{w}{4}\left[p(g)\left(1+{B_{S 0} \over 1+\tan(g/2)/h_S}\right)+H(\cos i)H(\cos e)-1\right]</script><blockquote>
<p>参数范围：0≤b≤1，-1≤c≤1，0≤w≤1，$0\leq B_{S0} \leq 2$，$0\leq h_S \leq 1$</p>
</blockquote>
<p>或者，CBOE-only</p>
<blockquote>
<p>在不同的应用场景下，SHOE与CBOE对opposition effects 的贡献不一样，因此，按需选择。得到5参数的hapke模型</p>
</blockquote>
<script type="math/tex; mode=display">
\begin{aligned}
\begin{array}{l}
\text {IOF} / L S=\frac{w}{4}\left[p(g)+H\left(\mu_{0}, w\right) H(\mu, w)-1\right]\left[1+B_{C 0} B_{C}\left(g, h_{c}\right)\right] S(i, e, \theta) \\
L S=\mu_{0} /\left(\mu_{0}+\mu\right)
\end{array}
\end{aligned}</script><p><strong>简化hapke模型（林洪磊）:仅3个参数，w,b,c</strong></p>
<blockquote>
<p>不考虑冲效应，但考虑多次散射，因此得到3参数的hapke模型，</p>
<p>K= 1，因为月壤最上层的填充率未知</p>
<p>忽略SHOE和COBE，因为冲效应仅仅发生在小相角处，而第十月昼的相角大于50°</p>
</blockquote>
<script type="math/tex; mode=display">
r={\cos i \over \cos i+\cos e}\frac{w}{4\pi}\left[p(g)+H(\cos i)H(\cos e)-1\right]</script><p><strong>若继续不考虑多次散射，则，hapke模型简化为LS模型</strong></p>
<p>Hapke,2012:</p>
<ul>
<li>Single scattering:the Lommel-Seeliger law（p197)</li>
</ul>
<p>$r = {\varpi \over 4\pi}{\mu_0 \over \mu_0 +\mu}f(g)$</p>
<ul>
<li>the bidirectional reflectance of a sparse medium of isotropic scatters(p197)</li>
</ul>
<p>二流近似</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}{1+2\mu_0 \over 1+2\gamma\mu_0}{1+2\mu \over 1+2\gamma\mu}$</p>
<p>变分法</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}H(\mu_0)H(\mu)$</p>
<ul>
<li>the isotropic multiple-scattering approximation(IMSA)</li>
</ul>
<p>$I_{SS} = J{\varpi \over 4\pi}{\mu_0 \over \mu_0 +\mu}p(g)$</p>
<p>$I_{MS} = J{\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}[H(\mu_0)H(\mu)-1]$</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}[p(g)+H(\mu_0)H(\mu)-1]$</p>
<p>for  a semi-infinite medium, the multiply scattered portion is much less sensitive to the particle phase function than the singly scattered fraction.</p>
<p>The brighter the surface, the more times the average photon is scattered before emerging from the surface, causing directional effects to be averaged out and the multiply scattered intensity distribution to closely approach the isotropic case.</p>
<p>Since the single-scattering term can be evaluated exactly for an arbitrary phase function and the multiply scattered term is relatively insensitive to phase function, a first-order expression for nonisotropic scatterers can be obtained by using the exact expression for the single-scattered term but retaining the isotropic solution for the multiply-scattered term.</p>
<p>多次散射项不像单次散射项那样对相函数明显，通常，表面越亮，多次散射的次数越多，其方向性就被平均掉了，所以一般多次散射项都当做各向同性处理。</p>
<hr>
<p>一些光度校正的实操论文</p>
<p>问题：参数拟合的数学实现以及遇见的一些细节问题</p>
<ol>
<li>python拟合函数curve_fit</li>
</ol>
<ul>
<li>参数初始值问题：若不给初值，也不给边界，则初值默认为1；若不给初值，但给定边界，则初值为边界中点。</li>
</ul>
<ol>
<li>python 其他函数</li>
</ol>
<hr>
<p>lunar opposition effect（Hapke第九章）</p>
<ul>
<li>shadow hiding（占主要）：shadow-hiding mechanism in which particles hide their own shadows at opposition but the shadows quickly become visible as one moves away from opposition（clementine Hillier 1999）</li>
<li>相干反向散射coherent backscatter（2°左右的窄峰）： photons following identical but reversed paths can interfere constructively in the backscattering direction, leading to up to a factor of two increase in brightness.</li>
<li>具有波长依赖性</li>
<li>the angular width of the coherent backscatter peak should be proportional to wavelength, it is inversely proportional to the mean optical path length of a photon (which will be smaller in lower albedo surfaces)</li>
<li>相干反向散射对更亮的高地地形更重要</li>
</ul>
<p>ground truth: Apollo site</p>
<p>photometric model 可反演月壤的物理性质</p>
<ul>
<li>compaction state</li>
<li>particle albedo</li>
<li>particle size</li>
<li>size distribution</li>
<li>surface macroscopic roughness</li>
<li>grain transparency</li>
<li>porosity</li>
<li>光度模型可以反演上述参数，然后用反演的参数与Apollo的“真值”对比，可以检验光度模型理论</li>
<li>相对定标：矿物学研究</li>
<li>绝对定标： 光度研究、</li>
</ul>
<p><strong>从反射率光谱获取矿物成分：</strong></p>
<ul>
<li>查找表（lunar spectral mineral lookup table，LUT）</li>
<li>MGM(修正高斯模型)</li>
<li>其他？<br>实操过程：<img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599186729747-1599186729748.png" alt="title"></li>
</ul>
<hr>
<p>光度校正公式（前经验）：</p>
<p>Scattering Law Analysis Based on Hapke and Lommel-Seeliger Models for Asteroidal Taxonomy<br>Hapke-5parameters</p>
<script type="math/tex; mode=display">
\begin{aligned}
RADF(i, e, \alpha)&=\frac{\omega}{4} \frac{\mu_{0}}{\mu_{0}+\mu} \\\\
& \times\left\{[1+B(\alpha)] p(\alpha)+H\left(\mu_{0}\right) H(\mu)-1\right\} \\\\
& \times S(i, e, \alpha, \bar{\theta}) \\\\
B(\alpha)&=\frac{B_{\mathrm{so}}}{1+\frac{1}{h_{\mathrm{s}}} \tan \frac{\alpha}{2}} \\\\
p(\alpha)&=\frac{1-g^{2}}{\left(1+2 g \cos \alpha+g^{2}\right)^{\frac{3}{2}}} \\\\
H(x)&=\frac{1+2 x}{1+2 \sqrt{1-\omega} x}
\end{aligned}</script><p>-LS模型</p>
<script type="math/tex; mode=display">
\begin{aligned}
r(i, e, \alpha)&=A_{\mathrm{ls}} \frac{\mu_{0}}{\mu_{0}+\mu} f(\alpha)\\\\
A_{ls} &={\omega \over 4\pi}\\\\
f(\alpha)&=e^{\beta \alpha+\gamma \alpha^{2}+\delta \alpha^{3}}\\\\
RADF(i,e,\alpha)&= \pi r(i,e,g)
\end{aligned}</script><hr>
<p>光度校正的关键在于获取相函数及其参数。</p>
<p>获取相函数的两种模型：</p>
<ul>
<li>Hapke模型</li>
<li>LS模型</li>
</ul>
<p>相函数有多种形式：</p>
<ul>
<li>HG函数；</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b = −0.17, c = 0.70。</p>
</blockquote>
<ul>
<li>单参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>$(1/4\pi)\int_{4\pi}p(g)d\Omega = 1$</li>
<li>$\theta = \pi - g$</li>
<li>参数b为余弦不对称因子：$b = &lt;\cos \theta&gt;=-&lt;\cos g&gt;$</li>
<li>b=0时，$p(g)=1$,各向同性</li>
<li>b&gt;0时，</li>
</ul>
</blockquote>
<ul>
<li>双参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>第一项为后向项，第二项为前向项；</li>
</ul>
</blockquote>
<ul>
<li>三参数HG函数：$b_1,b_2,c$</li>
</ul>
<ul>
<li>普通多项式（三阶）</li>
</ul>
<script type="math/tex; mode=display">
f(g)=p_{1} g^{3}+p_{2} g^{2}+p_{3} g+p_{4}</script><ul>
<li>普通多项式（四阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>普通多项式（六阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha, \lambda)=\mathrm{A}_{0}+\mathrm{A}_{1} \alpha+\mathrm{A}_{2} \mathrm{a}^{2}+\mathrm{A}_{3} \mathrm{\alpha}^{3}+\mathrm{A}_{4} \mathrm{\alpha}^{4}+\mathrm{A}_{5} \mathrm{\alpha}^{5}+\mathrm{A}_{6} \mathrm{\alpha}^{6}</script><ul>
<li>普通多项式+指数项（指数项模拟背散射效应）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=b_{0} e^{-b_{1} \alpha}+a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>勒让德多项式</li>
</ul>
<script type="math/tex; mode=display">
P(g)=1+b \times \cos (g)+c \times\left(1.5 \times \cos ^{2}(g)-0.5\right)</script><p>$P_1 = \cos \theta; P_2 = {1\over 2}(3\cos^2\theta -1)$</p>
<ul>
<li>指数形式</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=e^{\beta \alpha+\gamma \alpha^{2}+\delta \alpha^{3}}</script><ul>
<li>其他形式：</li>
</ul>
<blockquote>
<p>三阶多项式<br>一阶勒让德多项式<br>线性双项HG函数？</p>
</blockquote>
<p><strong>基于得到的相函数做光度校正</strong>：</p>
<ul>
<li>比值法</li>
<li>解单次反照率：因为多次散射项中包含单次反照率，因此不能直接作比。</li>
</ul>
<blockquote>
<p>以上所有相函数都可用比值法，但HG函数和勒让德多项式来源于Hapke模型，因此还可以基于hapke模型作光度校正</p>
</blockquote>
<hr>
<p>光度校正历史</p>
<ul>
<li>Clementine （Hiller et al,1999）</li>
</ul>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142037383-1599142037466.png" alt="title"></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142094855-1599142094855.png" alt="title"></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142116109-1599142116110.png" alt="title"></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/1608696754062-1608696754064.png" alt=""></p>
<ul>
<li>M3</li>
<li>SELENE</li>
<li>CE-1</li>
<li>CE-3</li>
<li>CE-4</li>
</ul>
<p>几组HG函数参数：</p>
<ul>
<li>b = −0.17， c = 0.70。</li>
</ul>
<blockquote>
<p>(Yang,Yazhou,2020;Lin,Honglei,2020)<br>CE-4,第十月昼</p>
</blockquote>
<ul>
<li>b = −0.4, c = 0.25。</li>
</ul>
<blockquote>
<p>(lucey,1998)<br>假定参数</p>
</blockquote>
<ul>
<li>b=0.3,c =0.08</li>
</ul>
<blockquote>
<p>(Jin,Weidong,2015)<br>CE-3,全景相机，460nm,9参数Hapke模型<br>若使用5参数Hapke模型，b=0.32,c=-0.17</p>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/1608702945384-1608702945385.png" alt="HG"></p>
<p>待办</p>
<ul>
<li>[ ] 光度模型溯源文章</li>
<li>[ ] 光端校正文章内容</li>
<li>[ ] hapke模型</li>
</ul>
<p><strong>hapke模型的拟合</strong></p>
<ul>
<li>前人怎么拟合的<blockquote>
<p>网格搜索；遗传算法；查找表，等！</p>
</blockquote>
</li>
<li>求解全局最小的算法及其原理！</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/2e1f.html" rel="prev" title="误差传递公式">
      <i class="fa fa-chevron-left"></i> 误差传递公式
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/5d66.html" rel="next" title="Hapke Model">
      Hapke Model <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Lin Guo"
      src="https://avatars.githubusercontent.com/u/48752043?v=4">
  <p class="site-author-name" itemprop="name">Lin Guo</p>
  <div class="site-description" itemprop="description">怕什么真理无穷，进一寸有进一寸的欢喜。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/guolincq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;guolincq" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:guolin_cq@163.com" title="E-Mail → mailto:guolin_cq@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lin Guo</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">206k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">3:07</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("08/10/2021 12:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
    setInterval("createtime()",250);
</script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span><br></span>	

<span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
</span>
<span>总访客&nbsp<span id="busuanzi_value_site_uv"></span>&nbsp人</span>
    <span class="post-meta-divider">|</span>
<span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
</span>
    <span>总访问量&nbsp<span id="busuanzi_value_site_pv"></span>&nbsp次</span>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
