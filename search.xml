<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>中文测试</title>
    <url>/posts/5289.html</url>
    <content><![CDATA[<p>markdown 测试文档</p>
<h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><ul>
<li>无序列表</li>
<li>无序列表</li>
<li>无序列表</li>
</ul>
<ol>
<li>有序列表</li>
<li>有序列表</li>
</ol>
<p>-[ ] 待办<br>-[x] 已完成</p>
<ul>
<li>python 代码</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hello,world&#x27;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>引用块</li>
</ul>
<blockquote>
<p>引用块</p>
</blockquote>
<ul>
<li>公式</li>
</ul>
<p>$\alpha = \beta$</p>
]]></content>
  </entry>
  <entry>
    <title>Reading</title>
    <url>/posts/0.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>关于个人网站的学习资源总结</title>
    <url>/posts/hexo.html</url>
    <content><![CDATA[<h2 id="1-博客：github-hexo"><a href="#1-博客：github-hexo" class="headerlink" title="1. 博客：github+hexo"></a>1. 博客：github+hexo</h2><p><a href="https://hexo.io/zh-cn/docs/commands.html">https://hexo.io/zh-cn/docs/commands.html</a></p>
<p><a href="https://yuumiy.github.io/posts/2789.html">https://yuumiy.github.io/posts/2789.html</a></p>
<p><a href="https://www.jianshu.com/p/9b9c241146bc">https://www.jianshu.com/p/9b9c241146bc</a></p>
<p> Hexo博客写文章及基本操作 - Unity晚阳的文章 - 知乎 <a href="https://zhuanlan.zhihu.com/p/156915260">https://zhuanlan.zhihu.com/p/156915260</a></p>
<h2 id="2-个人主页：-GitHub-jekyll"><a href="#2-个人主页：-GitHub-jekyll" class="headerlink" title="2. 个人主页： GitHub + jekyll"></a>2. 个人主页： GitHub + jekyll</h2><h2 id="3-学术主页：-github-hugo-netlify"><a href="#3-学术主页：-github-hugo-netlify" class="headerlink" title="3. 学术主页： github+hugo+netlify"></a>3. 学术主页： github+hugo+netlify</h2><p> 【Hugo+Netlify】制作英文学术个人简介网站（一）：基础版 - Magical-E的文章 - 知乎 <a href="https://zhuanlan.zhihu.com/p/110137145">https://zhuanlan.zhihu.com/p/110137145</a></p>
<p><a href="https://www.bilibili.com/video/BV1iA411v7Gi/">https://www.bilibili.com/video/BV1iA411v7Gi/</a></p>
<p><a href="https://ianying.vercel.app/laymanit/">https://ianying.vercel.app/laymanit/</a></p>
]]></content>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/posts/3eeb.html</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>大气校正模型</title>
    <url>/posts/9337.html</url>
    <content><![CDATA[<h1 id="常见的辐射传输模型-Radiative-Transfer-Model-RIM"><a href="#常见的辐射传输模型-Radiative-Transfer-Model-RIM" class="headerlink" title="常见的辐射传输模型(Radiative Transfer Model, RIM)"></a>常见的辐射传输模型(Radiative Transfer Model, RIM)</h1><ul>
<li>6S:Py6S(python)</li>
<li>LOWTRAN:lowtran(python)</li>
<li>MODTRAN:MODTRAN(Fortran)</li>
<li>ATCOR</li>
<li>Fascode</li>
<li>FLAASH(IDL)</li>
</ul>
<h1 id="模型应用领域"><a href="#模型应用领域" class="headerlink" title="模型应用领域"></a>模型应用领域</h1><ul>
<li>大气校正</li>
<li>基于物理模型进行绝对辐射定标</li>
</ul>
<h1 id="模型校正原理"><a href="#模型校正原理" class="headerlink" title="模型校正原理"></a>模型校正原理</h1><h1 id="研究历史"><a href="#研究历史" class="headerlink" title="研究历史"></a>研究历史</h1><ul>
<li>Second Simulation of the Satellite Signal in the Solar Spectrum. (6S,Vermote et al.,1997)</li>
</ul>
<h1 id="程序使用教程"><a href="#程序使用教程" class="headerlink" title="程序使用教程"></a>程序使用教程</h1>]]></content>
      <tags>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>误差传递公式</title>
    <url>/posts/2e1f.html</url>
    <content><![CDATA[<ol>
<li>总的公式：</li>
</ol>
<script type="math/tex; mode=display">
z = f(x,y)</script><script type="math/tex; mode=display">
\sigma_z^2 = \left({\partial f \over \partial x}\right)^2 \sigma_x^2 + \left({\partial f \over \partial y}\right)^2 \sigma_y^2</script><ol>
<li>示例：</li>
</ol>
<script type="math/tex; mode=display">
\bar{x} = {1\over n}\sum_{i=1}^{n} x_i</script><script type="math/tex; mode=display">
\sigma_{\bar{x}} = {1\over n}\sqrt{\sum_{i=1}^{n} \sigma_{x_i}^2}</script>]]></content>
  </entry>
  <entry>
    <title>the equation of radiative transfer</title>
    <url>/posts/442f.html</url>
    <content><![CDATA[<ol>
<li>Introduction<br>In most applications of reflectance spectroscopy we are interested in the quantitative amount of light scattered by an infinitely thick layer of large particles.</li>
</ol>
<p>one way of calculating this is to consider the microscopic processes that occur when a typical particle interacts with the radiation field inside the medium.</p>
<p>Collimated light incident on the medium is <strong>partly absorbed and partly scattered</strong> by direct encounter with particles in the upper layers.</p>
<p>The light that passes between these particles and the light scattered by them illuminates the given particle where it is partly absorbed and scattered into all directions.</p>
<p>The particle is heated by the light it absorbs and emits thermal radiation.</p>
<p>Some of the radiation scattered or emitted by the particle into an upward-going direction, passes between particles and escapes from the medium.</p>
<p>It is the combined light from all the particles that escapes from the upper surface of the medium that we wish to calculate.</p>
<p>当介质与辐射场共存时，一般有如下几个物理过程:</p>
<ul>
<li>自发辐射（ spontaneous emission):介质自发地发射光子</li>
<li>吸收（ absorption):部分或全部辐射被介质吸收</li>
<li>受激辐射（ stimulated emission):辐射经过介质时激发介质产生同频率同方向的辐射。</li>
<li>散射（ scattering):入射光子与介质碰撞后改变方向甚至频率</li>
</ul>
<ol>
<li>Basic Concepts</li>
</ol>
<blockquote>
<p>Let $\bf{J}= \bf{u}_p J$, where $\bf{u}_p$ is a unit vector pointing in the direction of propagation of  $\bf{J}$.</p>
<ul>
<li>extinction cross section</li>
</ul>
<script type="math/tex; mode=display">
\sigma_E = P_E/J</script><p>power(功率，单位：W = J/s),irradiance(辐照度，单位：W/m2),所以界面的单位是面积单位，代表概率。<br>$P_E$ is the total amount of power of $\bf{J}$ that is affected by the particle.</p>
<ul>
<li>scattering cross section</li>
</ul>
<script type="math/tex; mode=display">
\sigma_S = P_S/J</script><ul>
<li>absorption cross section</li>
</ul>
<script type="math/tex; mode=display">
\sigma_A = P_A/J</script><p>An amount $P_S$ of $P_E$ is scattered into all directions, and the reminder $P_A$ is absorbed by the particle.</p>
<script type="math/tex; mode=display">
P_E = P_S + P_A\\\\
\sigma_E = \sigma_S + \sigma_A</script><ul>
<li><strong>geometrical cross-sectional area</strong></li>
</ul>
<script type="math/tex; mode=display">
\sigma = \pi a^2 \qquad \text{,where a is the particle radius.}</script><ul>
<li>extinction,scattering and absorption efficiencies</li>
</ul>
<script type="math/tex; mode=display">
Q_E = \sigma_E/\sigma,\\\\
Q_S = \sigma_S/\sigma,\\\\
Q_A = \sigma_A/\sigma,\\\\</script><script type="math/tex; mode=display">
\sigma_E = \sigma_S +\sigma_A.</script><ul>
<li>截面的单位为面积</li>
<li>系数的单位为1，如大于1，表明比粒子横截面更大范围内的入射光被吸收（散射）</li>
<li><strong>size parameter</strong>: the ratio of the circumference of the particle to the wavelength.<script type="math/tex; mode=display">
X = 2\pi a/\lambda= \pi D/\lambda.</script></li>
</ul>
</blockquote>
<p>The ratio of the total amount of power scattered to the total power  removed from the wave is the <strong>particle single-scattering albedo</strong>,$\varpi$.</p>
<script type="math/tex; mode=display">
\varpi = P_S/P_E = \sigma_S/\sigma_E=Q_S/Q_E</script><blockquote>
<p>注：很多文献中，用’A’ 表示。</p>
</blockquote>
<p><strong>spat（译作“斯帕特”） function</strong>, or the <strong>effective single-particle absorption thickness</strong></p>
<script type="math/tex; mode=display">
W = Q_A/Q_S=\frac{1-\varpi}{\varpi}</script><p>the efficiencies and the single-scattering albedo are functions of wavelength.</p>
<p>Assume that the particles are randomly oriented and positioned.<br>Let N be the number of particles per unit volume, $\sigma$ be the particle geometric cross-sectional area averaged over all orientations, $Q_E$ be their extinction efficiencies.</p>
<ul>
<li>Beer’s Law</li>
</ul>
<script type="math/tex; mode=display">{dI(s)\over ds = -I(s)N\sigma Q_E}</script><script type="math/tex; mode=display">I(S) = I(0)exp(-N\sigma Q_E s)</script><ul>
<li>extinction coefficient</li>
</ul>
<p>$E = N\sigma Q_E$</p>
<p>a mixture of different types of particles with $N_j$ particles of type j per unit volume, geometric cross sections averaged over all orieintations $σ_j$, volumes $υ_j$, and extinction, scattering and absorption efficiencies $Q_{Ej}, Q_{Aj}, and Q_{Sj}$, respectively.</p>
<ul>
<li>Number density(total numper of particles per unit volume)</li>
</ul>
<p>$N = \sum_j N_j$</p>
<blockquote>
<p>average distance $L = N^{-1/3}$</p>
</blockquote>
<ul>
<li>filling factor: the fraction of space within the medium occupied by particles.</li>
</ul>
<p>$\phi = \sum_j N_j v_j = N v$</p>
<blockquote>
<p>$v = \phi/N$ is the avarage volume of a particle.<br>$1-\phi$ is the porosity.<br>填充因子是体积比.</p>
</blockquote>
<ul>
<li>volume-average particle cross-sectional area</li>
</ul>
<p>$\sigma = \left(\sum_j N_j \sigma_j \right) /N$</p>
<blockquote>
<p>以上的定义其实是为了理解，真实情况下很难得到一个不规则粒子各个方向的最大截面积的平均值的。</p>
</blockquote>
<ul>
<li>average particle size : the diameter of an equivalent sphere with the average cross-sectional area $\sigma$</li>
</ul>
<p>$D = \sqrt{4\sigma/\pi}$</p>
<ul>
<li>volume-average extinction efficiency</li>
</ul>
<p>$E = \sum_j N_j\sigma_j Q_{Ej} = N\sigma Q_E$</p>
<blockquote>
<p>$Q_E = E/{n\sigma}$<br>volume-average absorption and scattering efficiencies in a similar way.</p>
</blockquote>
<ul>
<li>volume angular scattering coefficient</li>
</ul>
<blockquote>
<script type="math/tex; mode=display">
G(g)=\sum_j N_{j} \sigma_{j} Q_{s j} \Pi_{j}(g)=N \sigma Q_{S} p(g)=S p(g)</script></blockquote>
<ul>
<li>volume-average single-particle phase function</li>
</ul>
<blockquote>
<p>$p(g) = G(g)/S$<br>normalization condition:</p>
<script type="math/tex; mode=display">
S=(1 / 2) \int_{0}^{\pi} G(g) \sin g d g, \text { and }(1 / 2) \int_{0}^{\pi} p(g) \sin g d g=1</script></blockquote>
<ul>
<li>volume-average single scattering albedo</li>
</ul>
<p>$w = S/E$</p>
<ul>
<li>abeldo factor</li>
</ul>
<p>$\gamma = \sqrt{1-w}$</p>
<ul>
<li>volume-average asymmetry factor: the average value of the cosine of the scattering angle θ weighted by the particle phase function</li>
</ul>
<blockquote>
<script type="math/tex; mode=display">
\xi=<\cos \theta>=-\sum_{j} \frac{1}{2} \int_{0}^{\pi} p(g) \cos g \sin g d g</script></blockquote>
<ul>
<li>extinction mean free path $\Lambda_E$ is the average distance a photon travels through the medium before being extinguished by either absorption or scattering</li>
</ul>
<script type="math/tex; mode=display">\Lambda_{E}=\left(\int_{0}^{\infty} s^{\prime} e^{-E s^{\prime}} d s^{\prime}\right) /\left(\int_{0}^{\infty} e^{-E s^{\prime}} d s^{\prime}\right)=1 / E</script><blockquote>
<p>the absorption and scattering mean free paths are in the similar way.</p>
</blockquote>
<ul>
<li>transport coefficient</li>
</ul>
<p>$S_T = S (1-\xi)$</p>
<blockquote>
<p>correspondingly, transport mean free path:$\Lambda_T = 1/(S(1-\xi))$</p>
</blockquote>
<p>each of these quantities may depend on both location and direction of the incident radiance.</p>
<ul>
<li><strong>optical depth</strong></li>
</ul>
<script type="math/tex; mode=display">
\tau=\int_{z}^{\infty} E\left(z^{\prime}\right) d z^{\prime}=\int_{s}^{\infty} E\left(s^{\prime}\right) d s^{\prime} / \cos \vartheta</script><blockquote>
<p>由于介质的散射和吸收，一束光穿过介质后其强度为$I = I_0 e^{-\int_0^L E(s)ds}= I_)e^{-\tau}$,入射光强随光深成指数减小，$I/I_0 = e^{-\tau}$.从光的粒子属性出发，则$I/I_0 = nh\nu /n_0 h\nu = n/n_0 = e^{-\tau}$。由此可知，光子穿过光深为$\tau$ 的介质逃逸（不被吸收和散射）的概率为$n/n_0= e^{-\tau}$,那么被吸收和散射的概率为$1-e^{-\tau}$. 当介质的光深很小时，光子被吸收或散射的概率为$1-e^{-\tau}\sim \tau$,而当介质的光深为无穷大时，进入介质的光子基本上都被吸收。<br>$\tau &gt; 1 $的介质称为光学厚的（optical thick）,$\tau &lt; 1 $的介质称为光薄的（optical thin）</p>
</blockquote>
<ul>
<li>transmissivity function</li>
</ul>
<script type="math/tex; mode=display">T\left(s_{1}, s_{2}\right)=\exp \left[-\int_{S_{1}}^{s_{2}} E(s, \Omega) d s\right]</script><blockquote>
<p>$I(s_2) = I(s_1) T(s_1,s_2)$</p>
<ul>
<li>在密堆积粒子中，该式需要作出修正</li>
</ul>
</blockquote>
<ul>
<li>volume emission coefficient $F(s,\Omega)$ as the power emitted per unit volume by the element at position s into unit solid angle about direction $\Omega$.</li>
</ul>
<p>$F(s,\Omega) = F_s(s,\Omega) + F_T(s,\Omega)$</p>
<ul>
<li>single scattering</li>
<li><p>thermal emission</p>
</li>
<li><p><strong>the general form</strong> of the equation of radiative transfer.</p>
</li>
</ul>
<script type="math/tex; mode=display">\frac{\partial I(s, \Omega)}{\partial s}=-E(s, \Omega) I(s, \Omega)+\frac{S(s, \Omega)}{4 \pi} \int_{4 \pi} I\left(s, \Omega^{\prime}\right) p\left(s, \Omega^{\prime}, \Omega\right) d \Omega^{\prime}+F(s, \Omega)</script><blockquote>
<ul>
<li>消光项，入射光被散射和吸收后，在入射方向上减少</li>
<li>散射项，从其他方向散射到入射方向的光</li>
<li>发射项，<ul>
<li>单次散射项</li>
<li>热发射项，由吸收引起</li>
<li>荧光发射项，一般不考虑</li>
<li>受激辐射项，一般也不考虑，或在吸收系数里加一个负项表示<br>定义源函数：<script type="math/tex; mode=display">
F(z, \Omega)=F(z, \Omega) / E(z)</script></li>
</ul>
</li>
</ul>
</blockquote>
<p>the parameters of the equqtion of radiative transfer are determined by the properties of the particles making up the medium.</p>
<ul>
<li><strong>the equqtion of radiative transfer(7.38式)</strong></li>
</ul>
<script type="math/tex; mode=display">\begin{aligned}
-\cos \vartheta \frac{\partial I(\tau, \Omega)}{\partial \tau}=&-I(\tau, \Omega)+\frac{w(\tau)}{4 \pi} \int_{4 \pi} I\left(\tau, \Omega^{\prime}\right) p\left(\tau, g^{\prime}\right) d \Omega^{\prime} \\\\
&+J \frac{w(\tau)}{4 \pi} p(\tau, g) e^{-\tau / \cos i}+F_{T}(\tau, \Omega)
\end{aligned}</script><blockquote>
<p>水平分层介质;<br>volume single-scattering albedo: $w(z) = S(z)/E(z)$</p>
</blockquote>
<ol>
<li>Radiative transfer in a medium of arbitrary particle separation</li>
</ol>
<ul>
<li>Fresnel diffraction in particulate media</li>
<li>Coherent effects in a close-packed medium</li>
<li>The transmissivity of a particulate medium</li>
<li>Radiative transfer in a particulate medium of arbitrary filling factor</li>
<li>Mean free paths in a particulate medium</li>
</ul>
<ol>
<li>Methods of solutio of radiactive-transfer problems</li>
</ol>
<p><strong>求解辐射传输方程(7.5节）</strong></p>
<blockquote>
<p>不能精确求解，只有数值解和近似解析解</p>
</blockquote>
<ul>
<li>the Monte Carlo Method</li>
<li>the radiosity method</li>
<li>the doubling method</li>
<li>the Eddington approximation</li>
<li>Integral equation formulation</li>
<li>the multistream method</li>
</ul>
<p>the multistream method is also called discret ordiantes method.<br>The sphere of all propagation directions $\Omega$ is broken up into N regions of solid angle $\Delta\Omega_j$ , which need not be equal. The equation of radiative transfer, equation (7.38), is integrated in solid angle over each of the regions $\Delta\Omega_j$ and each resulting equation divided by $\Delta\Omega_j$, giving N equations of the form</p>
<script type="math/tex; mode=display">
\begin{array}{c}
-\frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega j} \frac{\partial I(\tau, \Omega)}{\partial \tau} \cos \vartheta d \Omega=-\frac{1}{\Delta \Omega_{j}} \frac{\partial}{\partial \tau} \int_{\Delta \Omega j} I(\tau, \Omega) \cos \vartheta d \Omega \\\\
=-\frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega j} I(\tau, \Omega) d \Omega+\frac{w}{4 \pi} \frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega_{j}} \int_{4 \pi} p\left(g^{\prime}\right) I\left(\tau, \Omega^{\prime}\right) d \Omega^{\prime} d \Omega \\\\
+J \frac{w}{4 \pi} e^{-\tau / \cos i} \frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega j} p(g) d \Omega+\frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega j} F_{T}(\tau) d \Omega
\end{array}</script><p>Define the following average quantities for the jth zone:</p>
<script type="math/tex; mode=display">
\begin{aligned}
I_{j}(\tau) &=\frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega j} I(\tau, \Omega) d \Omega \\\\
\mu_{j} &=\frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega_{j}} \cos \vartheta d \Omega \\\\
p_{k j} &=\frac{1}{\Delta \Omega_{k}} \frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega k} \int_{\Delta \Omega j} p\left(g^{\prime}\right) d \Omega^{\prime} d \Omega \\\\
F_{T j}(\tau) &=\frac{1}{\Delta \Omega_{j}} \int_{\Delta \Omega_{j}} F_{T}(\tau, \Omega) d \Omega
\end{aligned}</script><p><strong>Note that $p_{kj}$ is the fraction of the radiance traveling in the direction of the center of region k that is scattered into region j.</strong></p>
<p>Then the equation for the intensity in the jth directional region becomes</p>
<script type="math/tex; mode=display">
\begin{aligned}
\mu_{j} d I_{j}(\tau) / d \tau=&-I_{j}(\tau)+(w / 4 \pi) \sum_{k=1}^{\mathcal{N}} \Delta \Omega_{k} p_{k j} I_{k}(\tau) \\\\
&+J \frac{w}{4 \pi} p_{m} e^{-\tau / \cos i}+F_{T j}(\tau)
\end{aligned}</script><p>where the region $\Omega_m$ contains the direction to the collimated source, and j takes all integer values between 1 and N.</p>
<blockquote>
<p>$p_m = \sum_{k=1}^N p_{mk}$</p>
</blockquote>
<p>Thus, the partial integrodifferential equation (7.38) is replaced by a series of N linear, first-order, coupled differential equations that are amenable to well-established numerical solution.</p>
<p>the method of invariance</p>
]]></content>
  </entry>
  <entry>
    <title>Hapke Model</title>
    <url>/posts/5d66.html</url>
    <content><![CDATA[<p><strong>Hapke’s photometric model</strong>（地大师姐推荐文章(Sato, Robinson et al. 2014)）：也见（Hapke书9.4节（9.47）式）</p>
<script type="math/tex; mode=display">
I / F=L S\left(i_{e}, e_{e}\right) K \frac{w}{4}\left[p(g)\left(1+B_{S 0} B_{S}(g)\right)+M\left(i_{e}, e_{e}\right)\right]\left[1+B_{C 0} B_{C}(g)\right] S(i, e, \psi)</script><blockquote>
<p>注：$I/F$为radiance factor，而reflectance factor(REFF)为${I/F\over \pi}$,这里的I/F就是一种表示方法（RADF），不要分开看。</p>
<ol>
<li>LS is the Lommel-Seeliger function,$i_e$ and $e_e$ are effective angle of incidence and emission respectively</li>
<li>K is porosity factor,$\phi$,[0,1]</li>
<li>w is single scattering albedo,[0,1]</li>
<li>p(g) is phase function:b,c；The probability that a photon will be scattered in the direction g is given by p(g)。b,[0,1];c,p(g)&gt;0;</li>
<li>$B_{S0}$ is amplitude of Shadow Hiding Opposition Effect (SHOE),Bs,[0,1]</li>
<li>$B_S(g)$ is SHOE function,$h_S$</li>
<li>$M(i_e, e_e)$ is Isotropic Multiple-Scattering Approximation (IMSA)</li>
<li>$B_{C0}$ is amplitude of Coherent Backscatter Opposition Effect (CBOE)，[0,1]</li>
<li>$B_C(g)$ is CBOE function,$h_C$</li>
<li><code>S(i,e,𝜓)</code> is shadowing function, and 𝜓 is azimuthal angle between the planes of incidence and emergence；The term $\bar{\theta}_p$ is the shadowing function and corrects for macroscopic roughness of the surface and depends on mean slope angle 𝜃.</li>
</ol>
</blockquote>
<ol>
<li>Henyey-Greenstein double-lobed single particle phase function</li>
</ol>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b (0 ≤ b ≤ 1) is the shape-controlling parameter, and c (−1 ≤ c ≤ 1) is the relative strength of backward and forward lobes.<br>b is the angular width of the backward (first term) or forward (second term) scattering lobe and c is the magnitude of the lobe.<br>c&gt;0,后向；c&lt;0 前向</p>
<p>b控制形状：b越大，侧向散射越弱（b=1例外）</p>
<p>$p(g)=1$ 表示各向同性；$p(g)\neq 1$ 表示各项异性；$p(g) =0$ 表示完全吸收。</p>
<ul>
<li>‘hockey-stick” diagram</li>
</ul>
<script type="math/tex; mode=display">
c=3.29 \exp \left(-17.4 b^{2}\right)-0.908</script><p>Narrow lobes have b values close to 1, wide lobes have values &lt;&lt; 1, and isotropically scattering particles have b = 0; 0 &lt;= b &lt; 1.</p>
<p>Hapke2012,p121</p>
</blockquote>
<ol>
<li>The SHOE function BS(g) is given by</li>
</ol>
<script type="math/tex; mode=display">
B_{S}(g)=1 /\left[1+\tan (g / 2) / h_{S}\right]</script><blockquote>
<p>$h_S$ is the angular width parameter of SHOE,</p>
</blockquote>
<ol>
<li>The IMSA function $M(i_e, e_e)$ is given by</li>
</ol>
<script type="math/tex; mode=display">
M\left(i_{e}, e_{e}\right)=H\left(\frac{\cos \left(i_{e}\right)}{K}, w\right) H\left(\frac{\cos \left(e_{e}\right)}{K}, w\right)-1</script><blockquote>
<p>where H(x,w) is Ambartsumian-Chandrasekhar H function, which is approximated by</p>
<script type="math/tex; mode=display">
H(x, w) \simeq\left\{1-w x\left[r_{0}+\frac{1-2 r_{0} x}{2} \ln \left(\frac{1+x}{x}\right)\right]\right\}^{-1}</script><p>简化版：</p>
<script type="math/tex; mode=display">H(x)={1+2x\over 1+2\gamma x}</script><p>$r_0$ is diffusive reflectance, given by</p>
<script type="math/tex; mode=display">
r_{0}=\frac{1-\sqrt{1-w}}{1+\sqrt{1-w}}</script></blockquote>
<ol>
<li>The CBOE function $B_C(g)$ is given by</li>
</ol>
<script type="math/tex; mode=display">
B_{C}(g)=\frac{1+\frac{1-\exp \left[-\tan (g / 2) / h_{C}\right]}{\tan (g / 2) / h_{C}}}{2\left[1+\tan (g / 2) / h_{C}\right]^{2}}</script><blockquote>
<p>where $h_C$ is angular width of CBOE</p>
<ul>
<li>$h_C = \lambda/4\pi\Lambda$;$\Lambda$ is the transport mean free path in the medium.</li>
</ul>
</blockquote>
<ol>
<li>The porosity factor K is</li>
</ol>
<script type="math/tex; mode=display">
K=\frac{-\ln \left(1-1.209 \phi^{2 / 3}\right)}{1.209 \phi^{2 / 3}}</script><blockquote>
<p>where 𝜙 is filling factor that is equivalent to 1− porosity. The K monotonically increases with the filling factor 𝜙 (= 1− porosity)</p>
<p>孔隙度因子K不同于孔隙度（porosity）</p>
</blockquote>
<ol>
<li>The $i_e, e_e,$(注：下标e表示effective) and the <strong>shadowing function</strong> S(i, e,𝜓) are the functions of $\bar{\theta}_p$ (the mean slope angle), the effective value of the photometric roughness.宏观粗糙度。</li>
</ol>
<p>公式很复杂，待补充</p>
<p>拟合数据得到如上九个参数，这些参数中有些与物性有关</p>
<p><strong>简化的5参数Hapke模型(地大师姐)</strong>：SHOE-only.</p>
<script type="math/tex; mode=display">
I / F={\cos i \over \cos i+\cos e}\frac{w}{4}\left[p(g)\left(1+{B_{S 0} \over 1+\tan(g/2)/h_S}\right)+H(\cos i)H(\cos e)-1\right]</script><blockquote>
<p>参数范围：0≤b≤1，-1≤c≤1，0≤w≤1，$0\leq B_{S0} \leq 2$，$0\leq h_S \leq 1$</p>
</blockquote>
<p>或者，CBOE-only</p>
<blockquote>
<p>在不同的应用场景下，SHOE与CBOE对opposition effects 的贡献不一样，因此，按需选择。得到5参数的hapke模型</p>
</blockquote>
<script type="math/tex; mode=display">
\begin{aligned}
\begin{array}{l}
\text {IOF} / L S=\frac{w}{4}\left[p(g)+H\left(\mu_{0}, w\right) H(\mu, w)-1\right]\left[1+B_{C 0} B_{C}\left(g, h_{c}\right)\right] S(i, e, \theta) \\
L S=\mu_{0} /\left(\mu_{0}+\mu\right)
\end{array}
\end{aligned}</script><p><strong>简化hapke模型（林洪磊）:仅3个参数，w,b,c</strong></p>
<blockquote>
<p>不考虑冲效应，但考虑多次散射，因此得到3参数的hapke模型，</p>
<p>K= 1，因为月壤最上层的填充率未知</p>
<p>忽略SHOE和COBE，因为冲效应仅仅发生在小相角处，而第十月昼的相角大于50°</p>
</blockquote>
<script type="math/tex; mode=display">
r={\cos i \over \cos i+\cos e}\frac{w}{4\pi}\left[p(g)+H(\cos i)H(\cos e)-1\right]</script><p><strong>若继续不考虑多次散射，则，hapke模型简化为LS模型</strong></p>
<p>Hapke,2012:</p>
<ul>
<li>Single scattering:the Lommel-Seeliger law（p197)</li>
</ul>
<p>$r = {\varpi \over 4\pi}{\mu_0 \over \mu_0 +\mu}f(g)$</p>
<ul>
<li>the bidirectional reflectance of a sparse medium of isotropic scatters(p197)</li>
</ul>
<p>二流近似</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}{1+2\mu_0 \over 1+2\gamma\mu_0}{1+2\mu \over 1+2\gamma\mu}$</p>
<p>变分法</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}H(\mu_0)H(\mu)$</p>
<ul>
<li>the isotropic multiple-scattering approximation(IMSA)</li>
</ul>
<p>$I_{SS} = J{\varpi \over 4\pi}{\mu_0 \over \mu_0 +\mu}p(g)$</p>
<p>$I_{MS} = J{\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}[H(\mu_0)H(\mu)-1]$</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}[p(g)+H(\mu_0)H(\mu)-1]$</p>
<p>for  a semi-infinite medium, the multiply scattered portion is much less sensitive to the particle phase function than the singly scattered fraction.</p>
<p>The brighter the surface, the more times the average photon is scattered before emerging from the surface, causing directional effects to be averaged out and the multiply scattered intensity distribution to closely approach the isotropic case.</p>
<p>Since the single-scattering term can be evaluated exactly for an arbitrary phase function and the multiply scattered term is relatively insensitive to phase function, a first-order expression for nonisotropic scatterers can be obtained by using the exact expression for the single-scattered term but retaining the isotropic solution for the multiply-scattered term.</p>
<p>多次散射项不像单次散射项那样对相函数明显，通常，表面越亮，多次散射的次数越多，其方向性就被平均掉了，所以一般多次散射项都当做各向同性处理。</p>
<p>相函数有多种形式：</p>
<ul>
<li>HG函数；</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b = −0.17, c = 0.70。</p>
</blockquote>
<ul>
<li>单参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>$(1/4\pi)\int_{4\pi}p(g)d\Omega = 1$</li>
<li>$\theta = \pi - g$</li>
<li>参数b为余弦不对称因子：$b = &lt;\cos \theta&gt;=-&lt;\cos g&gt;$</li>
<li>b=0时，$p(g)=1$,各向同性</li>
<li>b&gt;0时，</li>
</ul>
</blockquote>
<ul>
<li>双参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>第一项为后向项，第二项为前向项；</li>
</ul>
</blockquote>
<ul>
<li>三参数HG函数：$b_1,b_2,c$</li>
</ul>
<ul>
<li>普通多项式（三阶）</li>
</ul>
<script type="math/tex; mode=display">
f(g)=p_{1} g^{3}+p_{2} g^{2}+p_{3} g+p_{4}</script><ul>
<li>普通多项式（四阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>普通多项式（六阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha, \lambda)=\mathrm{A}_{0}+\mathrm{A}_{1} \alpha+\mathrm{A}_{2} \mathrm{a}^{2}+\mathrm{A}_{3} \mathrm{\alpha}^{3}+\mathrm{A}_{4} \mathrm{\alpha}^{4}+\mathrm{A}_{5} \mathrm{\alpha}^{5}+\mathrm{A}_{6} \mathrm{\alpha}^{6}</script><ul>
<li>普通多项式+指数项（指数项模拟背散射效应）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=b_{0} e^{-b_{1} \alpha}+a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>勒让德多项式</li>
</ul>
<script type="math/tex; mode=display">
P(g)=1+b \times \cos (g)+c \times\left(1.5 \times \cos ^{2}(g)-0.5\right)</script><p>$P_1 = \cos \theta; P_2 = {1\over 2}(3\cos^2\theta -1)$</p>
<ul>
<li>指数形式</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=e^{\beta \alpha+\gamma \alpha^{2}+\delta \alpha^{3}}</script><ul>
<li>其他形式：</li>
</ul>
<blockquote>
<p>三阶多项式<br>一阶勒让德多项式<br>线性双项HG函数？</p>
</blockquote>
<p><strong>基于得到的相函数做光度校正</strong>：</p>
<ul>
<li>比值法</li>
<li>解单次反照率：因为多次散射项中包含单次反照率，因此不能直接作比。</li>
</ul>
<blockquote>
<p>以上所有相函数都可用比值法，但HG函数和勒让德多项式来源于Hapke模型，因此还可以基于hapke模型作光度校正。</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>Hapke函数</title>
    <url>/posts/d133.html</url>
    <content><![CDATA[<p><strong>photometric correction</strong>： 将反射率校正到相同的光照几何条件下，一般为入射角30°，出射角0°（NASA实验室所采用的）。比值法</p>
<script type="math/tex; mode=display">
R_{f-\text {corrected}}=R_{f} \frac{\cos 30^{\circ} /\left(\cos 30^{\circ}+\cos 0^{\circ}\right)}{\cos i^{\prime} /\left(\cos i^{\prime}+\cos e^{\prime}\right)} \frac{f\left(30^{\circ}\right)}{f(g)}</script><ul>
<li>REFF（Reflectance factor）: solar irradiance calibration method</li>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599184667796-1599184667978.png" alt="title"></li>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/image-20191203192523571-1599185186884.png" alt="title"></li>
</ul>
<ul>
<li>经验公式：</li>
</ul>
<blockquote>
<p>注：有两种方法获取绝对反射率</p>
<ul>
<li>定标板</li>
<li>太阳辐照度定标方法</li>
</ul>
</blockquote>
<ul>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599186970690-1599186970691.png" alt="title"></li>
<li><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599187032691-1599187032692.png" alt="title"></li>
<li>光度校正的公式（注意式子中的约等号）</li>
<li>用Hapke光度模型可以作光度校正，可以反解物性。</li>
</ul>
<hr>
<ul>
<li>月表光度模型研究进展（许学森，遥感技术与应用）</li>
</ul>
<blockquote>
<ol>
<li>经验模型(hapke8.5节)</li>
<li>几何光学模型</li>
<li>辐射传输模型:Hapke光度模型</li>
<li>计算机数值模拟方法： 蒙托卡罗数值模拟方法</li>
</ol>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/image-20201020210908801-1608690280317.png" alt=""></p>
<hr>
<p><strong>Hapke’s photometric model</strong>（地大师姐推荐文章(Sato, Robinson et al. 2014)）：也见（Hapke书9.4节（9.47）式）</p>
<script type="math/tex; mode=display">
I / F=L S\left(i_{e}, e_{e}\right) K \frac{w}{4}\left[p(g)\left(1+B_{S 0} B_{S}(g)\right)+M\left(i_{e}, e_{e}\right)\right]\left[1+B_{C 0} B_{C}(g)\right] S(i, e, \psi)</script><blockquote>
<p>注：$I/F$为radiance factor，而reflectance factor(REFF)为${I/F\over \pi}$,这里的I/F就是一种表示方法（RADF），不要分开看。</p>
<ol>
<li>LS is the Lommel-Seeliger function,$i_e$ and $e_e$ are effective angle of incidence and emission respectively</li>
<li>K is porosity factor,$\phi$,[0,1]</li>
<li>w is single scattering albedo,[0,1]</li>
<li>p(g) is phase function:b,c；The probability that a photon will be scattered in the direction g is given by p(g)。b,[0,1];c,p(g)&gt;0;</li>
<li>$B_{S0}$ is amplitude of Shadow Hiding Opposition Effect (SHOE),Bs,[0,1]</li>
<li>$B_S(g)$ is SHOE function,$h_S$</li>
<li>$M(i_e, e_e)$ is Isotropic Multiple-Scattering Approximation (IMSA)</li>
<li>$B_{C0}$ is amplitude of Coherent Backscatter Opposition Effect (CBOE)，[0,1]</li>
<li>$B_C(g)$ is CBOE function,$h_C$</li>
<li><code>S(i,e,𝜓)</code> is shadowing function, and 𝜓 is azimuthal angle between the planes of incidence and emergence；The term $\bar{\theta}_p$ is the shadowing function and corrects for macroscopic roughness of the surface and depends on mean slope angle 𝜃.</li>
</ol>
</blockquote>
<ol>
<li>Henyey-Greenstein double-lobed single particle phase function</li>
</ol>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b (0 ≤ b ≤ 1) is the shape-controlling parameter, and c (−1 ≤ c ≤ 1) is the relative strength of backward and forward lobes.<br>b is the angular width of the backward (first term) or forward (second term) scattering lobe and c is the magnitude of the lobe.<br>c&gt;0,后向；c&lt;0 前向</p>
<p>b控制形状：b越大，侧向散射越弱（b=1例外）</p>
<p>$p(g)=1$ 表示各向同性；$p(g)\neq 1$ 表示各项异性；$p(g) =0$ 表示完全吸收。</p>
<ul>
<li>‘hockey-stick” diagram</li>
</ul>
<script type="math/tex; mode=display">
c=3.29 \exp \left(-17.4 b^{2}\right)-0.908</script><p>Narrow lobes have b values close to 1, wide lobes have values &lt;&lt; 1, and isotropically scattering particles have b = 0; 0 &lt;= b &lt; 1.</p>
<p>Hapke2012,p121</p>
</blockquote>
<ol>
<li>The SHOE function BS(g) is given by</li>
</ol>
<script type="math/tex; mode=display">
B_{S}(g)=1 /\left[1+\tan (g / 2) / h_{S}\right]</script><blockquote>
<p>$h_S$ is the angular width parameter of SHOE,</p>
</blockquote>
<ol>
<li>The IMSA function $M(i_e, e_e)$ is given by</li>
</ol>
<script type="math/tex; mode=display">
M\left(i_{e}, e_{e}\right)=H\left(\frac{\cos \left(i_{e}\right)}{K}, w\right) H\left(\frac{\cos \left(e_{e}\right)}{K}, w\right)-1</script><blockquote>
<p>where H(x,w) is Ambartsumian-Chandrasekhar H function, which is approximated by</p>
<script type="math/tex; mode=display">
H(x, w) \simeq\left\{1-w x\left[r_{0}+\frac{1-2 r_{0} x}{2} \ln \left(\frac{1+x}{x}\right)\right]\right\}^{-1}</script><p>简化版：</p>
<script type="math/tex; mode=display">H(x)={1+2x\over 1+2\gamma x}</script><p>$r_0$ is diffusive reflectance, given by</p>
<script type="math/tex; mode=display">
r_{0}=\frac{1-\sqrt{1-w}}{1+\sqrt{1-w}}</script></blockquote>
<ol>
<li>The CBOE function $B_C(g)$ is given by</li>
</ol>
<script type="math/tex; mode=display">
B_{C}(g)=\frac{1+\frac{1-\exp \left[-\tan (g / 2) / h_{C}\right]}{\tan (g / 2) / h_{C}}}{2\left[1+\tan (g / 2) / h_{C}\right]^{2}}</script><blockquote>
<p>where $h_C$ is angular width of CBOE</p>
<ul>
<li>$h_C = \lambda/4\pi\Lambda$;$\Lambda$ is the transport mean free path in the medium.</li>
</ul>
</blockquote>
<ol>
<li>The porosity factor K is</li>
</ol>
<script type="math/tex; mode=display">
K=\frac{-\ln \left(1-1.209 \phi^{2 / 3}\right)}{1.209 \phi^{2 / 3}}</script><blockquote>
<p>where 𝜙 is filling factor that is equivalent to 1− porosity. The K monotonically increases with the filling factor 𝜙 (= 1− porosity)</p>
<p>孔隙度因子K不同于孔隙度（porosity）</p>
</blockquote>
<ol>
<li>The $i_e, e_e,$(注：下标e表示effective) and the <strong>shadowing function</strong> S(i, e,𝜓) are the functions of $\bar{\theta}_p$ (the mean slope angle), the effective value of the photometric roughness.宏观粗糙度。</li>
</ol>
<p>公式很复杂，待补充</p>
<p>拟合数据得到如上九个参数，这些参数中有些与物性有关</p>
<p><strong>简化的5参数Hapke模型(地大师姐)</strong>：SHOE-only.</p>
<script type="math/tex; mode=display">
I / F={\cos i \over \cos i+\cos e}\frac{w}{4}\left[p(g)\left(1+{B_{S 0} \over 1+\tan(g/2)/h_S}\right)+H(\cos i)H(\cos e)-1\right]</script><blockquote>
<p>参数范围：0≤b≤1，-1≤c≤1，0≤w≤1，$0\leq B_{S0} \leq 2$，$0\leq h_S \leq 1$</p>
</blockquote>
<p>或者，CBOE-only</p>
<blockquote>
<p>在不同的应用场景下，SHOE与CBOE对opposition effects 的贡献不一样，因此，按需选择。得到5参数的hapke模型</p>
</blockquote>
<script type="math/tex; mode=display">
\begin{aligned}
\begin{array}{l}
\text {IOF} / L S=\frac{w}{4}\left[p(g)+H\left(\mu_{0}, w\right) H(\mu, w)-1\right]\left[1+B_{C 0} B_{C}\left(g, h_{c}\right)\right] S(i, e, \theta) \\
L S=\mu_{0} /\left(\mu_{0}+\mu\right)
\end{array}
\end{aligned}</script><p><strong>简化hapke模型（林洪磊）:仅3个参数，w,b,c</strong></p>
<blockquote>
<p>不考虑冲效应，但考虑多次散射，因此得到3参数的hapke模型，</p>
<p>K= 1，因为月壤最上层的填充率未知</p>
<p>忽略SHOE和COBE，因为冲效应仅仅发生在小相角处，而第十月昼的相角大于50°</p>
</blockquote>
<script type="math/tex; mode=display">
r={\cos i \over \cos i+\cos e}\frac{w}{4\pi}\left[p(g)+H(\cos i)H(\cos e)-1\right]</script><p><strong>若继续不考虑多次散射，则，hapke模型简化为LS模型</strong></p>
<p>Hapke,2012:</p>
<ul>
<li>Single scattering:the Lommel-Seeliger law（p197)</li>
</ul>
<p>$r = {\varpi \over 4\pi}{\mu_0 \over \mu_0 +\mu}f(g)$</p>
<ul>
<li>the bidirectional reflectance of a sparse medium of isotropic scatters(p197)</li>
</ul>
<p>二流近似</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}{1+2\mu_0 \over 1+2\gamma\mu_0}{1+2\mu \over 1+2\gamma\mu}$</p>
<p>变分法</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}H(\mu_0)H(\mu)$</p>
<ul>
<li>the isotropic multiple-scattering approximation(IMSA)</li>
</ul>
<p>$I_{SS} = J{\varpi \over 4\pi}{\mu_0 \over \mu_0 +\mu}p(g)$</p>
<p>$I_{MS} = J{\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}[H(\mu_0)H(\mu)-1]$</p>
<p>$r = {\varpi \over 4 \pi}{\mu_0\over \mu_0 +\mu}[p(g)+H(\mu_0)H(\mu)-1]$</p>
<p>for  a semi-infinite medium, the multiply scattered portion is much less sensitive to the particle phase function than the singly scattered fraction.</p>
<p>The brighter the surface, the more times the average photon is scattered before emerging from the surface, causing directional effects to be averaged out and the multiply scattered intensity distribution to closely approach the isotropic case.</p>
<p>Since the single-scattering term can be evaluated exactly for an arbitrary phase function and the multiply scattered term is relatively insensitive to phase function, a first-order expression for nonisotropic scatterers can be obtained by using the exact expression for the single-scattered term but retaining the isotropic solution for the multiply-scattered term.</p>
<p>多次散射项不像单次散射项那样对相函数明显，通常，表面越亮，多次散射的次数越多，其方向性就被平均掉了，所以一般多次散射项都当做各向同性处理。</p>
<hr>
<p>一些光度校正的实操论文</p>
<p>问题：参数拟合的数学实现以及遇见的一些细节问题</p>
<ol>
<li>python拟合函数curve_fit</li>
</ol>
<ul>
<li>参数初始值问题：若不给初值，也不给边界，则初值默认为1；若不给初值，但给定边界，则初值为边界中点。</li>
</ul>
<ol>
<li>python 其他函数</li>
</ol>
<hr>
<p>lunar opposition effect（Hapke第九章）</p>
<ul>
<li>shadow hiding（占主要）：shadow-hiding mechanism in which particles hide their own shadows at opposition but the shadows quickly become visible as one moves away from opposition（clementine Hillier 1999）</li>
<li>相干反向散射coherent backscatter（2°左右的窄峰）： photons following identical but reversed paths can interfere constructively in the backscattering direction, leading to up to a factor of two increase in brightness.</li>
<li>具有波长依赖性</li>
<li>the angular width of the coherent backscatter peak should be proportional to wavelength, it is inversely proportional to the mean optical path length of a photon (which will be smaller in lower albedo surfaces)</li>
<li>相干反向散射对更亮的高地地形更重要</li>
</ul>
<p>ground truth: Apollo site</p>
<p>photometric model 可反演月壤的物理性质</p>
<ul>
<li>compaction state</li>
<li>particle albedo</li>
<li>particle size</li>
<li>size distribution</li>
<li>surface macroscopic roughness</li>
<li>grain transparency</li>
<li>porosity</li>
<li>光度模型可以反演上述参数，然后用反演的参数与Apollo的“真值”对比，可以检验光度模型理论</li>
<li>相对定标：矿物学研究</li>
<li>绝对定标： 光度研究、</li>
</ul>
<p><strong>从反射率光谱获取矿物成分：</strong></p>
<ul>
<li>查找表（lunar spectral mineral lookup table，LUT）</li>
<li>MGM(修正高斯模型)</li>
<li>其他？<br>实操过程：<img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/04/1599186729747-1599186729748.png" alt="title"></li>
</ul>
<hr>
<p>光度校正公式（前经验）：</p>
<p>Scattering Law Analysis Based on Hapke and Lommel-Seeliger Models for Asteroidal Taxonomy<br>Hapke-5parameters</p>
<script type="math/tex; mode=display">
\begin{aligned}
RADF(i, e, \alpha)&=\frac{\omega}{4} \frac{\mu_{0}}{\mu_{0}+\mu} \\\\
& \times\left\{[1+B(\alpha)] p(\alpha)+H\left(\mu_{0}\right) H(\mu)-1\right\} \\\\
& \times S(i, e, \alpha, \bar{\theta}) \\\\
B(\alpha)&=\frac{B_{\mathrm{so}}}{1+\frac{1}{h_{\mathrm{s}}} \tan \frac{\alpha}{2}} \\\\
p(\alpha)&=\frac{1-g^{2}}{\left(1+2 g \cos \alpha+g^{2}\right)^{\frac{3}{2}}} \\\\
H(x)&=\frac{1+2 x}{1+2 \sqrt{1-\omega} x}
\end{aligned}</script><p>-LS模型</p>
<script type="math/tex; mode=display">
\begin{aligned}
r(i, e, \alpha)&=A_{\mathrm{ls}} \frac{\mu_{0}}{\mu_{0}+\mu} f(\alpha)\\\\
A_{ls} &={\omega \over 4\pi}\\\\
f(\alpha)&=e^{\beta \alpha+\gamma \alpha^{2}+\delta \alpha^{3}}\\\\
RADF(i,e,\alpha)&= \pi r(i,e,g)
\end{aligned}</script><hr>
<p>光度校正的关键在于获取相函数及其参数。</p>
<p>获取相函数的两种模型：</p>
<ul>
<li>Hapke模型</li>
<li>LS模型</li>
</ul>
<p>相函数有多种形式：</p>
<ul>
<li>HG函数；</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b = −0.17, c = 0.70。</p>
</blockquote>
<ul>
<li>单参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>$(1/4\pi)\int_{4\pi}p(g)d\Omega = 1$</li>
<li>$\theta = \pi - g$</li>
<li>参数b为余弦不对称因子：$b = &lt;\cos \theta&gt;=-&lt;\cos g&gt;$</li>
<li>b=0时，$p(g)=1$,各向同性</li>
<li>b&gt;0时，</li>
</ul>
</blockquote>
<ul>
<li>双参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>第一项为后向项，第二项为前向项；</li>
</ul>
</blockquote>
<ul>
<li>三参数HG函数：$b_1,b_2,c$</li>
</ul>
<ul>
<li>普通多项式（三阶）</li>
</ul>
<script type="math/tex; mode=display">
f(g)=p_{1} g^{3}+p_{2} g^{2}+p_{3} g+p_{4}</script><ul>
<li>普通多项式（四阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>普通多项式（六阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha, \lambda)=\mathrm{A}_{0}+\mathrm{A}_{1} \alpha+\mathrm{A}_{2} \mathrm{a}^{2}+\mathrm{A}_{3} \mathrm{\alpha}^{3}+\mathrm{A}_{4} \mathrm{\alpha}^{4}+\mathrm{A}_{5} \mathrm{\alpha}^{5}+\mathrm{A}_{6} \mathrm{\alpha}^{6}</script><ul>
<li>普通多项式+指数项（指数项模拟背散射效应）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=b_{0} e^{-b_{1} \alpha}+a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>勒让德多项式</li>
</ul>
<script type="math/tex; mode=display">
P(g)=1+b \times \cos (g)+c \times\left(1.5 \times \cos ^{2}(g)-0.5\right)</script><p>$P_1 = \cos \theta; P_2 = {1\over 2}(3\cos^2\theta -1)$</p>
<ul>
<li>指数形式</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=e^{\beta \alpha+\gamma \alpha^{2}+\delta \alpha^{3}}</script><ul>
<li>其他形式：</li>
</ul>
<blockquote>
<p>三阶多项式<br>一阶勒让德多项式<br>线性双项HG函数？</p>
</blockquote>
<p><strong>基于得到的相函数做光度校正</strong>：</p>
<ul>
<li>比值法</li>
<li>解单次反照率：因为多次散射项中包含单次反照率，因此不能直接作比。</li>
</ul>
<blockquote>
<p>以上所有相函数都可用比值法，但HG函数和勒让德多项式来源于Hapke模型，因此还可以基于hapke模型作光度校正</p>
</blockquote>
<hr>
<p>光度校正历史</p>
<ul>
<li>Clementine （Hiller et al,1999）</li>
</ul>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142037383-1599142037466.png" alt="title"></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142094855-1599142094855.png" alt="title"></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/03/1599142116109-1599142116110.png" alt="title"></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/1608696754062-1608696754064.png" alt=""></p>
<ul>
<li>M3</li>
<li>SELENE</li>
<li>CE-1</li>
<li>CE-3</li>
<li>CE-4</li>
</ul>
<p>几组HG函数参数：</p>
<ul>
<li>b = −0.17， c = 0.70。</li>
</ul>
<blockquote>
<p>(Yang,Yazhou,2020;Lin,Honglei,2020)<br>CE-4,第十月昼</p>
</blockquote>
<ul>
<li>b = −0.4, c = 0.25。</li>
</ul>
<blockquote>
<p>(lucey,1998)<br>假定参数</p>
</blockquote>
<ul>
<li>b=0.3,c =0.08</li>
</ul>
<blockquote>
<p>(Jin,Weidong,2015)<br>CE-3,全景相机，460nm,9参数Hapke模型<br>若使用5参数Hapke模型，b=0.32,c=-0.17</p>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/12/23/1608702945384-1608702945385.png" alt="HG"></p>
<p>待办</p>
<ul>
<li>[ ] 光度模型溯源文章</li>
<li>[ ] 光端校正文章内容</li>
<li>[ ] hapke模型</li>
</ul>
<p><strong>hapke模型的拟合</strong></p>
<ul>
<li>前人怎么拟合的<blockquote>
<p>网格搜索；遗传算法；查找表，等！</p>
</blockquote>
</li>
<li>求解全局最小的算法及其原理！</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>Opposition Effects</title>
    <url>/posts/eecf.html</url>
    <content><![CDATA[<p>1.<strong>Opposition Effect</strong></p>
<p>The opposition effect is a <strong>sharp surge</strong> observed in the reflected brightness of a particulate medium around zero phase angle.</p>
<blockquote>
<ul>
<li>Its name derives from the fac that the phase angle is zero for solar-system objects at astronomical opposition when the Sun, the Earth, and the object are aligned. (译作“冲效应”)</li>
<li>It has many names including the heiligenschein(literally “holy glow”,圣光), hot spot(热点), bright shadow(亮影) and backscatter peak(背散射峰).</li>
<li>On a clear day you can see it as a glow around the shadow of your head when your shadow falls on grass or siol.(It is particularly pronounced in powders with grains a few micrometers in size.</li>
</ul>
</blockquote>
<p>Depending on the marterial the angular width of the peak can range from about $1^\circ$ to more than $20^\circ$.</p>
<blockquote>
<p>Compared to some atmosphereless celestial bodies, the Moon reveals a rather wide oppositon surge. For instance, E-type asteroids have the point where the brightness sharply increases in the range $2-3^\circ$, for Kuiper belt objects this angle is even less; whereas, for the Moon it is near $7^\circ$. Usually one assumes a narrow spike to be due to the coherent backscattering, while a wide surge is a result of the shadow-hiding effect. (Shkuratov, Y.G.,2011)</p>
</blockquote>
<p>Servral mechanisms have been suggested to explain the opposition effect observed on solar system bodies, including shadow-hiding, coherent backscattering, glories from glass beads, and crystalline corner reflectors. The last two hypotheses can be readily eliminated.</p>
<ol>
<li>The shadow-hiding opposition effect (SHOE)</li>
</ol>
<p>The shadow-hiding backscatter surge occurs in any particulate medium in which <strong>the grains are larger than the wavelength</strong> so that they have shadows. Particles near the surface cast shadows on the deeper grains. The shadows are visiable at large angles, but close to zero phase they are hidden by the objects that cast them.</p>
<blockquote>
<ul>
<li>The opposition effect is particularly pronounced in fine powders with a mean grain size less than about $20\mu m$.</li>
<li>The microstructure formed by fine cohensive powders can be very open, porous, and intricate, consist of lacy towers ande briges(“fairy castle structures”): 分子间静电力和范德华力足以抵抗引力。</li>
<li>The Moon has a strong opposition effect, means that the upper layers of the lunar regolith are fine-grained and have a high porosity.</li>
</ul>
</blockquote>
<script type="math/tex; mode=display">B(g) = 1+ B_{S0} B_S(g)</script><script type="math/tex; mode=display">B_S(g) \simeq \left(1+{1\over h_S}\tan {g\over 2}\right)^{-1}</script><blockquote>
<p>$0\leq B_{S0} \leq 1$.<br>Considering that light has been scattered only once.</p>
</blockquote>
<ul>
<li>An order-of-magnitude estimate of the expected half-width of the shadow-hiding peak: $HWHM\sim a/\Lambda_E$</li>
</ul>
<p>The average distance a ray travels in a particlulate medium before encountering a particle and being eithter absorbed or sccattered is the <strong>extinction length,$\Lambda_E$</strong>, so that this will also be the mean length of a shadow cast by a particle in the medium.</p>
<p>a is the radius of a spherical particle.</p>
<ul>
<li>The angular width of the SHOE</li>
</ul>
<script type="math/tex; mode=display">HWHM \simeq 2h_S = K E a_E = a_E / \Lambda_E</script><blockquote>
<p>K is the porosity factor, $K = -\ln (1- 1.209\phi^{2/3})/1.209\phi^{2/3}$.<br>E is the Extinctiion coefficient.<br>$a_E$ is the radius of an equivalent sphere having the cross-sectional area $\sigma_E$. $a_E(z) = \sqrt{\sigma_E(z)/\pi}$, $\sigma_E = &lt;\sigma Q_E&gt;=E(z)/N(z)$</p>
</blockquote>
<p>$h_S$ increases as $\phi$ increases and becomes infinite as $\phi \rightarrow 0.752$, so that the peak is infinitely wide. This states that a surface in which the particles are so closely packed that light cannot penetrate between the particles does not have a SHOE.</p>
<p>As $\phi$ decreases, the angular width of the peak narrows.</p>
<p>When the width of the peak becomes much smaller than the angular width of the source or detector as seen form the surface. In this case it is averaged over the combined angular widths of the source and detector and appears as a lower, wider peak.</p>
<script type="math/tex; mode=display">h_S = {3\sqrt{3}\over 8}{K\phi \over \ln (a_l/a_s)}</script><blockquote>
<p>particle size distribution, power law, $N(a)\propto a^{-\nu}$<br>$a_l$ and $a_s$ are the largest and smallest particle size.<br>if $a_l/a_s \simeq 1000$ and $\phi = 0.4$, then $h_S =0.061$, corresponding to a half_width of about $7^\circ$.</p>
</blockquote>
<ul>
<li>The amplitude of the SHOE</li>
</ul>
<p>the shadow-hiding effect is negligible for the multiply scattered component.</p>
<p>the main effect of multiple scattering is to reduce the height of the peak relative to the total continuum reflectance, which includes both singly and multiply scattered light.</p>
<p>Theoretically, the opposition effect should increase the singly scattered component of the radiance by a factor of exactly 2 at zero phase.</p>
<script type="math/tex; mode=display">B_{S0}\simeq S(0)/wp(0)</script><blockquote>
<p>$B_{S0}$ is the ratio of the light scattered from near the illuminated portion of the surface of the particle to the total amount of light scattered at zero phase.<br>$S(0)$ is the fraction of incident light scattered at or close to the illuminated part of the surface oft he particle facing the source,<br>$wp(0)$ is the total amount of light scattered by the particle at zero phase.</p>
</blockquote>
<ol>
<li>The coherent backscatter opposition effect (CBOE)</li>
</ol>
<p>An entire different phenomenon can cause a surge in the brightness of a disordered medium at small angles <strong>whether the particles are larger or smaller the wavelength</strong>.</p>
<p>the phenomenon si known variously as coherent backscatter, time-reversal symmetry, and <strong>weak photon localization</strong>.</p>
<p>the term weak localization comes from an analogy with the transport of electrons through conducting and semiconducting media. there isa similar phenomenon occurs in the transition region between the conditions where the electrons may be described as waves propagating through the medium and where the electron wave functions become localized on individual atoms. although a photon never becomes permanently confined to an atom it can temporarily follow looping, nearly closed, multiply scattered pathes and, hence, be ‘weakly’ localized.</p>
<p>Part of a wave front incident on a particulate medium encounters a scattering center and is scattered two or more time before exiting the medium at a small phase angle. for very such path another portion of the same wave front will traverse the same path within the medium but in the opposite direction. at large phase angles there is no coherence between the two wavelets and the total intensity is twice the individual intensities. at zero phase angle the two wavelets will be <strong>in phase</strong> upon emerging from the medium and will combine coherently so as to interfere with each other positively, and the total intensity is quadruple the individual intensities.</p>
<script type="math/tex; mode=display">1+B_{C 0} B_{C}(g)</script><script type="math/tex; mode=display">B_{C}(g)=\frac{1+\frac{1-\exp \left[-\tan (g / 2) / h_{C}\right]}{\tan (g / 2) / h_{C}}}{2\left[1+\tan (g / 2) / h_{C}\right]^{2}}</script><blockquote>
<p>$B_{C0}$ is an empirical quantity that cannot be predicted exactly at the present time, but is related to the albedo.<br>$h_C = \lambda/4\pi\Lambda$;$\Lambda$ is the transport mean free path in the medium.</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>Chapter 10</title>
    <url>/posts/b0c2.html</url>
    <content><![CDATA[<h2 id="10-A-miscellany-of-bidirectional-reflectances-and-related-quantities"><a href="#10-A-miscellany-of-bidirectional-reflectances-and-related-quantities" class="headerlink" title="10 A miscellany of bidirectional reflectances and related quantities"></a>10 A miscellany of bidirectional reflectances and related quantities</h2><blockquote>
<p><strong>补充知识</strong>：<br><strong>辐射度量</strong></p>
<ol>
<li><strong>辐射能量</strong>（Radiant energy,Q）：电磁辐射的能量，J(焦耳)</li>
</ol>
<blockquote>
<p>使被照物体温度升高；改变物体的内部状态；是带电物体受力而运动</p>
</blockquote>
<ol>
<li><strong>辐射通量</strong>(Radiant flux):单位时间内通过某一面积的辐射能量，W(瓦特),也称为功率（power）</li>
</ol>
<script type="math/tex; mode=display">
\Phi= dQ/dt</script><ol>
<li><strong>辐射通量密度</strong>:单位面积上的辐射通量,$W/m^2$</li>
</ol>
<script type="math/tex; mode=display">
d\Phi/dS</script><ol>
<li><strong>辐射照度</strong>（Irradiance,E);单位面积被辐射物体所接收的辐射通量</li>
</ol>
<script type="math/tex; mode=display">
E = d\Phi/dS</script><ul>
<li><strong>辐照度衰减</strong>：</li>
</ul>
<script type="math/tex; mode=display">
E^\prime = {\Phi \over 4\pi r^2}</script><ul>
<li><strong>兰伯特余弦定律</strong>：表面辐照度与光方向和表面法线夹角的余弦值成正比(也就是说只要在表面法线方向的的辐射度分量)。</li>
<li><strong>辐射出射度</strong>（Radiant exitance）:单位面积上辐射源辐射出的辐射通量</li>
</ul>
<script type="math/tex; mode=display">
M =d\Phi/dS</script><ol>
<li><strong>辐射强度</strong>（Radiant Intensity）:点辐射源在单位立体角内的辐射通量,$W/Sr$</li>
</ol>
<script type="math/tex; mode=display">
I = d\Phi/d\Omega</script><blockquote>
<p>对各向同性点源，$I = {\Phi \over 4\pi}$; $W/Sr$</p>
</blockquote>
<ol>
<li><strong>辐射</strong>（Radiance,也称亮度，luminance,L）:辐射源在单位投影面积上、单位立体角内的辐射通量，</li>
</ol>
<script type="math/tex; mode=display">
L(\theta) = \frac{d^2\Phi}{d\Omega dA \cos\theta}=\frac{dM}{d\Omega \cos \theta}</script><p><strong>最重要概念</strong></p>
<ul>
<li>Radiant Flux,辐射通量，光通量，辐射功率；在单位时间穿过截面的光能；单位是W，瓦特</li>
<li>(Radiant) Intensity, 辐射强度，发光强度；每单位立体角的辐射通量；单位  ，瓦特每球面度。</li>
<li>Radiance, 光亮度，辐亮度，辐射率；每单位立体角每单位投影面积的辐射通量；瓦特每球面度每平方米。</li>
<li>Irradiance, 辐照度，辉度，辐射照度；单位时间内到达单位面积的辐射通量，也就是辐射通量对于面积的密度；瓦特每平方米。</li>
</ul>
</blockquote>
<p><img data-src="https://cdn.nlark.com/yuque/0/2021/jpeg/1500846/1614828140717-f4527b74-5a7b-4120-acfe-6fea246233ac.jpeg#align=left&amp;display=inline&amp;height=681&amp;margin=%5Bobject%20Object%5D&amp;name=%E8%BE%90%E5%B0%84%E5%BA%A6%E9%87%8F%E6%A6%82%E5%BF%B5.jpg&amp;originHeight=681&amp;originWidth=927&amp;size=116767&amp;status=done&amp;style=none&amp;width=927" alt="辐射度量概念.jpg"><br>详情可参考：<a href="https://zhuanlan.zhihu.com/p/139468429">辐射度量学 - 知乎</a></p>
<h3 id="10-2-some-commonly-encountered-bidirectional-reflectance-quantities"><a href="#10-2-some-commonly-encountered-bidirectional-reflectance-quantities" class="headerlink" title="10.2  some commonly encountered bidirectional reflectance quantities"></a>10.2  some commonly encountered bidirectional reflectance quantities</h3><p><strong>the bidirectional reflectance $r(i,e,g)$</strong></p>
<script type="math/tex; mode=display">
r(i,e,g)= K\frac{\varpi}{4\pi}\frac{\mu_0}{\mu_0+\mu}\left[P(g)+H(\mu_0/K)H(\mu/K)-1\right]</script><blockquote>
<p>the bidirectional reflectance is the ratio of the radiance scattered from the surface of a medium into a given direction to the collimated power incident <strong>per area perpendicular to the direction of the incidence.</strong></p>
<p>K is the porosity coefficients.</p>
<p>孔隙率：土壤中孔隙体积与总体积的比值。</p>
<p>$r(i,e,g)=\dfrac{emit_radiance}{incident_irradiance}=\dfrac{I_e}{J}.$</p>
</blockquote>
<p><img data-src="https://cdn.nlark.com/yuque/0/2021/png/1500846/1614828169002-539ac1ac-aa36-4e73-8f5c-5c9044e8a6b9.png#align=left&amp;display=inline&amp;height=582&amp;margin=%5Bobject%20Object%5D&amp;name=10.1bidirectionalReflectence.png&amp;originHeight=582&amp;originWidth=1492&amp;size=83460&amp;status=done&amp;style=none&amp;width=1492" alt="10.1bidirectionalReflectence.png"></p>
<blockquote>
<p>X.-J. Huang et al.: Analysis Based on the Hapke Model and LS Model</p>
</blockquote>
<p><strong>the bidirectional-reflectance distribution function (BDRF)</strong></p>
<script type="math/tex; mode=display">
\begin{aligned}
BDRF(i,e,g)=&\frac{I}{J\mu_0}=\frac{r(i,e,g)}{\mu_0}\\
=&K\frac{\varpi}{4\pi}\frac{1}{\mu_0+\mu}\left[P(g)+H(\mu_0/K)H(\mu/K)-1\right]
\end{aligned}</script><blockquote>
<p>the bidirectional-reflectance distribution function (BDRF) is the ratio of the radiance scattered from the surface of a medium into a given direction to <strong>the collimated power incident on a unit area of the surface.</strong></p>
</blockquote>
<p><strong>the reflectance factor (REFF)</strong>, is also called the <strong>_reflectance coefficient (or, apparent reflectance)._</strong></p>
<script type="math/tex; mode=display">
\small REFF(i,e,g)= \pi r(i,e,g)/\mu_0=K\frac{\varpi}{4}\frac{1}{\mu_0+\mu}\left[P(g)+H(\mu_0/K)H(\mu/K)-1\right]</script><blockquote>
<p>the reflectance factor is the ratio of the reflectance of the surface to that of  a <strong>perfectly diffuse surface</strong> under <strong>the same conditions of illumination and measurement</strong>.<br>the bidirectional reflectance of a perfect Lambert surface is</p>
<p>$r_L =\mu_0/\pi$</p>
<p>for details(8.5.1 Lambert’s law)</p>
<p>reflectance <strong>factor</strong>: 即测量到的反射率$I/J$与相同光照条件下的朗伯体的反射率$\cos i/\pi$之比。</p>
</blockquote>
<p><strong>the radiance factor (RADF)</strong>, is also denoted by <strong>I/F</strong>.</p>
<script type="math/tex; mode=display">
\begin{aligned}
RADF(i,e,g)=&\frac{I}{F}(i,e,g)=\pi r(i,e,g)
\\=&K\frac{\varpi}{4}\frac{\mu_0}{\mu_0+\mu}\left[P(g)+H(\mu_0/K)H(\mu/K)-1\right]
\end{aligned}</script><blockquote>
<p>the radiance factor is the ratio of the bidirectional reflectance of a surface to that of a perfectly diffuse surface illuminated at</p>
<script type="math/tex; mode=display">
i = 0,r_L=1/\pi</script><p>, rather than at the same angle of illumination as the sample.</p>
<p>$F=J/\pi$, Chandrasekhar (1960).</p>
<p>Shkuratov,2011称：在老文章里，也称<strong>apparent albedo</strong>.（不够准确，权当历史原因造成）。</p>
</blockquote>
<p><strong>the relative reflectance ,</strong></p>
<script type="math/tex; mode=display">
\begin{aligned}
\Gamma(i,e,g)=&\frac{r(Sample)}{r(standard\_surface)}\\
= &\frac{K_{Sa}}{K_{St}}\varpi\frac{P(g)+H(\mu_0/K_{Sa},\varpi)H(\mu/K_{Sa},\varpi)-1}{H(\mu_0/K_{St},\varpi=1)H(\mu/K_{St},\varpi=1)}
\end{aligned}</script><blockquote>
<p>the relative reflectance of a particulate sample is the reflectance relative to that of standard surface consisting of an infinitely thick particulate medium of nonabsorbing, isotropic scatterers, with negligible opposition effect, and illuminated and viewed at the same geometry as the sample.</p>
<p>if</p>
<script type="math/tex; mode=display">
K_{Sa}=K_{St}\approx 1</script><p>, and the H functions</p>
<script type="math/tex; mode=display">
H(x)\simeq \frac{1+2x}{1+2\gamma x}</script><p>, the relative bidirectional reflectance of a sample of isotropic scatterers measured outside of the opposition peak is given by</p>
<script type="math/tex; mode=display">
\Gamma(i,e,g\gg h)=\frac{\varpi}{(1+2\gamma\mu_0)(1+2\gamma\mu)}</script></blockquote>
<p><strong>the reduced reflectance $r_r(i,e,g)$</strong></p>
<script type="math/tex; mode=display">
r_r(i,e,g) =\frac{I/F}{\mu_0/(\mu_0 +\mu)}</script><blockquote>
<p>the reduced reflectance  is defined as the radiance factor divided by the Lommel-Seeliger factor.</p>
</blockquote>
<p>计算过程中通常还需要校正太阳距离：</p>
<ul>
<li>加州理工大学，喷气动力实验室，JPL：<a href="https://ssd.jpl.nasa.gov/horizons.cgi">https://ssd.jpl.nasa.gov/horizons.cgi</a> （地平线系统！）</li>
</ul>
<p><strong>补充知识</strong></p>
<blockquote>
<p><strong>反射率波谱</strong></p>
<ul>
<li>方向-方向反射率波谱（晴天，野外便携式地物光谱仪）</li>
<li><strong>半球 -方向反射率波谱</strong>（阴天）</li>
<li>方向-半球反射率波谱（积分球，波谱测定器）;directional-hemispherical reflectance.</li>
<li>半球- 半球反射率波谱（等效于反照率光谱）</li>
</ul>
</blockquote>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/09/image-20191203192523571-1599656007275.png#align=left&amp;display=inline&amp;height=1080&amp;margin=%5Bobject%20Object%5D&amp;originHeight=1080&amp;originWidth=1440&amp;status=done&amp;style=none&amp;width=1440" alt=""></p>
<blockquote>
<p><strong>朗伯体</strong>：<br>朗伯体：是指当入射能量在所有方向均匀反射，即入射能量以入射点为中心，在整个半球空间内向四周各向同性的反射能量的现象，称为漫反射，也称各向同性反射，一个完全的漫射体称为朗伯体。理想的漫反射应遵循这个规律。例如积雪和白墙。<br>余弦发光体：若一扩展光源的发光强度为dI∝cosθ，即其亮度B与方向无关。这类发射体称为余弦发光体，或朗伯（J.H.Lambert）发光体，上述按cosθ规律发射光通量的规律，成为朗伯余弦定律。式中dI为扩展光表面的每块面元dS沿某方向r的发光强度，θ为r与法线n的夹角。<br>从远处看，发光球体像是一个发光圆盘，这就是余弦发光体，太阳就是余弦发光体。<br><strong>物体表面对电磁波的反射有三种形式</strong>：</p>
<ol>
<li><strong>镜面反射</strong>：反射能量集中在一个方向，反射角=入射角。</li>
<li><strong>漫反射</strong>：整个表面都均匀地向各向反射入射光。</li>
<li><strong>方向反射</strong>：介于漫反射和镜面反射之间，各向都有反射，但各向反射强度不均一。<strong>实际上多数自然表面对辐射的波长而言都是粗糙表面。当目标物的表面足够粗糙，以致于它对太阳短波辐射的反射辐射亮度在以目标物的中心的2π空间中呈常数，即反射辐射亮度不随观测角度而变，我们称该物体为漫反射体，亦称朗伯体。漫反射又称朗伯(Lambert)反射，也称各向同性反射。</strong></li>
</ol>
<p>对反射率的一些思考（从量纲量级角度）：</p>
<ol>
<li>牢记双向反射率的定义：</li>
</ol>
<script type="math/tex; mode=display">
r= I/J \quad [Sr^{-1}]</script><ol>
<li>假如没有吸收，且反射在$2\pi$空间内各向同性(朗伯体)，则某一表面</li>
</ol>
<ul>
<li>入射能量：$P_{in} = J\mu_0 = J (i =0)$</li>
<li>出射能量：$P_{out} = \int I cos e d\Omega = \int J r \cos e \sin ede d\varphi = J \pi[Sr] r [Sr^{-1}]$</li>
<li>能量守恒：</li>
</ul>
<script type="math/tex; mode=display">
P_{in} = P_{out} \Rightarrow r = {1\over \pi}</script><p><strong>各种反射率的范围</strong>：</p>
<p>BDR = r: 理想朗伯体为$1/\pi$；$[0,1/\pi]$<br>BDRF = r/cos(i): 范围待分析，本人研究过程中不常用！<br>RADF = $\pi r$: $[0,1]$<br>REFF = ${r\over cos i /\pi}$: $[0,1]$ (理想朗伯体的双向反射率最大！)</p>
<p><strong>对理想朗伯体而言，半球反射率与反射率因子在数值上相等</strong>：</p>
<p>理想朗伯体的双向反射率：$r = cos i /\pi$</p>
<p>设朗伯体表面积为S,入射辐照度为J,入射角为i,出射角为$\theta$,方位角为$\varphi$,则:<br>按定义，$r = I/J$<br>入射通量为：$\Phi_i = J S cos i$<br>出射通量为：</p>
<p>$\Phi_o = \int I S_\perp d\Omega = \int (rJ)(S cos\theta)d\Omega = rJS \int_0^{2\pi}\int_0^{\pi/2} cos\theta sin\theta d\theta d\varphi = rJS\pi$</p>
<p>按定义，半球反射率，$r_{dh} = {\Phi_o \over \Phi_i}= {rJS\pi \over JS cos i}= {\pi r \over cos i}$<br>于是，可推导出，$r = r_{dh} cos i/\pi$<br>进而，按定义，$REFF = {r \over cos i/\pi}= r_{dh}$</p>
<ol>
<li>考虑入射角为0的朗伯平面（perfectly diffuse surface）：</li>
</ol>
<script type="math/tex; mode=display">
r = 1/\pi</script><ul>
<li>从反照率</li>
</ul>
<script type="math/tex; mode=display">
A_L= {P_{out} \over J\mu_0} =1 \Rightarrow P_{out} = J = P_{in}; (\mu_0 =1)</script><p> <strong>满足能量守恒</strong></p>
<ul>
<li>从双向反射率：</li>
</ul>
<script type="math/tex; mode=display">
r = I/J = 1/\pi \Rightarrow I = Jr = J/\pi \Rightarrow \\P_{out} = \int_{上半球} I\mu d\Omega = J/\pi \int_{e=0}^{\pi/2} \cos e \sin e de \int_{\psi =0}^{2\pi} = J = P_{in}</script><p><strong>满足能量守恒</strong></p>
<ul>
<li>但</li>
</ul>
<script type="math/tex; mode=display">
\int_{上半球} r d\Omega = 2 \neq 1</script><ul>
<li>$RADF = \pi r =1$ ;因为完全反射，所以在各个方向上，$RADF=1$。</li>
<li><strong>基尔霍夫定律</strong>：发射率= 吸收率=1-反射率（在各个方向上都满足），<ul>
<li><strong>For an arbitrary body emitting and absorbing thermal radiation in thermodynamic equilibrium, the emissivity is equal to the absorptivity.</strong></li>
<li>a good absorber is a good emitter, and a poor absorber is a poor emitter,a good reflector must be a poor absorber.</li>
<li>In a blackbody enclosure that contains electromagnetic radiation with a certain amount of energy at thermodynamic equilibrium, this “photon gas” will have a Planck distribution of energies.</li>
<li><strong>black body radiation is equal in every direction (isotropic)</strong>, the emissivity and the absorptivity, if they happen to be dependent on direction, must again be equal for any given direction.</li>
<li><strong>此处的反射率不是双向反射率。</strong></li>
<li><strong>Kirchhoff ’s law applies to directional–hemispherical reflectance</strong>。(Bandfield,2018)<br>-</li>
</ul>
</li>
</ul>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>Roughness</title>
    <url>/posts/3086.html</url>
    <content><![CDATA[<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/09/09/image-20191216135323258-1599655814712.png" alt="title"><br>path difference（路程差）: $\Delta L = 2 h \cos \theta$</p>
<p>differ in phase（相位差）: $\Delta \phi = 2 \pi \Delta L /\lambda = 4 \pi h \cos \theta /\lambda$.</p>
<p>If $\Delta \phi \ll 2π$, say $\Delta \phi &lt; 2π/10$, then the roughness will have negligible effect on the reflected wave. Thus, one <strong>criterion</strong> for the surface to be considered smooth would be $h&lt;λsecθ/20$. The so-called <strong>Rayleigh criterion</strong> is somewhat less stringent（严格） than this and assumes that the effect of roughness will be negligible if $\Delta \phi &lt;π/2$, leading to,</p>
<script type="math/tex; mode=display">
h < \lambda \sec\theta /8;\quad \text{(瑞利标准)}</script><p>as the criterion for a surface to be considered smooth.</p>
<p>On the other hand, if the two portions of the wave front differ in phase by π or more, then they will certainly interfere with each other, either constructively or destructively, so that the surface will act as a rough scatterer if</p>
<script type="math/tex; mode=display">
h> \lambda \sec\theta /4</script><p>Note that the roughness criteria depend on θ. A surface may be rough for normal incidence but smooth for glancing incidence（掠入射）.</p>
]]></content>
  </entry>
  <entry>
    <title>wavelength dependence</title>
    <url>/posts/3899.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>Caj 转PDF</title>
    <url>/posts/5c18.html</url>
    <content><![CDATA[<h1 id="技巧积累"><a href="#技巧积累" class="headerlink" title="技巧积累"></a>技巧积累</h1><p>[toc]</p>
<h2 id="20200623-caj转pdf"><a href="#20200623-caj转pdf" class="headerlink" title="20200623 caj转pdf"></a>20200623 caj转pdf</h2><ol>
<li>虚拟打印</li>
</ol>
<ul>
<li>cajviewer 打印输出</li>
<li>福昕浏览器 打印机</li>
<li>微软打印机</li>
<li>只能单篇</li>
</ul>
<ol>
<li>在线转换工具</li>
</ol>
<ul>
<li>speedPDF</li>
<li>迅捷PDF转化器</li>
<li>免费次数和大小有限</li>
</ul>
<ol>
<li>知网直接下载PDF</li>
</ol>
<ul>
<li>插件tampermonkey：详见<a href="https://www.zhihu.com/question/49681481">https://www.zhihu.com/question/49681481</a></li>
<li>海外版知网</li>
<li>CNKI E-study 批量下载PDF</li>
</ul>
<ol>
<li>转换软件</li>
</ol>
<ul>
<li>“极速玩转”客户端</li>
<li>caj2pdf小工具，没用过，链接：<a href="https://pan.baidu.com/s/1KDRqVeaBQ6sJHYyrpLWn6g">https://pan.baidu.com/s/1KDRqVeaBQ6sJHYyrpLWn6g</a> 提取码：28sx</li>
<li><a href="https://firc.gitee.io：需要购买">https://firc.gitee.io：需要购买</a></li>
</ul>
<ol>
<li>直接修改后缀名？</li>
</ol>
<h2 id="20200624-github空间大小"><a href="#20200624-github空间大小" class="headerlink" title="20200624 github空间大小"></a>20200624 github空间大小</h2><ol>
<li>GitHub 有空间限制吗？</li>
</ol>
<p>没有限制。推荐1G以内。达到du1G以后会受到GITHUB的通知邮件，上传超过50M的单个文件会zhiwarning，无法上传超过100M的单个文件。dao目前大文件会提供一个1G的免费GIT-LFS空间。</p>
<ol>
<li><p>如何查看GitHub空间使用情况？</p>
</li>
<li><p>github更改密码之后，Gitnote还能自动同步吗？</p>
</li>
</ol>
<p>不能，对Gitnote而言，更改GitHub密码要慎重。</p>
<p>解决办法？重新将仓库复制到本地。</p>
<p>对git而言则无影响。</p>
<p>Gitnote仅在克隆仓库时需要输入GitHub账户和密码，这意味着，GitHub其实可以在本地同时为多个GitHub提供同步服务。</p>
<p><strong>图床呢？还能继续放到GitHub吗？</strong></p>
<p><img data-src="https://raw.githubusercontent.com/guolincq/gitnote-images/master/gitnote/2020/06/24/hapke-1592967492214.png" alt="title"></p>
<p>验证发现，是可以的。</p>
<h3 id="20200626-manim—用于数学科普，可视化展示。"><a href="#20200626-manim—用于数学科普，可视化展示。" class="headerlink" title="20200626 manim—用于数学科普，可视化展示。"></a>20200626 manim—用于数学科普，可视化展示。</h3><p>基本原理：绘图得到图像帧，压缩成视频。</p>
<p>使用思路：场景类（Scene），继承</p>
<p>代码，不同层次上的封装。</p>
]]></content>
  </entry>
  <entry>
    <title>Hockey-Stick relation</title>
    <url>/posts/459d.html</url>
    <content><![CDATA[<h2 id="Henyey-Greenstein-function"><a href="#Henyey-Greenstein-function" class="headerlink" title="Henyey-Greenstein function"></a><strong>Henyey-Greenstein function</strong></h2><script type="math/tex; mode=display">p(g)=\frac{1+c}{2} \frac{1-b^{2}}{\left(1-2 b \cos (g)+b^{2}\right)^{3 / 2}}+\frac{1-c}{2} \frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<p>b (0 ≤ b ≤ 1) is the shape-controlling parameter, and c (−1 ≤ c ≤ 1) is the relative strength of backward and forward lobes.</p>
<p>b is the angular width of the backward (first term) or forward (second term) scattering lobe and c is the magnitude of the lobe.</p>
<p>c&gt;0,后向；c&lt;0 前向</p>
<p>b控制形状：b越大，侧向散射越弱（b=1例外）</p>
<p>Narrow lobes have b values close to 1, wide lobes have values &lt;&lt; 1, and isotropically scattering particles have b = 0; 0 &lt;= b &lt; 1.</p>
<p>$p(g)=1$ 表示各向同性；$p(g)\neq 1$ 表示各项异性；$p(g) =0$ 表示完全吸收。</p>
</blockquote>
<p>Normalized: ${1\over 4\pi} \int_0^\pi p(g)2\pi \sin g d g = 1$</p>
<p>Asymmetry factor:$&lt;\cos \theta&gt; = {1\over 4\pi} \int_0^\pi \cos\theta p(\theta)2\pi \sin \theta d \theta = -bc$</p>
<p>for  a semi-infinite medium, the multiply scattered portion is much less sensitive to the particle phase function than the singly scattered fraction.</p>
<p>The brighter the surface, the more times the average photon is scattered before emerging from the surface, causing directional effects to be averaged out and the multiply scattered intensity distribution to closely approach the isotropic case.</p>
<p>Since the single-scattering term can be evaluated exactly for an arbitrary phase function and the multiply scattered term is relatively insensitive to phase function, a first-order expression for nonisotropic scatterers can be obtained by using the exact expression for the single-scattered term but retaining the isotropic solution for the multiply-scattered term.</p>
<p>多次散射项不像单次散射项那样对相函数明显，通常，表面越亮，多次散射的次数越多，其方向性就被平均掉了，所以一般多次散射项都当做各向同性处理。</p>
<h2 id="hockey-stick-relation"><a href="#hockey-stick-relation" class="headerlink" title="hockey stick relation"></a>hockey stick relation</h2><script type="math/tex; mode=display">c=3.29 \exp \left(-17.4 b^{2}\right)-0.908</script><h2 id="other-phase-function"><a href="#other-phase-function" class="headerlink" title="other phase function"></a>other phase function</h2><ul>
<li>单参数HG函数</li>
</ul>
<script type="math/tex; mode=display">
p(g)=\frac{1-b^{2}}{\left(1+2 b \cos (g)+b^{2}\right)^{3 / 2}}</script><blockquote>
<ul>
<li>$(1/4\pi)\int_{4\pi}p(g)d\Omega = 1$</li>
<li>$\theta = \pi - g$</li>
<li>参数b为余弦不对称因子：$b = &lt;\cos \theta&gt;=-&lt;\cos g&gt;$</li>
<li>b=0时，$p(g)=1$,各向同性</li>
</ul>
</blockquote>
<ul>
<li>普通多项式（三阶）</li>
</ul>
<script type="math/tex; mode=display">
f(g)=p_{1} g^{3}+p_{2} g^{2}+p_{3} g+p_{4}</script><ul>
<li>普通多项式（四阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>普通多项式（六阶）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha, \lambda)=\mathrm{A}_{0}+\mathrm{A}_{1} \alpha+\mathrm{A}_{2} \mathrm{a}^{2}+\mathrm{A}_{3} \mathrm{\alpha}^{3}+\mathrm{A}_{4} \mathrm{\alpha}^{4}+\mathrm{A}_{5} \mathrm{\alpha}^{5}+\mathrm{A}_{6} \mathrm{\alpha}^{6}</script><ul>
<li>普通多项式+指数项（指数项模拟背散射效应）</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=b_{0} e^{-b_{1} \alpha}+a_{0}+a_{1} \alpha+a_{2} \alpha^{2}+a_{3} \alpha^{3}+a_{4} \alpha^{4}</script><ul>
<li>勒让德多项式</li>
</ul>
<script type="math/tex; mode=display">
P(g)=1+b \times \cos (g)+c \times\left(1.5 \times \cos ^{2}(g)-0.5\right)</script><p>$P_1 = \cos \theta; P_2 = {1\over 2}(3\cos^2\theta -1)$</p>
<ul>
<li>指数形式</li>
</ul>
<script type="math/tex; mode=display">
f(\alpha)=e^{\beta \alpha+\gamma \alpha^{2}+\delta \alpha^{3}}</script><ul>
<li>其他形式：</li>
</ul>
<blockquote>
<p>三阶多项式<br>一阶勒让德多项式<br>线性双项HG函数？</p>
</blockquote>
<h2 id="Are-planetary-regolith-particles-backscattering-Hapke-1996"><a href="#Are-planetary-regolith-particles-backscattering-Hapke-1996" class="headerlink" title="Are planetary regolith particles backscattering? (Hapke,1996)"></a>Are planetary regolith particles backscattering? (Hapke,1996)</h2>]]></content>
  </entry>
  <entry>
    <title>GIS</title>
    <url>/posts/0.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>GitHub</title>
    <url>/posts/e16f.html</url>
    <content><![CDATA[<h1 id="github正确使用姿势"><a href="#github正确使用姿势" class="headerlink" title="github正确使用姿势"></a><a href="https://zhuanlan.zhihu.com/p/212470682">github正确使用姿势</a></h1><ol>
<li><p>注册、登录</p>
</li>
<li><p>搜索、查看（github.com/trending可查看项目趋势列表，发现优秀的开源项目）</p>
</li>
</ol>
<ul>
<li>star:越多越受欢迎</li>
<li>README：在code栏中，是对于该项目的介绍</li>
<li>issues:问题，任务，团队协作</li>
</ul>
<ol>
<li><p>建仓库</p>
</li>
<li><p>如何学习大神的代码？fork（复刻）</p>
</li>
<li><p>怎么判断github上的优质内容？</p>
</li>
</ol>
<ul>
<li>watch 关注</li>
<li>star 点赞<ul>
<li>表示支持</li>
<li>用作收藏，在<strong>your stars</strong>中可以查看</li>
</ul>
</li>
<li>fork<ul>
<li>由于学习，可任意删改</li>
<li>帮作者完善bug</li>
</ul>
</li>
</ul>
<ol>
<li>如何在github中寻找优质有趣的内容？</li>
</ol>
<ul>
<li>GitHub Explore 探索</li>
<li>GitHub Topic 热门话题</li>
<li>GitHub Trending 流行热榜<blockquote>
<p>注：spoken language 可选择自然语言；language可以选择计算机语言</p>
</blockquote>
</li>
<li>资源大全系列-GitHub Awesome</li>
<li>自定义搜索</li>
</ul>
<ol>
<li>不是程序员，github有哪些神奇用法</li>
</ol>
<ul>
<li><a href="https://github.com/1c7/chinese-independent-developer">中国独立开发者列表</a></li>
</ul>
<p>Do whatever you want, whatever works best for you, what makes you the most comfortable and seems like the best idea. Do what you love.<br>做任何你想做的事，做你所热爱的事情。</p>
<h1 id="github实践中遇见的问题及解决"><a href="#github实践中遇见的问题及解决" class="headerlink" title="github实践中遇见的问题及解决"></a>github实践中遇见的问题及解决</h1><ol>
<li>gitnote克隆问题：一定要是“master”branch.</li>
<li>交换文件时速度可能较慢，请耐心等候！</li>
</ol>
<p><strong>更改文件时，必须打开Gitnote，以便版本跟踪</strong><br>更新不及时也有可能是网络的问题？网速慢则上传需要时间？</p>
<h2 id="使用Git进行版本控制-1"><a href="#使用Git进行版本控制-1" class="headerlink" title="[使用Git进行版本控制][1]"></a>[使用Git进行版本控制][1]</h2><p>[1]:《python编程从入门到实践》. 附录D</p>
<p><strong>分布式版本控制</strong></p>
<p><strong>创建项目</strong></p>
<p>建立一个文件夹，作为项目文件夹。</p>
<p><strong>忽略文件</strong></p>
<p>.gitignore 文件中的目录将不被git跟踪。（例：__pycache__ 中的.pyc文件。）</p>
<p><strong>初始化仓库</strong></p>
<p>git init</p>
<p>.git 文件夹。内存有所有的历史记录。</p>
<p><strong>检查状态</strong></p>
<p>git status</p>
<p>在git中，<strong><em>分支</em></strong>是项目的一个版本。<strong>提交</strong>是项目在特定时间点的快照。</p>
<p><strong>将文件加入到仓库中</strong></p>
<p>git add .</p>
<p>并未提交文件，只是让Git关注文件。</p>
<p><strong>执行提交</strong></p>
<p>git commit -am “message”</p>
<p>-a  让Git将仓库中所有修改了的文件都加入到当前提交中。</p>
<p>-m 让Git在提交历史中记录一条消息。</p>
<p><strong>查看提交历史</strong></p>
<p>git log</p>
<p>更简单的版本：git log —pretty=oneline</p>
<p><strong>撤销修改</strong></p>
<p>git checkout .</p>
<p><strong>检出以前的提交</strong></p>
<p>git checkout (提交的引用ID的前6个字符)</p>
<p>git reset —hard (提交的引用ID的前6个字符) ;永久回到以前的提交。</p>
<p><strong>删除仓库</strong></p>
<p>rm -rf .git </p>
<p>删除.git文件夹等于删除整个仓库，之后只能重新初始化。</p>
<p><strong><a href="www.cnblogs.com/xiaopangjr/p/7469687.html">git 远程操作</a></strong></p>
<ul>
<li><p>git clone</p>
<blockquote>
<p> 远程操作的第一步，通常是从远程主机克隆一个版本库，这时就要用到<code>git clone</code>命令。 </p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$ git clone &lt;版本库的网址&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>如果要指定不同的目录名，可以将目录名作为<code>git clone</code>命令的第二个参数。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$ git clone &lt;版本库的网址&gt; &lt;本地目录名&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
</li>
<li><p>git remote</p>
<blockquote>
<p> Git要求每个远程主机都必须指定一个主机名。<code>git remote</code>命令就用于管理主机名。 </p>
<p> 不带选项的时候，<code>git remote</code>命令列出所有远程主机。 </p>
<p> 使用<code>-v</code>选项，可以参看远程主机的网址。 </p>
<p> 克隆版本库的时候，所使用的远程主机自动被Git命名为<code>origin</code>。如果想用其他的主机名，需要用<code>git clone</code>命令的<code>-o</code>选项指定。 </p>
<p> <code>git remote show</code>命令加上主机名，可以查看该主机的详细信息。 </p>
<p> <code>git remote add</code>命令用于添加远程主机。 </p>
<p> <code>git remote rm</code>命令用于删除远程主机。 </p>
<p> <code>git remote rename</code>命令用于远程主机的改名。 </p>
</blockquote>
</li>
<li><p>git fetch</p>
<blockquote>
<p> 一旦远程主机的版本库有了更新（Git术语叫做commit），需要将这些更新取回本地，这时就要用到<code>git fetch</code>命令。 </p>
</blockquote>
</li>
<li><p>git pull</p>
</li>
<li><p>git push</p>
</li>
</ul>
<h2 id="GitHub-本地仓库如何同步到github-com"><a href="#GitHub-本地仓库如何同步到github-com" class="headerlink" title="GitHub: 本地仓库如何同步到github.com?"></a>GitHub: 本地仓库如何同步到github.com?</h2><p>commit to master</p>
<p>push origin</p>
<h2 id="github-com上仓库改名之后还能同步吗？"><a href="#github-com上仓库改名之后还能同步吗？" class="headerlink" title="github.com上仓库改名之后还能同步吗？"></a>github.com上仓库改名之后还能同步吗？</h2><p>依然可以</p>
<p>即本地仓库同步到GitHub.com;在github.com建立一个仓库（默认同名，当然可以重命名）</p>
<p>两端建立联系之后，关系就固定了，一旦删除任何一端，都不能再同步，网站端可改名，不影响，桌面仍待研究；</p>
<p>目前的通式为：</p>
<ul>
<li>桌面端建立新仓库</li>
<li>publish your repository to github(此时可重命名；不过不推荐)</li>
<li>本地仓库内的改变可通过“commit to master”—&gt;push origin同步到网站。</li>
</ul>
<h2 id="网站端的内容能同步到本地端吗？"><a href="#网站端的内容能同步到本地端吗？" class="headerlink" title="网站端的内容能同步到本地端吗？"></a>网站端的内容能同步到本地端吗？</h2><p>事实证明可以。</p>
<p>可能是“fetch origin”，或者”pull origin”</p>
]]></content>
  </entry>
  <entry>
    <title>ten rules for scientific graphs</title>
    <url>/posts/69cf.html</url>
    <content><![CDATA[<h1 id="Ten-Simple-Rules-for-Better-Figures"><a href="#Ten-Simple-Rules-for-Better-Figures" class="headerlink" title="Ten Simple Rules for Better Figures"></a>Ten Simple Rules for Better Figures</h1><p>Scientific visualization is a graphical interface between people and data.</p>
<ol>
<li><p>Know Your Audience.(针对不同人群，简略程度不一样)</p>
</li>
<li><p>Identify Your Message. (明确要传达的信息)</p>
</li>
</ol>
<p>A figure is meant to express an idea or introduce some facts or a result that would be too long (or nearly impossible) to explain only with words, be it for an article or during a time-limited oral presentation.</p>
<ol>
<li>Adapt the Figure to the Support Medium.(根据媒体介质调整图像)</li>
</ol>
<p>each type of support medium requires a different figure.</p>
<ol>
<li>Captions Are Not Optional.(图注是必要的)</li>
</ol>
<p>you cannot explain everything within the figure itself—a figure should be accompanied by a caption.</p>
<ol>
<li>Do Not Trust the Defaults.(个性化调整是必需的)</li>
</ol>
<p>All plots require at least some manual tuning of the different settings to better express the message.</p>
<ol>
<li>Use Color Effectively.(高效运用颜色)</li>
</ol>
<p>to highlight some element of a figure, you can use color for this element while keeping other elements gray or black.</p>
<p> ‘‘Is there any reason this plot is blue and not black?’’ If you don’t know the answer, just keep it black.</p>
<p> avoid using too many similar colors.</p>
<ol>
<li>Do Not Mislead the Reader.</li>
</ol>
<p>两个例子：点的大小应用面积表示，而非半径。柱状图的纵轴范围。</p>
<p>shown as objectively as possible.</p>
<p>always use the simplest type of plots.</p>
<ol>
<li>Avoid ‘‘Chartjunk’’</li>
</ol>
<p>any decorations that do not tell the viewer something new must be banned.</p>
<ol>
<li>Message Trumps Beauty</li>
</ol>
<p>in science, message and readability of the figure is the most important aspect while beauty is only an option.</p>
<ol>
<li>Get the Right Tool</li>
</ol>
<p>the software or library you’re using to make a visualization can be different from the software or library you’re using to conduct your research and/or analyze your data.</p>
]]></content>
  </entry>
  <entry>
    <title>LaTeX 实践</title>
    <url>/posts/3afd.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>Python 实践</title>
    <url>/posts/0.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>HTML and XML</title>
    <url>/posts/d562.html</url>
    <content><![CDATA[<h1 id="HyperText-Markup-language-超文本标记语言"><a href="#HyperText-Markup-language-超文本标记语言" class="headerlink" title="HyperText Markup language (超文本标记语言)"></a>HyperText Markup language (超文本标记语言)</h1><ul>
<li>不是编程语言，不做逻辑处理</li>
<li>告诉浏览器如何构造网页</li>
</ul>
<p>起始标签：Opening Tag</p>
<p>结束标签：Closing Tag</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>块级元素</li>
<li>内联元素</li>
<li>attribute 属性</li>
</ul>
<p>CSS： Cascading Style Sheets 层叠样式表。</p>
<h1 id="xml-数据传输格式，可扩展性标记语言。"><a href="#xml-数据传输格式，可扩展性标记语言。" class="headerlink" title="xml: 数据传输格式，可扩展性标记语言。"></a>xml: <strong>数据传输</strong>格式，可扩展性标记语言。</h1><p>eXtensible Markup Language.</p>
<p>作用：</p>
<ul>
<li>传输数据，而不是展示数据（html展示数据）</li>
<li>配置文件</li>
<li>存储数据，小型数据库</li>
</ul>
<p>写xml文件，必须要有根节点。</p>
<p>XML与HTML的区别：</p>
<ul>
<li>HTML标签不能自定义，XML标签只能自定义；</li>
<li>HTML语法要求不严格，XML语法要求及其严格，必须是成对标签；</li>
<li>HTML用来展示数据，XML用来传输和存储数据。</li>
</ul>
<p>XML基本语法：</p>
<ol>
<li>语法规则</li>
</ol>
<ul>
<li>必须要有根节点；</li>
<li>xml头声明，可有可无，但建议写；</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>所有标签必须成对出现；</li>
<li>标签名大小写敏感；</li>
<li>标签不可交叉。</li>
</ul>
<blockquote>
<p>注释：<code>&lt;!--  --&gt;</code></p>
<p>特殊字符用实体转义：</p>
<ul>
<li><code>&amp;lt;</code>&lt;</li>
<li><code>&amp;gt;</code>$&gt;$</li>
<li><code>&amp;amp;</code> &amp;</li>
<li><code>&amp;apos;</code>&apos;</li>
<li><code>&amp;quot;</code>&quot;</li>
</ul>
</blockquote>
<ol>
<li>元素属性</li>
</ol>
<ul>
<li>描述标签</li>
<li>一个标签可以由多个标签，包含在引号内</li>
<li>命名规则：数字字母下划线，数字不能开头</li>
<li>xml中属性比较鸡肋</li>
<li>在解析xml数据时，属性会需要额外的代码</li>
</ul>
<ol>
<li>CDATA</li>
</ol>
<ul>
<li>不解析内容</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">&lt;![CDATA[不解析的内容]]&gt;</span><br></pre></td></tr></table></figure>
<h1 id="python-解析xml"><a href="#python-解析xml" class="headerlink" title="python 解析xml"></a>python 解析xml</h1><ul>
<li>xml.etree.ElementTree</li>
<li>xml.dom</li>
<li>xml.dom.minidom</li>
<li>xml.dom.pulldom</li>
<li>xml.sax</li>
<li>xml.parsers.expart</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.dom.minidom <span class="keyword">as</span> xdm</span><br><span class="line"></span><br><span class="line">dom = xdm.parse(file)</span><br><span class="line">root = dom.documentElement</span><br><span class="line"></span><br><span class="line">a = root.getElementsByTagNmame(<span class="string">&#x27;string&#x27;</span>)[<span class="number">0</span>].firstChild.data</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>获得子标签</li>
<li>区分相同标签名的标签</li>
<li>获取标签属性值</li>
<li>获取标签对之间的数据</li>
</ul>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>MATLAB</title>
    <url>/posts/5452.html</url>
    <content><![CDATA[<p>《科学计算与matlab语言》，中国大学MOOC， 中南大学</p>
<p><a href="https://www.icourse163.org/learn/CSU-1002475002#/learn/content">https://www.icourse163.org/learn/CSU-1002475002#/learn/content</a></p>
<h1 id="使用中的技巧发现"><a href="#使用中的技巧发现" class="headerlink" title="使用中的技巧发现"></a>使用中的技巧发现</h1><p>Pwd 输出当前工作目录，支持Linux命令。</p>
<p>diary - 将命令行窗口文本记录到日志文件中</p>
<p>save - 将工作区变量保存到文件中</p>
<p>load - 将文件变量加载到工作区中</p>
<h1 id="0-课程导入"><a href="#0-课程导入" class="headerlink" title="0 课程导入"></a>0 课程导入</h1><p>求x^2-3x+1=0的根。</p>
<blockquote>
<p> 方法一：利用MATLAB多项式求根函数roots来求根。</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">p</span>=[<span class="number">1</span>,-<span class="number">3</span>,<span class="number">1</span>]<span class="comment">;</span></span><br><span class="line"><span class="attr">x</span>=roots(p)</span><br></pre></td></tr></table></figure>
<p>绘图：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">x</span>=-<span class="number">5</span>:<span class="number">0</span>.<span class="number">1</span>:<span class="number">5</span>;</span><br><span class="line"><span class="attribute">y1</span>=x.*x-<span class="number">3</span>*x+<span class="number">1</span>;</span><br><span class="line"><span class="attribute">y2</span>=zeros(size(x));</span><br><span class="line"><span class="attribute">plot</span>(x, y<span class="number">1</span>, x, y<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p>方法二 ： 利用求单变量非线性方程根的函数fzero，求方程在某个初始点附近的实根。</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"> <span class="attr">f</span>=@(x) x*x-<span class="number">3</span>*x+<span class="number">1</span><span class="comment">;</span></span><br><span class="line"> <span class="attr">x1</span>=fzero(f, <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="attr">x2</span>=fzero(f, <span class="number">2.5</span>)</span><br></pre></td></tr></table></figure>
<p>方法三：利用最优化工具箱中的方程求根函数fsolve。</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"> <span class="attr">f</span>=@(x) x*x-<span class="number">3</span>*x+<span class="number">1</span><span class="comment">;</span></span><br><span class="line"> <span class="attr">x1</span>=fsolve(f, <span class="number">0.5</span>, optimset(<span class="string">&#x27;Display&#x27;</span>, <span class="string">&#x27;off&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="attr">x2</span>=fsolve(f, <span class="number">2.5</span>, optimset(<span class="string">&#x27;Display&#x27;</span>, <span class="string">&#x27;off&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>方法四：利用solve函数求方程的符号解，即求得的解是一个表达式。</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line"> syms <span class="keyword">x</span></span><br><span class="line"> <span class="keyword">x</span><span class="operator">=</span>solve(<span class="keyword">x</span>^<span class="number">2</span><span class="number">-3</span>*<span class="keyword">x</span>+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">x</span><span class="operator">=</span>eval(<span class="keyword">x</span>)</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="1-matlab基础知识"><a href="#1-matlab基础知识" class="headerlink" title="1 matlab基础知识"></a>1 matlab基础知识</h1><h2 id="1-1-matlab系统环境"><a href="#1-1-matlab系统环境" class="headerlink" title="1.1 matlab系统环境"></a>1.1 matlab系统环境</h2><h2 id="1-2-matlab数值数据"><a href="#1-2-matlab数值数据" class="headerlink" title="1.2 matlab数值数据"></a>1.2 matlab数值数据</h2><p>例1 分别求一个三位正整数的个位数字、十位数字和百位数字。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">m=<span class="number">345</span>;</span><br><span class="line">m1=<span class="built_in">rem</span>(m,<span class="number">10</span>)</span><br><span class="line">m2=<span class="built_in">rem</span>(<span class="built_in">fix</span>(m/<span class="number">10</span>),<span class="number">10</span>)</span><br><span class="line">m3=<span class="built_in">fix</span>(m/<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p>例2 求[1，100]区间的所有素数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">1</span>:<span class="number">100</span>;</span><br><span class="line">k=<span class="built_in">isprime</span>(x);</span><br><span class="line">k1=<span class="built_in">find</span>(k);</span><br><span class="line">p=x(k1)</span><br></pre></td></tr></table></figure>
<h2 id="1-3-变量及其操作"><a href="#1-3-变量及其操作" class="headerlink" title="1.3 变量及其操作"></a>1.3 变量及其操作</h2><p>例1 计算表达式的值，并将结果赋给变量z，然后显示计算结果。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="built_in">sqrt</span>(<span class="number">7</span>)<span class="number">-2</span><span class="built_in">i</span>;</span><br><span class="line">y=<span class="built_in">exp</span>(<span class="built_in">pi</span>/<span class="number">2</span>);</span><br><span class="line">z=(<span class="number">5</span>+<span class="built_in">cosd</span>(<span class="number">47</span>))/(<span class="number">1</span>+<span class="built_in">abs</span>(x-y))</span><br></pre></td></tr></table></figure>
<h2 id="1-4-MATLAB矩阵的表示方法"><a href="#1-4-MATLAB矩阵的表示方法" class="headerlink" title="1.4 MATLAB矩阵的表示方法"></a>1.4 MATLAB矩阵的表示方法</h2><h2 id="1-5-矩阵元素的引用"><a href="#1-5-矩阵元素的引用" class="headerlink" title="1.5 矩阵元素的引用"></a>1.5 矩阵元素的引用</h2><h2 id="1-6-MATLAB基本运算"><a href="#1-6-MATLAB基本运算" class="headerlink" title="1.6 MATLAB基本运算"></a>1.6 MATLAB基本运算</h2><p>例1 当x=0.1、0.4、0.7、1时，分别求y=sin x cos x的值。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">0.1</span>:<span class="number">0.3</span>:<span class="number">1</span>;</span><br><span class="line">y=<span class="built_in">sin</span>(x).*<span class="built_in">cos</span>(x)</span><br></pre></td></tr></table></figure>
<p>例2 建立3阶方阵A，判断A的元素是否为偶数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A =[<span class="number">24</span>,<span class="number">35</span>,<span class="number">13</span>;<span class="number">22</span>,<span class="number">63</span>,<span class="number">23</span>;<span class="number">39</span>,<span class="number">47</span>,<span class="number">80</span>]</span><br><span class="line">P=<span class="built_in">rem</span>(A,<span class="number">2</span>)==<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>例3 水仙花数是指各位数字的立方之和等于该数本身的三位正整数。求全部水仙花数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">m=<span class="number">100</span>:<span class="number">999</span>;</span><br><span class="line">m1=<span class="built_in">rem</span>(m,<span class="number">10</span>);</span><br><span class="line">m2=<span class="built_in">rem</span>(<span class="built_in">fix</span>(m/<span class="number">10</span>),<span class="number">10</span>);</span><br><span class="line">m3=<span class="built_in">fix</span>(m/<span class="number">100</span>);</span><br><span class="line">k=<span class="built_in">find</span>(m==m1.*m1.*m1+m2.*m2.*m2+m3.*m3.*m3)</span><br><span class="line">s=m(k)</span><br></pre></td></tr></table></figure>
<h2 id="1-7-字符串处理"><a href="#1-7-字符串处理" class="headerlink" title="1.7 字符串处理"></a>1.7 字符串处理</h2><p>例1 建立一个字符串向量，然后对该向量做如下处理：<br> ① 取第1～5个字符组成的子字符串。<br> ② 将字符串倒过来重新排列。<br> ③ 将字符串中的小写字母变成相应的大写字母，其余字符不变。<br> ④ 统计字符串中小写字母的个数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ch=<span class="string">&#x27;ABc123d4e56Fg9&#x27;</span>;</span><br><span class="line">subch=ch(<span class="number">1</span>:<span class="number">5</span>)  </span><br><span class="line">revch=ch(<span class="keyword">end</span>:<span class="number">-1</span>:<span class="number">1</span>) </span><br><span class="line">k=<span class="built_in">find</span>(ch&gt;=<span class="string">&#x27;a&#x27;</span>&amp;ch&lt;=<span class="string">&#x27;z&#x27;</span>) </span><br><span class="line">ch(k)=ch(k)-(<span class="string">&#x27;a&#x27;</span>-<span class="string">&#x27;A&#x27;</span>)    </span><br><span class="line"><span class="built_in">length</span>(k)</span><br></pre></td></tr></table></figure>
<h2 id="专题一总结"><a href="#专题一总结" class="headerlink" title="专题一总结"></a>专题一总结</h2><h1 id="2-matlab-矩阵处理"><a href="#2-matlab-矩阵处理" class="headerlink" title="2 matlab 矩阵处理"></a>2 matlab 矩阵处理</h1><h2 id="2-1-特殊矩阵"><a href="#2-1-特殊矩阵" class="headerlink" title="2.1 特殊矩阵"></a>2.1 特殊矩阵</h2><p>例1 产生5阶两位随机整数矩阵A，再产生均值为0.6、方差为0.1的5阶正态分布随机矩阵B，验证(A+B)I=IA+BI（I为单位矩阵）。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A=<span class="built_in">fix</span>(<span class="number">10</span>+(<span class="number">99</span><span class="number">-10</span>+<span class="number">1</span>)*<span class="built_in">rand</span>(<span class="number">5</span>));</span><br><span class="line">B=<span class="number">0.6</span>+<span class="built_in">sqrt</span>(<span class="number">0.1</span>)*<span class="built_in">randn</span>(<span class="number">5</span>);</span><br><span class="line">C=<span class="built_in">eye</span>(<span class="number">5</span>);</span><br><span class="line">(A+B)*C==C*A+B*C</span><br></pre></td></tr></table></figure>
<p>例2 产生8阶魔方阵，求其每行每列元素的和。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">M=<span class="built_in">magic</span>(<span class="number">8</span>);</span><br><span class="line">sum(M(<span class="number">1</span>,:))</span><br><span class="line">sum(M(:,<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>例3 生成5阶帕斯卡矩阵，验证它的逆矩阵的所有元素也为整数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">format <span class="built_in">rat</span></span><br><span class="line">P=<span class="built_in">pascal</span>(<span class="number">5</span>)</span><br><span class="line">inv(P)</span><br></pre></td></tr></table></figure>
<h2 id="2-2-矩阵变换"><a href="#2-2-矩阵变换" class="headerlink" title="2.2 矩阵变换"></a>2.2 矩阵变换</h2><p>例1 先建立5×5矩阵A，然后将A的第一行元素乘以1，第二行乘以2，…，第五行乘以5。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A=[<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>;<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">1</span>;<span class="number">4</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span>;<span class="number">1</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">3</span>;<span class="number">1</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">9</span>]</span><br><span class="line">D=<span class="built_in">diag</span>(<span class="number">1</span>:<span class="number">5</span>);</span><br><span class="line">D*A</span><br></pre></td></tr></table></figure>
<p>要将A的各列元素分别乘以对角阵的对角线元素。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A=[<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>;<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">1</span>;<span class="number">4</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span>;<span class="number">1</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">3</span>;<span class="number">1</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">9</span>]</span><br><span class="line">D=<span class="built_in">diag</span>(<span class="number">1</span>:<span class="number">5</span>);</span><br><span class="line">A*D</span><br></pre></td></tr></table></figure>
<p>例2 验证魔方阵的主对角线、副对角线元素之和相等。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A=<span class="built_in">magic</span>(<span class="number">5</span>);</span><br><span class="line">D1=<span class="built_in">diag</span>(A);</span><br><span class="line">sum(D1)</span><br><span class="line"></span><br><span class="line">B=<span class="built_in">flipud</span>(A);</span><br><span class="line">D2=<span class="built_in">diag</span>(B);</span><br><span class="line">sum(D2)</span><br></pre></td></tr></table></figure>
<p>例3 用求逆矩阵的方法解线性方程组Ax=b。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>;<span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>;<span class="number">1</span>,<span class="number">8</span>,<span class="number">27</span>];</span><br><span class="line">b=[<span class="number">5</span>;<span class="number">-2</span>;<span class="number">6</span>];</span><br><span class="line">x=inv(A)*b</span><br><span class="line">x=A\b</span><br></pre></td></tr></table></figure>
<h2 id="2-3-矩阵求值"><a href="#2-3-矩阵求值" class="headerlink" title="2.3 矩阵求值"></a>2.3 矩阵求值</h2><p>例1 验证det(A-1)=1/det(A)。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">format <span class="built_in">rat</span></span><br><span class="line">A=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>;<span class="number">-3</span>,<span class="number">2</span>,<span class="number">1</span>;<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">det(inv(A))</span><br><span class="line"><span class="number">1</span>/det(A)</span><br></pre></td></tr></table></figure>
<p>例2 求3~20阶魔方阵的秩。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> n=<span class="number">3</span>:<span class="number">20</span></span><br><span class="line">  r(n)=rank(<span class="built_in">magic</span>(n));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">bar(r)</span><br><span class="line">grid on</span><br><span class="line">axis([<span class="number">2</span>,<span class="number">21</span>,<span class="number">0</span>,<span class="number">20</span>])</span><br><span class="line">[<span class="number">3</span>:<span class="number">20</span>;r(<span class="number">3</span>:<span class="number">20</span>)]</span><br></pre></td></tr></table></figure>
<p>例3 求2~10阶希尔伯特矩阵的条件数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> n=<span class="number">2</span>:<span class="number">10</span></span><br><span class="line">  c(n)=cond(<span class="built_in">hilb</span>(n));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">format long</span><br><span class="line">c&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="2-4-矩阵的特征值与特征向量"><a href="#2-4-矩阵的特征值与特征向量" class="headerlink" title="2.4 矩阵的特征值与特征向量"></a>2.4 矩阵的特征值与特征向量</h2><p>例1 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">R=[<span class="number">-1</span>,<span class="number">2</span>,<span class="number">0</span>;<span class="number">2</span>,<span class="number">-4</span>,<span class="number">1</span>;<span class="number">1</span>,<span class="number">1</span>,<span class="number">-6</span>];</span><br><span class="line">S=[<span class="number">1</span>,<span class="number">2</span>;<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">A=[R,<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">2</span>);<span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">3</span>),S];</span><br><span class="line">[X1,d1]=eig(R)</span><br><span class="line">[X2,d2]=eig(S)</span><br><span class="line">[X3,d3]=eig(A)</span><br></pre></td></tr></table></figure>
<p>例2</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">0</span>,<span class="number">0.5</span>,<span class="number">0.5</span>,<span class="number">3</span>,<span class="number">5.5</span>,<span class="number">5.5</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>;<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">8</span>];</span><br><span class="line">A=[<span class="number">1</span>,<span class="number">0.5</span>;<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line">y=A*x;</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">fill(x(<span class="number">1</span>,:),x(<span class="number">2</span>,:),<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">fill(y(<span class="number">1</span>,:),y(<span class="number">2</span>,:),<span class="string">&#x27;r&#x27;</span>); </span><br></pre></td></tr></table></figure>
<h2 id="2-5-稀疏矩阵"><a href="#2-5-稀疏矩阵" class="headerlink" title="2.5 稀疏矩阵"></a>2.5 稀疏矩阵</h2><p>求下列三对角线性方程组的解。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">kf1=[<span class="number">1</span>;<span class="number">1</span>;<span class="number">2</span>;<span class="number">1</span>;<span class="number">0</span>];</span><br><span class="line">k0=[<span class="number">2</span>;<span class="number">4</span>;<span class="number">6</span>;<span class="number">6</span>;<span class="number">1</span>];</span><br><span class="line">k1=[<span class="number">0</span>;<span class="number">3</span>;<span class="number">1</span>;<span class="number">4</span>;<span class="number">2</span>];</span><br><span class="line">B=[kf1,k0,k1];</span><br><span class="line">d=[<span class="number">-1</span>;<span class="number">0</span>;<span class="number">1</span>];</span><br><span class="line">A=spdiags(B,d,<span class="number">5</span>,<span class="number">5</span>);</span><br><span class="line">f=[<span class="number">0</span>;<span class="number">3</span>;<span class="number">2</span>;<span class="number">1</span>;<span class="number">5</span>];</span><br><span class="line">x=A\f</span><br></pre></td></tr></table></figure>
<h2 id="专题二总结"><a href="#专题二总结" class="headerlink" title="专题二总结"></a>专题二总结</h2><h1 id="3-matlab-程序流程控制"><a href="#3-matlab-程序流程控制" class="headerlink" title="3 matlab 程序流程控制"></a>3 matlab 程序流程控制</h1><h2 id="3-1-顺序结构程序"><a href="#3-1-顺序结构程序" class="headerlink" title="3.1 顺序结构程序"></a>3.1 顺序结构程序</h2><p>例1 有一线段AB，A的坐标为(1，1)，B的坐标为(4.5，4.5)，求AB的长度，以及黄金分割点C的坐标。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">a=input(<span class="string">&#x27;a=&#x27;</span>);</span><br><span class="line">b=input(<span class="string">&#x27;b=&#x27;</span>);</span><br><span class="line">c=a+<span class="number">0.618</span>*(b-a);</span><br><span class="line">s=<span class="built_in">abs</span>(a-b);</span><br><span class="line"><span class="built_in">disp</span>(s)</span><br><span class="line"><span class="built_in">disp</span>(c)</span><br></pre></td></tr></table></figure>
<h2 id="3-2-用if语句实现选择结构"><a href="#3-2-用if语句实现选择结构" class="headerlink" title="3.2 用if语句实现选择结构"></a>3.2 用if语句实现选择结构</h2><p>例1 输入一个整数，若为奇数则输出其平方根，否则输出其立方根。 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=input(<span class="string">&#x27;请输入x的值:&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">rem</span>(x,<span class="number">2</span>)==<span class="number">1</span></span><br><span class="line">  y=<span class="built_in">sqrt</span>(x);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  y=x^(<span class="number">1</span>/<span class="number">3</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">y</span><br></pre></td></tr></table></figure>
<p>例2 输入一个字符，若为大写字母，则输出其对应的小写字母；若为小写字母，则输出其对应的大写字母；若为数字字符则输出其对应数的平方，若为其他字符则原样输出。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">c=input(<span class="string">&#x27;请输入一个字符：&#x27;</span>,<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> c&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; c&lt;=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">  <span class="built_in">disp</span>(lower(c))</span><br><span class="line"><span class="keyword">elseif</span> c&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; c&lt;=<span class="string">&#x27;z&#x27;</span></span><br><span class="line">  <span class="built_in">disp</span>(upper(c))</span><br><span class="line"><span class="keyword">elseif</span> c&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; c&lt;=<span class="string">&#x27;9&#x27;</span></span><br><span class="line">  <span class="built_in">disp</span>(str2double(c)^<span class="number">2</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">disp</span>(c)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="3-3-用switch语句实现选择结构"><a href="#3-3-用switch语句实现选择结构" class="headerlink" title="3.3 用switch语句实现选择结构"></a>3.3 用switch语句实现选择结构</h2><p>例1 输入一个英文单词，判断它是否以元音字母开头。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">c=input(<span class="string">&#x27;请输入一个单词：&#x27;</span>,<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line"><span class="keyword">switch</span> c(<span class="number">1</span>) </span><br><span class="line">  <span class="keyword">case</span> &#123;<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;u&#x27;</span>&#125; </span><br><span class="line">    <span class="built_in">disp</span>([c,<span class="string">&#x27;以元音字母开头&#x27;</span>]);</span><br><span class="line">  <span class="keyword">otherwise</span> </span><br><span class="line">    <span class="built_in">disp</span>([c,<span class="string">&#x27;以辅音字母开头&#x27;</span>]);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">c=input(<span class="string">&#x27;请输入一个单词：&#x27;</span>,<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> findstr(c(<span class="number">1</span>),<span class="string">&#x27;AEIOUaeiou&#x27;</span>)&gt;<span class="number">0</span></span><br><span class="line">  <span class="built_in">disp</span>([c,<span class="string">&#x27;以元音字母开头&#x27;</span>]);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">disp</span>([c,<span class="string">&#x27;以辅音字母开头&#x27;</span>]);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p> 例2 PM2.5是指大气中直径小于或等于2.5微米的可入肺颗粒物，是衡量空气质量的重要指标。假定空气质量等级以PM2.5数值划分为6级。 PM2.5数值[0，35）空气质量为优，[35，75）为良，[75，115）为轻度污染，[115，150）为中度污染，[150，250）为重度污染，大于等于250为严重污染。编写程序，输入PM2.5数值，输出空气质量等级。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">g=input(<span class="string">&#x27;请输入PM2.5值：&#x27;</span>);</span><br><span class="line"><span class="keyword">switch</span> <span class="built_in">fix</span>(g) </span><br><span class="line">  <span class="keyword">case</span> <span class="built_in">num2cell</span>(<span class="number">0</span>:<span class="number">34</span>) </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;空气质量优&#x27;</span>);</span><br><span class="line">  <span class="keyword">case</span> <span class="built_in">num2cell</span>(<span class="number">35</span>:<span class="number">74</span>) </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;空气质量良好&#x27;</span>);</span><br><span class="line">  <span class="keyword">case</span> <span class="built_in">num2cell</span>(<span class="number">75</span>:<span class="number">114</span>) </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;空气质量轻度污染&#x27;</span>);</span><br><span class="line">  <span class="keyword">case</span> <span class="built_in">num2cell</span>(<span class="number">115</span>:<span class="number">149</span>) </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;空气质量中度污染&#x27;</span>); </span><br><span class="line">  <span class="keyword">case</span> <span class="built_in">num2cell</span>(<span class="number">150</span>:<span class="number">249</span>) </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;空气质量重度污染&#x27;</span>); </span><br><span class="line">  <span class="keyword">otherwise</span> </span><br><span class="line">    <span class="built_in">disp</span>(<span class="string">&#x27;空气质量严重污染&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="3-4-用for语句实现循环"><a href="#3-4-用for语句实现循环" class="headerlink" title="3.4 用for语句实现循环"></a>3.4 用for语句实现循环</h2><p>计算圆周率π。</p>
<blockquote>
<p> （1）利用无穷级数展开式求π的近似值。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">y=<span class="number">0</span>;</span><br><span class="line">g=<span class="number">-1</span>;</span><br><span class="line">n=input(<span class="string">&#x27;n=?&#x27;</span>); </span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n</span><br><span class="line">  g=-g;</span><br><span class="line">  y=y+g/(<span class="number">2</span>*<span class="built_in">i</span><span class="number">-1</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">pai=<span class="number">4</span>*y</span><br></pre></td></tr></table></figure>
<p>用向量求和的方法实现程序：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">n=input(<span class="string">&#x27;n=?&#x27;</span>);</span><br><span class="line">x=<span class="number">1</span>:<span class="number">2</span>:(<span class="number">2</span>*n<span class="number">-1</span>);</span><br><span class="line">y=(<span class="number">-1</span>).^(<span class="number">2</span>:n+<span class="number">1</span>)./x;</span><br><span class="line">pai=sum(y)*<span class="number">4</span></span><br></pre></td></tr></table></figure>
<p> （2）利用定积分的近似值求π的近似值。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">a=<span class="number">0</span>;</span><br><span class="line">b=<span class="number">1</span>;</span><br><span class="line">n=input(<span class="string">&#x27;n=?&#x27;</span>);</span><br><span class="line">h=(b-a)/n;</span><br><span class="line">x=a:h:b;</span><br><span class="line">f=<span class="built_in">sqrt</span>(<span class="number">1</span>-x.*x);</span><br><span class="line">s=[];</span><br><span class="line"><span class="keyword">for</span> k=<span class="number">1</span>:n</span><br><span class="line">  s1=(f(k)+f(k+<span class="number">1</span>))*h/<span class="number">2</span>;</span><br><span class="line">  s=[s,s1];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">pai=<span class="number">4</span>*sum(s)</span><br></pre></td></tr></table></figure>
<p>（3）利用蒙特卡洛法求π的近似值。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;  s=<span class="number">0</span>;</span><br><span class="line">&gt;  n=input(<span class="string">&#x27;n=?&#x27;</span>);</span><br><span class="line">&gt;  <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n</span><br><span class="line">&gt;    x=<span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">&gt;    y=<span class="built_in">rand</span>(<span class="number">1</span>);</span><br><span class="line">&gt;    <span class="keyword">if</span> x*x+y*y&lt;=<span class="number">1</span></span><br><span class="line">&gt;      s=s+<span class="number">1</span>;</span><br><span class="line">&gt;    <span class="keyword">end</span></span><br><span class="line">&gt;  <span class="keyword">end</span></span><br><span class="line">&gt;  pai=s/n*<span class="number">4</span></span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="3-5-用while语句实现循环"><a href="#3-5-用while语句实现循环" class="headerlink" title="3.5 用while语句实现循环"></a>3.5 用while语句实现循环</h2><p>例1 从键盘输入若干个数，当输入0时结束输入，求这些数的平均值和它们之和。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">msum=<span class="number">0</span>;</span><br><span class="line">n=<span class="number">0</span>;</span><br><span class="line">x=input(<span class="string">&#x27;Enter a number (end in 0):&#x27;</span>);</span><br><span class="line"><span class="keyword">while</span> x~=<span class="number">0</span></span><br><span class="line">  msum=msum+x;</span><br><span class="line">  n=n+<span class="number">1</span>;</span><br><span class="line">  x=input(<span class="string">&#x27;Enter a number (end in 0):&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> n&gt;<span class="number">0</span></span><br><span class="line">  msum</span><br><span class="line">  <span class="built_in">mean</span>=msum/n</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>例2 求[100，200]之间第一个能被21整除的整数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> n=<span class="number">100</span>:<span class="number">200</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">rem</span>(n,<span class="number">21</span>)~=<span class="number">0</span></span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  n</span><br><span class="line">  <span class="keyword">break</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>例3 用筛选法求某自然数范围内的全部素数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">m=input(<span class="string">&#x27;m=&#x27;</span>); </span><br><span class="line">p=<span class="number">1</span>:m;</span><br><span class="line">p(<span class="number">1</span>)=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">2</span>:<span class="built_in">sqrt</span>(m)</span><br><span class="line">  <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">2</span>*<span class="built_in">i</span>:<span class="built_in">i</span>:m</span><br><span class="line">    p(<span class="built_in">j</span>)=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">n=<span class="built_in">find</span>(p~=<span class="number">0</span>);</span><br><span class="line">p(n)</span><br></pre></td></tr></table></figure>
<h2 id="3-6-函数文件的定义与调用"><a href="#3-6-函数文件的定义与调用" class="headerlink" title="3.6 函数文件的定义与调用"></a>3.6 函数文件的定义与调用</h2><p>例1 编写函数文件，求半径为r的圆的面积和周长。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[s,p]</span>=<span class="title">fcircle</span><span class="params">(r)</span></span></span><br><span class="line">s=<span class="built_in">pi</span>*r*r;</span><br><span class="line">p=<span class="number">2</span>*<span class="built_in">pi</span>*r;</span><br></pre></td></tr></table></figure>
<p>例2 已知=(40)/((30)+(20))<br> ①当()=+10 ln⁡(^2+5)时，的值是多少。<br> ②当()=1×2+2×3+3×4+⋯+×(+1)时，的值是多少。<br> 分别用匿名函数和函数文件定义函数()。<br> 第②问的函数文件f2.m。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">f2</span><span class="params">(n)</span></span></span><br><span class="line">f=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> k=<span class="number">1</span>:n</span><br><span class="line">  f=f+k*(k+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>脚本文件mf.m。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">f1=@(n) n+<span class="number">10</span>*<span class="built_in">log</span>(n*n+<span class="number">5</span>);</span><br><span class="line">y1=f1(<span class="number">40</span>)/(f1(<span class="number">30</span>)+f1(<span class="number">20</span>))</span><br><span class="line">y2=f2(<span class="number">40</span>)/(f2(<span class="number">30</span>)+f2(<span class="number">20</span>))</span><br></pre></td></tr></table></figure>
<h2 id="3-7-函数的递归调用"><a href="#3-7-函数的递归调用" class="headerlink" title="3.7 函数的递归调用"></a>3.7 函数的递归调用</h2><p>例1 利用函数的递归调用，求n！。</p>
<blockquote>
<p> 函数文件fact.m如下：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">fact</span> <span class="params">(n)</span></span></span><br><span class="line"><span class="keyword">if</span> n&lt;=<span class="number">1</span></span><br><span class="line">  f=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  f=fact (n<span class="number">-1</span>)*n;  <span class="comment">%递归调用求(n-1)!</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>在脚本文件a.m中调用函数文件fact.m，求n!。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">n=input(<span class="string">&#x27;Please input n=&#x27;</span>);</span><br><span class="line">s=fact (n);</span><br><span class="line"><span class="built_in">disp</span>(s)</span><br></pre></td></tr></table></figure>
</blockquote>
<p>例2 Fibonacci数列定义如下：<br>         f1=1<br>         f2=1<br>         fn=fn-1+fn-2  （n>2）<br> 编写递归调用函数求Fibonacci数列的第n项，然后调用该函数验证Fibonacci数列的如下性质：</p>
<script type="math/tex; mode=display">
f1^2+f2^2+f3^2+……+fn^2=fn×fn+1</script><blockquote>
<p> 首先建立函数文件ffib.m。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">ffib</span><span class="params">(n)</span></span></span><br><span class="line"><span class="keyword">if</span> n&gt;<span class="number">2</span></span><br><span class="line">  f=ffib(n<span class="number">-1</span>)+ffib(n<span class="number">-2</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  f=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>建立程序文件test.m。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">F=[];</span><br><span class="line"><span class="keyword">for</span> k=<span class="number">1</span>:<span class="number">20</span></span><br><span class="line">  F=[F,ffib(k)*ffib(k)];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">sum(F)</span><br><span class="line">ffib(<span class="number">20</span>)*ffib(<span class="number">21</span>)</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="3-8-函数参数与变量作用范围"><a href="#3-8-函数参数与变量作用范围" class="headerlink" title="3.8 函数参数与变量作用范围"></a>3.8 函数参数与变量作用范围</h2><p>例1 利用nargin和nargout建立函数文件test.m。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fout</span>=<span class="title">test</span><span class="params">(a,b,c)</span></span></span><br><span class="line"><span class="keyword">if</span> nargin==<span class="number">1</span></span><br><span class="line">  fout=a;</span><br><span class="line"><span class="keyword">elseif</span> nargin==<span class="number">2</span></span><br><span class="line">  fout=a+b;</span><br><span class="line"><span class="keyword">elseif</span> nargin==<span class="number">3</span></span><br><span class="line">  fout=(a*b*c)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>例2 利用全局变量建立函数文件wad.m。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">wad</span><span class="params">(x,y)</span></span></span><br><span class="line"><span class="keyword">global</span> ALPHA BETA</span><br><span class="line">f=ALPHA*x+BETA*y;</span><br></pre></td></tr></table></figure>
<h2 id="专题三总结"><a href="#专题三总结" class="headerlink" title="专题三总结"></a>专题三总结</h2><h1 id="4-matlab-绘图"><a href="#4-matlab-绘图" class="headerlink" title="4 matlab 绘图"></a>4 matlab 绘图</h1><h2 id="4-1-二维曲线"><a href="#4-1-二维曲线" class="headerlink" title="4.1 二维曲线"></a>4.1 二维曲线</h2><p>例1 绘制一条折线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">2.5</span>, <span class="number">3.5</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">y=[<span class="number">1.5</span>, <span class="number">2.0</span>, <span class="number">1</span>, <span class="number">1.5</span>];</span><br><span class="line"><span class="built_in">plot</span>(x, y)</span><br></pre></td></tr></table></figure>
<p>例2 绘制sin(x)、sin(2x)、sin(x/2)的函数曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">100</span>);</span><br><span class="line"> y=[<span class="built_in">sin</span>(x); <span class="built_in">sin</span>(<span class="number">2</span>*x); <span class="built_in">sin</span>(<span class="number">0.5</span>*x)];</span><br><span class="line"> <span class="built_in">plot</span>(x,y)</span><br><span class="line"></span><br><span class="line">t=<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line"> t1=t&#x27;;</span><br><span class="line"> x=[t1, t1, t1];</span><br><span class="line"> y=[<span class="built_in">sin</span>(t1), <span class="built_in">sin</span>(<span class="number">2</span>*t1), <span class="built_in">sin</span>(<span class="number">0.5</span>*t1)];</span><br><span class="line"> <span class="built_in">plot</span>(x,y)</span><br></pre></td></tr></table></figure>
<p> 例3 采用不同个数的数据点绘制正弦函数曲线，观察曲线形态。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t1=<span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">10</span>);</span><br><span class="line">t2=<span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">20</span>);</span><br><span class="line">t3=<span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">plot</span>(t1, <span class="built_in">sin</span>(t1), t2,<span class="built_in">sin</span>(t2)+<span class="number">1</span>, t3, <span class="built_in">sin</span>(t3)+<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p> 例4 用不同线型和颜色在同一坐标内绘制曲线及其包络线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=(<span class="number">0</span>:<span class="built_in">pi</span>/<span class="number">50</span>:<span class="number">2</span>*<span class="built_in">pi</span>)&#x27;;</span><br><span class="line">y1=<span class="number">2</span>*<span class="built_in">exp</span>(<span class="number">-0.5</span>*x)*[<span class="number">1</span>,<span class="number">-1</span>];</span><br><span class="line">y2=<span class="number">2</span>*<span class="built_in">exp</span>(<span class="number">-0.5</span>*x).*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*x);</span><br><span class="line">x1=<span class="number">0</span>:<span class="number">0.5</span>:<span class="number">6</span>;</span><br><span class="line">y3=<span class="number">2</span>*<span class="built_in">exp</span>(<span class="number">-0.5</span>*x1).*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*x1);</span><br><span class="line"><span class="built_in">plot</span>(x, y1, <span class="string">&#x27;k:&#x27;</span>, x, y2, <span class="string">&#x27;b--&#x27;</span>, x1, y3, <span class="string">&#x27;rp&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>例5 绘制函数sin(1/)的图形。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">0</span>:<span class="number">0.005</span>:<span class="number">0.2</span>;</span><br><span class="line">y=<span class="built_in">sin</span>(<span class="number">1.</span>/x);</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br></pre></td></tr></table></figure>
<p> 例6 采用fplot函数绘制函数sin⁡(1/x)。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">fplot(@(x) <span class="built_in">sin</span>(<span class="number">1.</span>/x),[<span class="number">0</span>,<span class="number">0.2</span>], <span class="string">&#x27;b&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例7 已知螺旋线的参数方程，绘制曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">fplot(@(t)t.*<span class="built_in">sin</span>(t), @(t)t.*<span class="built_in">cos</span>(t), [<span class="number">0</span>,<span class="number">10</span>*<span class="built_in">pi</span>], <span class="string">&#x27;r&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="4-2-绘制图形的辅助标注"><a href="#4-2-绘制图形的辅助标注" class="headerlink" title="4.2 绘制图形的辅助标注"></a>4.2 绘制图形的辅助标注</h2><p>例1 绘制[-2π，2π]区间的正弦曲线并给图形添加标题。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">-2</span>*<span class="built_in">pi</span>:<span class="number">0.05</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">y=<span class="built_in">sin</span>(x);</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br><span class="line">title(<span class="string">&#x27;y=sin(x)&#x27;</span>)</span><br><span class="line">title(&#123;<span class="string">&#x27;MATLAB&#x27;</span>, <span class="string">&#x27;y=sin(x)&#x27;</span>&#125;) </span><br></pre></td></tr></table></figure>
<blockquote>
<p>\bf 加粗</p>
<p>\it 斜体</p>
<p>\rm 正体</p>
<p>Color（’k’）,fontsize(11)</p>
</blockquote>
<p> 绘制[-2π，2π]区间的正弦曲线并给x轴添加标签。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">-2</span>*<span class="built_in">pi</span>:<span class="number">0.05</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">y=<span class="built_in">sin</span>(x);</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br><span class="line">title(<span class="string">&#x27;y=sin(x)&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;-2\pi \leq x \leq 2\pi&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 在前面的图形中添加文字说明。Text(x,y,txt);gtext(txt)</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">text(<span class="number">-2</span>*<span class="built_in">pi</span>, <span class="number">0</span>, <span class="string">&#x27;-2&#123;\pi&#125;&#x27;</span>)</span><br><span class="line"> text(<span class="number">3</span>, <span class="number">0.28</span>, <span class="string">&#x27;\leftarrow sin(x)&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例2 绘制不同频率的正弦曲线并用图例标注曲线。Legend()</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x = <span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">plot</span>(x, [<span class="built_in">sin</span>(x); <span class="built_in">sin</span>(<span class="number">2</span>*x); <span class="built_in">sin</span>(<span class="number">3</span>*x)])</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;sin(x)&#x27;</span>, <span class="string">&#x27;sin(2x)&#x27;</span>, <span class="string">&#x27;sin(3x)&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>绘制边长为1的正方形，并设置坐标轴。Axis()</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line"> y = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>];</span><br><span class="line"> <span class="built_in">plot</span>(x,y)</span><br><span class="line"> axis([<span class="number">-0.1</span>, <span class="number">1.1</span>, <span class="number">-0.1</span>, <span class="number">1.1</span>])</span><br><span class="line"> axis equal;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>axis equal</p>
<p>axis square</p>
<p>axis auto</p>
<p>axis off</p>
<p>axis on</p>
<p>grid on</p>
<p>grid off</p>
<p>grid</p>
<p>box on </p>
<p>box off</p>
<p>box</p>
</blockquote>
<p> 例3 绘制sin(x)、sin(2x)、sin(x/2)的函数曲线并添加图形标注。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">100</span>);</span><br><span class="line">y=[<span class="built_in">sin</span>(x); <span class="built_in">sin</span>(<span class="number">2</span>*x); <span class="built_in">sin</span>(<span class="number">0.5</span>*x)];</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br><span class="line">axis([<span class="number">0</span> <span class="number">7</span> <span class="number">-1.2</span>, <span class="number">1.2</span>]) </span><br><span class="line">title(<span class="string">&#x27;不同频率正弦函数曲线&#x27;</span>); </span><br><span class="line">xlabel(<span class="string">&#x27;Variable X&#x27;</span>); ylabel(<span class="string">&#x27;Variable Y&#x27;</span>); </span><br><span class="line">text(<span class="number">2.5</span>, <span class="built_in">sin</span>(<span class="number">2.5</span>), <span class="string">&#x27;sin(x)&#x27;</span>); </span><br><span class="line">text(<span class="number">1.5</span>, <span class="built_in">sin</span>(<span class="number">2</span>*<span class="number">1.5</span>), <span class="string">&#x27;sin(2x)&#x27;</span>);</span><br><span class="line">text(<span class="number">5.5</span>, <span class="built_in">sin</span>(<span class="number">0.5</span>*<span class="number">5.5</span>), <span class="string">&#x27;sin(0.5x)&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;sin(x)&#x27;</span>,<span class="string">&#x27;sin(2x)&#x27;</span>,<span class="string">&#x27;sin(0.5x)&#x27;</span>)</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p> 例4  用图形保持功能绘制两个同心圆。Hold on ;hold off;hold</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">100</span>);</span><br><span class="line">x = <span class="built_in">sin</span>(t); y = <span class="built_in">cos</span>(t);</span><br><span class="line"><span class="built_in">plot</span>(x, y, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> on;    </span><br><span class="line"><span class="built_in">plot</span>(<span class="number">2</span>*x, <span class="number">2</span>*y, <span class="string">&#x27;r--&#x27;</span>)</span><br><span class="line">grid on</span><br><span class="line">axis([<span class="number">-2.2</span> <span class="number">2.2</span> <span class="number">-2.2</span> <span class="number">2.2</span>])</span><br><span class="line">axis equal</span><br></pre></td></tr></table></figure>
<p> 划分2×2子图 subplot(m,n,p)</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>); </span><br><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>);</span><br><span class="line">y=<span class="built_in">sin</span>(x);</span><br><span class="line"><span class="built_in">plot</span>(x,y);</span><br><span class="line">title(<span class="string">&#x27;sin(x)&#x27;</span>);</span><br><span class="line">axis ([<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">-1</span>,<span class="number">1</span>]);</span><br></pre></td></tr></table></figure>
<p> 划分多子图</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)   </span><br><span class="line"><span class="built_in">plot</span>(x,<span class="built_in">sin</span>(x)<span class="number">-1</span>);</span><br><span class="line">title(<span class="string">&#x27;sin(x)-1&#x27;</span>);axis ([<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">-2</span>,<span class="number">0</span>])</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)   </span><br><span class="line"><span class="built_in">plot</span>(x,<span class="built_in">cos</span>(x)+<span class="number">1</span>);</span><br><span class="line">title(<span class="string">&#x27;cos(x)+1&#x27;</span>);axis ([<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">0</span>,<span class="number">2</span>])</span><br><span class="line">subplot(<span class="number">4</span>,<span class="number">4</span>,<span class="number">3</span>)   </span><br><span class="line"><span class="built_in">plot</span>(x,<span class="built_in">tan</span>(x));</span><br><span class="line">title(<span class="string">&#x27;tan(x)&#x27;</span>);axis ([<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">-40</span>,<span class="number">40</span>])</span><br><span class="line">subplot(<span class="number">4</span>,<span class="number">4</span>,<span class="number">8</span>)    </span><br><span class="line"><span class="built_in">plot</span>(x,<span class="built_in">cot</span>(x));</span><br><span class="line">title(<span class="string">&#x27;cot(x)&#x27;</span>);axis ([<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">-35</span>,<span class="number">35</span>])</span><br></pre></td></tr></table></figure>
<h2 id="4-3-其他形式的二维图形"><a href="#4-3-其他形式的二维图形" class="headerlink" title="4.3 其他形式的二维图形"></a>4.3 其他形式的二维图形</h2><p>例1 绘制1/的直角线性坐标图和三种对数坐标图。</p>
<p>对数坐标图semilogx();seilogy();loglog()</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">10</span>;</span><br><span class="line">y=<span class="number">1.</span>/x;</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(x,y) </span><br><span class="line">title(<span class="string">&#x27;plot(x,y)&#x27;</span>);grid on</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">semilogx(x,y)  </span><br><span class="line">title(<span class="string">&#x27;semilogx(x,y)&#x27;</span>);grid on</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">semilogy(x,y) </span><br><span class="line">title(<span class="string">&#x27;semilogy(x,y)&#x27;</span>);grid on</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">loglog(x,y) </span><br><span class="line">title(<span class="string">&#x27;loglog(x,y)&#x27;</span>);grid on</span><br></pre></td></tr></table></figure>
<p> 例2 按极坐标方程ρ=1-sin t绘制心形曲线。Polar(theta,rho,options)</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t = <span class="number">0</span>:<span class="built_in">pi</span>/<span class="number">100</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">r = <span class="number">1</span>-<span class="built_in">sin</span>(t);</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">polar(t,r)</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">t1 = t-<span class="built_in">pi</span>/<span class="number">2</span>;</span><br><span class="line">r1 = <span class="number">1</span>-<span class="built_in">sin</span>(t1);</span><br><span class="line">polar(t,r1)</span><br></pre></td></tr></table></figure>
<p> 例3 绘制分组条形图。bar(y,style);barh();stacked:堆积分组；groud:簇状分组（默认）</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">y=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>; <span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>; <span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>];</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">bar(y)</span><br><span class="line">title(<span class="string">&#x27;Group&#x27;</span>)</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">bar(y, <span class="string">&#x27;stacked&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Stack&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例4 下表是某公司2015~2017年家电类商品1月份的销售数据，绘制条形图对比数据。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">2015</span>,<span class="number">2016</span>,<span class="number">2017</span>];</span><br><span class="line">y=[<span class="number">68</span>,<span class="number">80</span>,<span class="number">115</span>,<span class="number">98</span>,<span class="number">102</span>;</span><br><span class="line"><span class="number">75</span>,<span class="number">88</span>,<span class="number">102</span>,<span class="number">99</span>,<span class="number">110</span>;</span><br><span class="line"><span class="number">81</span>,<span class="number">86</span>,<span class="number">125</span>,<span class="number">105</span>,<span class="number">115</span>];</span><br><span class="line">bar(x, y)</span><br><span class="line">title(<span class="string">&#x27;Group&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p> 例5 绘制服从高斯分布的直方图。hist();直角坐标系；rose():极坐标系。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">y=<span class="built_in">randn</span>(<span class="number">500</span>,<span class="number">1</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line">hist(y); </span><br><span class="line">title(<span class="string">&#x27;高斯分布直方图&#x27;</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>); </span><br><span class="line">x=<span class="number">-3</span>:<span class="number">0.2</span>:<span class="number">3</span>;</span><br><span class="line">hist(y,x); </span><br><span class="line">title(<span class="string">&#x27;指定区间中心点的直方图&#x27;</span>)&#x27;)</span><br></pre></td></tr></table></figure>
<p> 例6 绘制高斯分布数据在极坐标下的直方图。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">y=<span class="built_in">randn</span>(<span class="number">500</span>,<span class="number">1</span>);</span><br><span class="line">theta=y*<span class="built_in">pi</span>;</span><br><span class="line">rose(theta)</span><br><span class="line">title(<span class="string">&#x27;在极坐标下的直方图&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例7 某次考试优秀、良好、中等、及格、不及格的人数分别为：7、17、23、9、4，试用扇形统计图作成绩统计分析。Pie函数：扇形图；area函数：面积图</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">score = [<span class="number">5</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">9</span>, <span class="number">4</span>];</span><br><span class="line">ex = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line">pie(score, ex)  </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;优秀&#x27;</span>, <span class="string">&#x27;良好&#x27;</span>, <span class="string">&#x27;中等’, &#x27;</span>及格<span class="string">&#x27;, &#x27;</span>不及格<span class="string">&#x27;, …</span></span><br><span class="line"><span class="string">&#x27;</span>location&#x27;, <span class="string">&#x27;eastoutside&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例8 以散点图形式绘制桃心曲线。Scatter散点图；stairs阶梯图;stem杆图</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t = <span class="number">0</span>:<span class="built_in">pi</span>/<span class="number">50</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">x = <span class="number">16</span>*<span class="built_in">sin</span>(t).^<span class="number">3</span>;</span><br><span class="line">y = <span class="number">13</span>*<span class="built_in">cos</span>(t)<span class="number">-5</span>*<span class="built_in">cos</span>(<span class="number">2</span>*t)<span class="number">-2</span>*<span class="built_in">cos</span>(<span class="number">3</span>*t)-<span class="built_in">cos</span>(<span class="number">4</span>*t);</span><br><span class="line"><span class="built_in">scatter</span>(x,y,<span class="string">&#x27;rd&#x27;</span>,<span class="string">&#x27;filled&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例9 已知向量A、B，求A+B，并用矢量图表示。Compass 罗盘图；feather羽毛图；quiver箭头图</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A=[<span class="number">4</span>,<span class="number">5</span>]; B=[<span class="number">-10</span>,<span class="number">0</span>]; C=A+B;</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line">quiver(<span class="number">0</span>, <span class="number">0</span>, A(<span class="number">1</span>), A(<span class="number">2</span>));</span><br><span class="line">quiver(<span class="number">0</span>, <span class="number">0</span>, B(<span class="number">1</span>), B(<span class="number">2</span>));</span><br><span class="line">quiver(<span class="number">0</span>, <span class="number">0</span>, C(<span class="number">1</span>), C(<span class="number">2</span>));</span><br><span class="line">text(A(<span class="number">1</span>),A(<span class="number">2</span>),<span class="string">&#x27;A&#x27;</span>);text(B(<span class="number">1</span>),B(<span class="number">2</span>),<span class="string">&#x27;B&#x27;</span>); text(C(<span class="number">1</span>),C(<span class="number">2</span>),<span class="string">&#x27;C&#x27;</span>); </span><br><span class="line">axis ([<span class="number">-12</span>, <span class="number">6</span>, <span class="number">-1</span>, <span class="number">6</span>])</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<h2 id="4-4-三维曲线"><a href="#4-4-三维曲线" class="headerlink" title="4.4 三维曲线"></a>4.4 三维曲线</h2><p>例1 绘制一条空间折线。Plot3(x,y,z);fplot3</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">0.2</span>, <span class="number">1.8</span>, <span class="number">2.5</span>];</span><br><span class="line">y=[<span class="number">1.3</span>, <span class="number">2.8</span>, <span class="number">1.1</span>];</span><br><span class="line">z=[<span class="number">0.4</span>, <span class="number">1.2</span>, <span class="number">1.6</span>];</span><br><span class="line"><span class="built_in">plot3</span>(x, y, z)</span><br><span class="line">grid on</span><br><span class="line">axis([<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>]);</span><br></pre></td></tr></table></figure>
<p> 例2 绘制螺旋线 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t=<span class="built_in">linspace</span>(<span class="number">0</span>, <span class="number">10</span>*<span class="built_in">pi</span>, <span class="number">200</span>);</span><br><span class="line">x=<span class="built_in">sin</span>(t)+t.*<span class="built_in">cos</span>(t);</span><br><span class="line">y=<span class="built_in">cos</span>(t)-t.*<span class="built_in">sin</span>(t);</span><br><span class="line">z=t;</span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot3</span>(x, y, z)</span><br><span class="line">grid on</span><br><span class="line">subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot3</span>(x(<span class="number">1</span>:<span class="number">4</span>:<span class="number">200</span>), y(<span class="number">1</span>:<span class="number">4</span>:<span class="number">200</span>), z(<span class="number">1</span>:<span class="number">4</span>:<span class="number">200</span>))</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p> 例3 在空间不同位置绘制5条正弦曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t=<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">t=t&#x27;;</span><br><span class="line">x=[t, t, t, t, t];</span><br><span class="line">y=[<span class="built_in">sin</span>(t), <span class="built_in">sin</span>(t)+<span class="number">1</span>, <span class="built_in">sin</span>(t)+<span class="number">2</span>, <span class="built_in">sin</span>(t)+<span class="number">3</span>, <span class="built_in">sin</span>(t)+<span class="number">4</span>];</span><br><span class="line">z=x;</span><br><span class="line"><span class="built_in">plot3</span>(x,y,z)</span><br><span class="line">这个例子也可以采用以下代码实现。</span><br><span class="line">t=<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">x=t;</span><br><span class="line">y=[<span class="built_in">sin</span>(t); <span class="built_in">sin</span>(t)+<span class="number">1</span>; <span class="built_in">sin</span>(t)+<span class="number">2</span>; <span class="built_in">sin</span>(t)+<span class="number">3</span>; <span class="built_in">sin</span>(t)+<span class="number">4</span>];</span><br><span class="line">z=x;</span><br><span class="line"><span class="built_in">plot3</span>(x,y,z)</span><br></pre></td></tr></table></figure>
<p> 例4 绘制三条不同长度的正弦曲线。 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t1=<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">1.5</span>*<span class="built_in">pi</span>;</span><br><span class="line">t2=<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">t3=<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">3</span>*<span class="built_in">pi</span>;</span><br><span class="line"><span class="built_in">plot3</span>(t1,<span class="built_in">sin</span>(t1),t1, t2,<span class="built_in">sin</span>(t2)+<span class="number">1</span>,t2, …</span><br><span class="line">t3,<span class="built_in">sin</span>(t3)+<span class="number">2</span>,t3)</span><br></pre></td></tr></table></figure>
<p> 例5 绘制空间曲线</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t=<span class="number">0</span>:<span class="built_in">pi</span>/<span class="number">50</span>:<span class="number">6</span>*<span class="built_in">pi</span>;</span><br><span class="line">x=<span class="built_in">cos</span>(t);</span><br><span class="line">y=<span class="built_in">sin</span>(t);</span><br><span class="line">z=<span class="number">2</span>*t;</span><br><span class="line"><span class="built_in">plot3</span>(x,y,z,<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;X&#x27;</span>),ylabel(<span class="string">&#x27;Y&#x27;</span>),zlabel(<span class="string">&#x27;Z&#x27;</span>);</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p>例6 绘制墨西哥帽顶曲线。参数方程fplot3(funx,funy,funz,tlims[-5,5])</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">xt = @(t) <span class="built_in">exp</span>(-t/<span class="number">10</span>).*<span class="built_in">sin</span>(<span class="number">5</span>*t);</span><br><span class="line">yt = @(t) <span class="built_in">exp</span>(-t/<span class="number">10</span>).*<span class="built_in">cos</span>(<span class="number">5</span>*t);</span><br><span class="line">zt = @(t) t;</span><br><span class="line">fplot3(xt, yt, zt, [<span class="number">-12</span>, <span class="number">12</span>])</span><br></pre></td></tr></table></figure>
<p>用红色点划线绘制墨西哥帽顶曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">xt = @(t) <span class="built_in">exp</span>(-t/<span class="number">10</span>).*<span class="built_in">sin</span>(<span class="number">5</span>*t);</span><br><span class="line">yt = @(t) <span class="built_in">exp</span>(-t/<span class="number">10</span>).*<span class="built_in">cos</span>(<span class="number">5</span>*t);</span><br><span class="line">zt = @(t) t;</span><br><span class="line">fplot3(xt, yt, zt, [<span class="number">-12</span>, <span class="number">12</span>], <span class="string">&#x27;r-.&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="4-5-三维曲面："><a href="#4-5-三维曲面：" class="headerlink" title="4.5 三维曲面："></a>4.5 三维曲面：</h2><p>mesh三维网格图;surf三维曲面图;fmesh;fsurf;;meshgrid；meshc;meshz;surfc;surfl;</p>
<p>例1 绘制空间曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x = <span class="number">2</span>:<span class="number">6</span>; </span><br><span class="line">y = (<span class="number">3</span>:<span class="number">8</span>)&#x27;;</span><br><span class="line">[X, Y] = <span class="built_in">meshgrid</span>(x, y);</span><br><span class="line">Z = <span class="built_in">randn</span>(<span class="built_in">size</span>(X));</span><br><span class="line"><span class="built_in">plot3</span>(X,Y,Z)</span><br><span class="line">grid on;</span><br></pre></td></tr></table></figure>
<p> 例2 绘制三维曲面图。 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t = <span class="number">-2</span>:<span class="number">0.2</span>:<span class="number">2</span>; </span><br><span class="line">[X, Y] = <span class="built_in">meshgrid</span>(t);</span><br><span class="line">Z = X .* <span class="built_in">exp</span>(-X.^<span class="number">2</span> - Y.^<span class="number">2</span>);</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">mesh(X,Y,Z); </span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">surf(X,Y,Z); </span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot3</span>(X,Y,Z); </span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p> 例3 用4种方式绘制函数$z=(x-1)^2+(y-2)^2-1$曲面图。<br> 其中，x∈[0,2]，y∈[1,3]。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[x,y]=<span class="built_in">meshgrid</span>(<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">2</span>,<span class="number">1</span>:<span class="number">0.1</span>:<span class="number">3</span>);</span><br><span class="line"> z=(x<span class="number">-1</span>).^<span class="number">2</span>+(y<span class="number">-2</span>).^<span class="number">2</span><span class="number">-1</span>;</span><br><span class="line"> subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line"> meshc(x,y,z);title(<span class="string">&#x27;meshc(x,y,z)&#x27;</span>)</span><br><span class="line"> subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line"> meshz(x,y,z);title(<span class="string">&#x27;meshz(x,y,z)&#x27;</span>)</span><br><span class="line"> subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"> surfc(x,y,z);title(<span class="string">&#x27;surfc(x,y,z)&#x27;</span>)</span><br><span class="line"> subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>);</span><br><span class="line"> surfl(x,y,z); title(<span class="string">&#x27;surfl(x,y,z)&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例4 用cylinder函数分别绘制柱面、花瓶和圆锥面。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">Sphere(n=<span class="number">20</span>);cylinder(R,n=<span class="number">20</span>)</span><br><span class="line"> subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"> [x,y,z]=cylinder;</span><br><span class="line"> surf(x,y,z);</span><br><span class="line"> subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"> t=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">40</span>);</span><br><span class="line"> [x,y,z]= cylinder(<span class="number">2</span>+<span class="built_in">cos</span>(t),<span class="number">30</span>);</span><br><span class="line"> surf(x,y,z);</span><br><span class="line"> subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>);</span><br><span class="line"> [x,y,z]= cylinder(<span class="number">0</span>:<span class="number">0.2</span>:<span class="number">2</span>,<span class="number">30</span>);</span><br><span class="line"> surf(x,y,z);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Peaks()</span><br></pre></td></tr></table></figure>
<p> 例5 用cylinder函数绘制两个相互垂直且直径相等的圆柱面的相交图形。</p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">[<span class="meta">x</span>,y,z]= cylinder(1,60);</span><br><span class="line">z=[-1<span class="comment">*z(2,:);</span>z(2,:)];</span><br><span class="line">surf(<span class="meta">x</span>,y,z)</span><br><span class="line">hold <span class="meta">on</span></span><br><span class="line">surf(y,z,<span class="meta">x</span>)</span><br><span class="line">axis equal</span><br></pre></td></tr></table></figure>
<p> 例6 绘制螺旋曲面。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">funx</span> = @(u,v) u.*sin(v);</span><br><span class="line"><span class="attribute">funy</span> = @(u,v) -u.*cos(v);</span><br><span class="line"><span class="attribute">funz</span> = @(u,v) v;</span><br><span class="line"><span class="attribute">fsurf</span>(funx,funy,funz,[-<span class="number">5</span> <span class="number">5</span> -<span class="number">5</span> -<span class="number">2</span>])</span><br><span class="line"><span class="attribute">hold</span> <span class="literal">on</span></span><br><span class="line"><span class="attribute">fmesh</span>(funx,funy,funz,[-<span class="number">5</span> <span class="number">5</span> -<span class="number">2</span> <span class="number">2</span>])</span><br><span class="line"><span class="attribute">hold</span> <span class="literal">off</span></span><br></pre></td></tr></table></figure>
<h2 id="4-6-图形修饰处理"><a href="#4-6-图形修饰处理" class="headerlink" title="4.6 图形修饰处理"></a>4.6 图形修饰处理</h2><blockquote>
<p>视点处理：方位角；仰角；view(az=-37.5,el=30)</p>
<p>View(x,y,z)</p>
<p>色彩处理[RGB]</p>
<p>colormap</p>
<p>剪裁处理</p>
</blockquote>
<p>例1 绘制函数$z=(x-1)^2+(y-2)^2-1$曲面，并从不同视点展示曲面。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[x,y]=<span class="built_in">meshgrid</span>(<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">2</span>, <span class="number">1</span>:<span class="number">0.1</span>:<span class="number">3</span>);</span><br><span class="line">z=(x<span class="number">-1</span>).^<span class="number">2</span>+(y<span class="number">-2</span>).^<span class="number">2</span><span class="number">-1</span>;</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>); mesh(x,y,z)</span><br><span class="line">title(<span class="string">&#x27;方位角=-37.5&#123;\circ&#125;,仰角=30&#123;\circ&#125;&#x27;</span>)</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>); mesh(x,y,z)</span><br><span class="line">view(<span class="number">0</span>,<span class="number">90</span>);title(<span class="string">&#x27;方位角=0&#123;\circ&#125;,仰角=90&#123;\circ&#125;&#x27;</span>)</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>); mesh(x,y,z)</span><br><span class="line">view(<span class="number">90</span>,<span class="number">0</span>); title(<span class="string">&#x27;方位角=90&#123;\circ&#125;,仰角=0&#123;\circ&#125;&#x27;</span>)</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>); mesh(x,y,z)</span><br><span class="line">view(<span class="number">-45</span>,<span class="number">-60</span>); title(<span class="string">&#x27;方位角=-45&#123;\circ&#125;,仰角=-60&#123;\circ&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p> 例2 创建一个灰色系列色图矩阵。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">c = [<span class="number">0</span>, <span class="number">0.2</span>, <span class="number">0.4</span>, <span class="number">0.6</span>, <span class="number">0.8</span>, <span class="number">1.0</span>]&#x27;;</span><br><span class="line">cmap = [c, c, c];</span><br><span class="line">surf(peaks)</span><br><span class="line">colormap(cmap)</span><br><span class="line">或</span><br><span class="line">cmap=gray(<span class="number">6</span>);</span><br><span class="line">surf(peaks)</span><br><span class="line">colormap(cmap)</span><br></pre></td></tr></table></figure>
<p> 例3 使用同一色图，以不同着色方式绘制圆锥体。Shading faceted;shading flat;shading interp</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[x,y,z]= cylinder(<span class="built_in">pi</span>:-<span class="built_in">pi</span>/<span class="number">5</span>:<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">colormap(lines);</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line">surf(x,y,z); shading flat</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line">surf(x,y,z); shading interp</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>);</span><br><span class="line">surf(x,y,z);</span><br></pre></td></tr></table></figure>
<p> 例4 绘制3/4圆。将图形中需要裁减部分对应的函数值设置成NaN。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">100</span>);</span><br><span class="line">x = <span class="built_in">sin</span>(t);</span><br><span class="line">y = <span class="built_in">cos</span>(t);</span><br><span class="line">p = y &gt; <span class="number">0.5</span>;</span><br><span class="line">y(p)= NaN;</span><br><span class="line"><span class="built_in">plot</span>(x,y)</span><br><span class="line">axis([<span class="number">-1.1</span>,<span class="number">1.1</span>,<span class="number">-1.1</span>,<span class="number">1.1</span>])</span><br><span class="line">axis square</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p> 例5 绘制3/4球面。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[X, Y, Z] = sphere(<span class="number">60</span>);</span><br><span class="line">p = Z&gt;<span class="number">0.5</span>;</span><br><span class="line">Z(p) = NaN;</span><br><span class="line">surf(X, Y, Z)</span><br><span class="line">axis([<span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>])</span><br><span class="line">axis equal</span><br><span class="line">view(<span class="number">-45</span>, <span class="number">20</span>)</span><br></pre></td></tr></table></figure>
<p>4.7 交互式绘图工具</p>
<blockquote>
<p>“绘图”选项卡</p>
<p>图形窗口绘图工具：plottools;按钮；；图形选项板（新子图面板、变量面板、注释面板）、绘图浏览器、属性编辑器</p>
<p>图形窗口菜单和工具栏（工具栏、图形窗口菜单）</p>
</blockquote>
<p>生成例1所需变量。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">100</span>);</span><br><span class="line">y=<span class="built_in">sin</span>(x);</span><br><span class="line">y1=<span class="built_in">sin</span>(x);</span><br><span class="line">y2=<span class="built_in">sin</span>(<span class="number">0.5</span>*x);</span><br><span class="line">y3=<span class="built_in">sin</span>(<span class="number">2</span>*x);</span><br><span class="line">[u,v]=<span class="built_in">meshgrid</span>(<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">2</span>,<span class="number">1</span>:<span class="number">0.1</span>:<span class="number">3</span>);</span><br><span class="line">h=(u<span class="number">-1</span>).^<span class="number">2</span>+(v<span class="number">-2</span>).^<span class="number">2</span><span class="number">-1</span>;</span><br><span class="line">[X,Y,Z]= cylinder(<span class="number">0</span>:<span class="number">0.2</span>:<span class="number">2</span>,<span class="number">30</span>);</span><br></pre></td></tr></table></figure>
<h2 id="专题四总结"><a href="#专题四总结" class="headerlink" title="专题四总结"></a>专题四总结</h2><h1 id="5、数据分析与多项式计算"><a href="#5、数据分析与多项式计算" class="headerlink" title="5、数据分析与多项式计算"></a>5、数据分析与多项式计算</h1><h2 id="5-1-数据统计分析-matlab以列优先"><a href="#5-1-数据统计分析-matlab以列优先" class="headerlink" title="5.1 数据统计分析(matlab以列优先)"></a>5.1 数据统计分析(matlab以列优先)</h2><p>Max/min/ 最大值、最小值</p>
<p>Mean/median 均值、中值</p>
<p>Sum/prod 求和、求积</p>
<p>Cumsum/cumprod 累加和、累乘积</p>
<p>Std/corrcoef 标准差、相关系数</p>
<p>样本标准差、总体标准差</p>
<p>Sort 排序</p>
<p>例1 求向量x的最大元素，其中x=[-43,72,9,16,23,47]。</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; <span class="keyword">x</span><span class="operator">=</span>[<span class="number">-43</span><span class="punctuation">,</span><span class="number">72</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">,</span><span class="number">16</span><span class="punctuation">,</span><span class="number">23</span><span class="punctuation">,</span><span class="number">47</span>]<span class="comment">;</span></span><br><span class="line">\&gt;&gt; y<span class="operator">=</span><span class="keyword">max</span>(<span class="keyword">x</span>) </span><br><span class="line"></span><br><span class="line">\&gt;&gt; [y<span class="punctuation">,</span>k]<span class="operator">=</span><span class="keyword">max</span>(<span class="keyword">x</span>)</span><br></pre></td></tr></table></figure>
<p>例2 求矩阵A（见课件）的每行及每列的最大元素，并求整个矩阵的最大元素。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">\<span class="operator">&gt;&gt;</span> A<span class="operator">=</span>[<span class="number">13</span>,<span class="number">-56</span>,<span class="number">78</span>;<span class="number">25</span>,<span class="number">63</span>,<span class="number">-235</span>;<span class="number">78</span>,<span class="number">25</span>,<span class="number">563</span>;<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>];</span><br><span class="line">\<span class="operator">&gt;&gt;</span> <span class="built_in">max</span>(A)</span><br><span class="line"></span><br><span class="line">\<span class="operator">&gt;&gt;</span> <span class="built_in">max</span>(A,[],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">\<span class="operator">&gt;&gt;</span> <span class="built_in">max</span>(<span class="built_in">max</span>(A))  </span><br></pre></td></tr></table></figure>
<p>例3 某学生宿舍的5位同学月生活费如向量x所示，其中，小明同学家境一般，请问他应该按什么标准向父母主张生活费额度才较为合理。x=[1200,800,1500,1000,5000]</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; x=[<span class="number">1200</span>,<span class="number">800</span>,<span class="number">1500</span>,<span class="number">1000</span>,<span class="number">5000</span>];</span><br><span class="line">\&gt;&gt; <span class="built_in">mean</span>(x)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; median(x)</span><br></pre></td></tr></table></figure>
<p>例4 求向量X=[1,2,3,4,5,6,7,8,9,10]的积与累乘积。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; X=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line">\&gt;&gt; y1=prod(X)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; y2=cumprod(X)</span><br></pre></td></tr></table></figure>
<p>例5 生成满足正态分布的50000*4随机矩阵，用不同的形式求其各列之间的标准差。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; x=<span class="built_in">randn</span>(<span class="number">50000</span>,<span class="number">4</span>);</span><br><span class="line">\&gt;&gt; y1=std(x,<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; y2=std(x,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; x1=x&#x27;;</span><br><span class="line">\&gt;&gt; y3=std(x1,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">\&gt;&gt; y3&#x27;</span><br><span class="line"></span><br><span class="line">\&gt;&gt; y4=std(x1,<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">\&gt;&gt; y4&#x27; </span><br></pre></td></tr></table></figure>
<p>例6 某新产品上市，在上市之前，公司物流部门把新产品分配到不同地区的10个仓库进行销售。产品上市一个月后，公司要对各种不同的分配方案进行评估，以便在下一次新产品上市时进行更准确的分配，避免由于分配不当而产生的积压和断货。下表（见课件）是相关数据，请判断那种分配方案最为合理。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; A=[<span class="number">5032</span>,<span class="number">6000</span>,<span class="number">5100</span>,<span class="number">5200</span>;<span class="number">6532</span>,<span class="number">6500</span>,<span class="number">6600</span>,<span class="number">5800</span>;</span><br><span class="line">   <span class="number">5500</span>,<span class="number">7000</span>,<span class="number">5400</span>,<span class="number">4800</span>;<span class="number">4530</span>,<span class="number">4000</span>,<span class="number">4300</span>,<span class="number">4200</span>;</span><br><span class="line">   <span class="number">2300</span>,<span class="number">2000</span>,<span class="number">2200</span>,<span class="number">2500</span>;<span class="number">3254</span>,<span class="number">3000</span>,<span class="number">3500</span>,<span class="number">3000</span>;</span><br><span class="line">   <span class="number">8095</span>,<span class="number">9000</span>,<span class="number">7800</span>,<span class="number">8500</span>;<span class="number">7530</span>,<span class="number">8000</span>,<span class="number">7000</span>,<span class="number">7500</span>;</span><br><span class="line">   <span class="number">3841</span>,<span class="number">3200</span>,<span class="number">3500</span>,<span class="number">3200</span>;<span class="number">4500</span>,<span class="number">5200</span>,<span class="number">4800</span>,<span class="number">4000</span>];</span><br><span class="line">\&gt;&gt; corrcoef(A)</span><br></pre></td></tr></table></figure>
<p>例7 对下列矩阵（见课件）做各种排序。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; A=[<span class="number">1</span>,<span class="number">-8</span>,<span class="number">5</span>;<span class="number">4</span>,<span class="number">12</span>,<span class="number">6</span>;<span class="number">13</span>,<span class="number">7</span>,<span class="number">-13</span>];</span><br><span class="line">\&gt;&gt; <span class="built_in">sort</span>(A)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; <span class="built_in">sort</span>(A,<span class="number">2</span>,<span class="string">&#x27;descend&#x27;</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; [X,I]=<span class="built_in">sort</span>(A)</span><br></pre></td></tr></table></figure>
<h2 id="5-2-多项式计算"><a href="#5-2-多项式计算" class="headerlink" title="5.2 多项式计算"></a>5.2 多项式计算</h2><blockquote>
<p>多项式的表示：n+1长度的行向量</p>
<p>多项式的四则预算：加减（相应向量加减）</p>
<p>P=Conv(p1,p2);相乘</p>
<p>[Q,r]=Deconv(p1,p2);除法;p1 = conv(Q,p2)+r</p>
<p>多项式的求导：polyder;</p>
<p>多项式的求值：polyval(p,x);ployvalm(p,x)</p>
<p>矩阵运算、点运算</p>
<p>多项式的求根：roots(p);给出全部根；poly函数由全部根建立多项式</p>
</blockquote>
<p>例1 设f和g为两个多项式（见课件），求f(x)+g(x),f(x)-g(x),f(x)×g(x),f(x)/g(x)。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; f=[<span class="number">3</span>,<span class="number">-5</span>,<span class="number">0</span>,<span class="number">-7</span>,<span class="number">5</span>,<span class="number">6</span>]; g=[<span class="number">3</span>,<span class="number">5</span>,<span class="number">-3</span>]; g1=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,g];</span><br><span class="line">\&gt;&gt; f+g1</span><br><span class="line"></span><br><span class="line">\&gt;&gt; f-g1</span><br><span class="line"></span><br><span class="line">\&gt;&gt; conv(f,g)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; [Q,r]=deconv(f,g)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; conv(g,Q)+r</span><br></pre></td></tr></table></figure>
<p> 例2 已知两个多项式a和b（见课件），计算两个多项式的乘积的导函数、商的导函数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> \&gt;&gt; a=[<span class="number">3</span> <span class="number">1</span> <span class="number">0</span> <span class="number">-6</span>];</span><br><span class="line"> \&gt;&gt; b=[<span class="number">1</span> <span class="number">2</span>];</span><br><span class="line"> \&gt;&gt; polyder(a)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; c=polyder(a,b)</span><br><span class="line"> </span><br><span class="line"> \&gt;&gt; [p,q]=polyder(a,b)</span><br></pre></td></tr></table></figure>
<p> >&gt; [p,q]=polyder(a,b)</p>
<p>例3 以一个多项式为例，取一个2×2矩阵为自变量，分别用polyval和polyvalm计算该多项式的值。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; a=[<span class="number">1</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-10</span>];</span><br><span class="line">\&gt;&gt; x=[<span class="number">-1</span>,<span class="number">1.2</span>;<span class="number">2</span>,<span class="number">-1.8</span>];</span><br><span class="line">\&gt;&gt; y1=polyval(a,x)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; y2=polyvalm(a,x)</span><br></pre></td></tr></table></figure>
<p>例4 请推算空气流量在[0, 2]范围内什么水平时，加热效率为最高。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; p=[<span class="number">-38.89</span>,<span class="number">126.11</span>,<span class="number">-3.42</span>];</span><br><span class="line">\&gt;&gt; q=polyder(p)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; roots(q)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; polyval(p,<span class="number">1.6214</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; x=<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">2</span>;</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x,polyval(p,x),<span class="number">1.6214</span>,<span class="number">98.8154</span>,<span class="string">&#x27;rp&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="5-3-数据插值-函数逼近的方法"><a href="#5-3-数据插值-函数逼近的方法" class="headerlink" title="5.3 数据插值(函数逼近的方法)"></a>5.3 数据插值(函数逼近的方法)</h2><blockquote>
<p>数值计算方法</p>
<p>Interp1(x,y,x1,method)</p>
<p>Method:linear（线性插值）;nearest（最近点插值）;pchip（分段3次埃尔米特插值）;spline（3次样条插值）; </p>
<p>Interp2(x,y,z,x1,y1,method)</p>
</blockquote>
<p>引例 零件加工问题 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; x= [<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>];</span><br><span class="line">\&gt;&gt; y=[<span class="number">0</span>,<span class="number">1.2</span>,<span class="number">1.7</span>,<span class="number">2.0</span>,<span class="number">2.1</span>,<span class="number">2.0</span>,<span class="number">1.8</span>,<span class="number">1.2</span>,<span class="number">1.0</span>,<span class="number">1.6</span>];</span><br><span class="line">\&gt;&gt; x1=<span class="number">0</span>:<span class="number">0.1</span>:<span class="number">15</span>;</span><br><span class="line">\&gt;&gt; y1=interp1(x,y,x1,<span class="string">&#x27;spline&#x27;</span>);</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x1,y1)</span><br></pre></td></tr></table></figure>
<p>粮储仓的通风控制问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; x=<span class="number">20</span>:<span class="number">10</span>:<span class="number">90</span>;</span><br><span class="line"></span><br><span class="line">\&gt;&gt; y=(<span class="number">0</span>:<span class="number">5</span>:<span class="number">20</span>)&#x27;;</span><br><span class="line"> \&gt;&gt; z=[<span class="number">8.9</span>,<span class="number">10.32</span>,<span class="number">11.3</span>,<span class="number">12.5</span>,<span class="number">13.9</span>,<span class="number">15.3</span>,<span class="number">17.8</span>,<span class="number">21.3</span>;<span class="number">8.7</span>,<span class="number">10.8</span>,<span class="number">11</span>,<span class="number">12.1</span>,<span class="number">13.2</span>,<span class="number">14.8</span>,<span class="number">16.55</span>,<span class="number">20.8</span>;<span class="number">8.3</span>,<span class="number">9.65</span>,<span class="number">10.88</span>,<span class="number">12</span>,<span class="number">13.2</span>,<span class="number">14.6</span>,<span class="number">16.4</span>,<span class="number">20.5</span>;<span class="number">8.1</span>,<span class="number">9.4</span>,<span class="number">10.7</span>,<span class="number">11.9</span>,<span class="number">13.1</span>,<span class="number">14.5</span>,<span class="number">16.2</span>,<span class="number">20.3</span>;<span class="number">8.1</span>,<span class="number">9.2</span>,<span class="number">10.8</span>,<span class="number">12</span>,<span class="number">13.2</span>,<span class="number">14.8</span>,<span class="number">16.9</span>,<span class="number">20.9</span>];</span><br><span class="line"> \&gt;&gt; xi=<span class="number">20</span>:<span class="number">90</span>;</span><br><span class="line"> \&gt;&gt; yi=(<span class="number">0</span>:<span class="number">20</span>)&#x27;;</span><br><span class="line"> \&gt;&gt; zi=interp2(x,y,z,xi,yi,<span class="string">&#x27;spline&#x27;</span>);</span><br><span class="line"> \&gt;&gt; surf(xi,yi,zi)</span><br></pre></td></tr></table></figure>
<p>5.4 数据插值应用举例</p>
<p>机动车刹车距离问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> v=<span class="number">20</span>:<span class="number">10</span>:<span class="number">150</span>;</span><br><span class="line"> vs=v.*(<span class="number">1000</span>/<span class="number">3600</span>);</span><br><span class="line"> d1=<span class="number">10.</span>*vs;</span><br><span class="line"> d2=[<span class="number">3.15</span>,<span class="number">7.08</span>,<span class="number">12.59</span>,<span class="number">19.68</span>,<span class="number">28.34</span>,<span class="number">38.57</span>,<span class="number">50.4</span>,<span class="number">63.75</span>,<span class="number">78.71</span>,<span class="number">95.22</span>,<span class="number">113.29</span>,<span class="number">132.93</span>,<span class="number">154.12</span>,<span class="number">176.87</span>];</span><br><span class="line"> d3=<span class="number">10</span>;</span><br><span class="line"> d=d1+d2+d3;</span><br><span class="line"> vi=<span class="number">20</span>:<span class="number">1</span>:<span class="number">150</span>;</span><br><span class="line"> di=interp1(v,d,vi,<span class="string">&#x27;spline&#x27;</span>);</span><br><span class="line"> x=<span class="built_in">abs</span>(di<span class="number">-120</span>);</span><br><span class="line"> [y,<span class="built_in">i</span>]=<span class="built_in">sort</span>(x);</span><br><span class="line"> vi(<span class="built_in">i</span>(<span class="number">1</span>))</span><br><span class="line"> <span class="built_in">plot</span>(vi,di,vi(<span class="built_in">i</span>(<span class="number">1</span>)),di(<span class="built_in">i</span>(<span class="number">1</span>)),<span class="string">&#x27;rp&#x27;</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; <span class="built_in">j</span>=<span class="built_in">find</span>(vi==<span class="number">125</span>);</span><br><span class="line"> \&gt;&gt; di(<span class="built_in">j</span>)</span><br><span class="line"> \&gt;&gt; <span class="built_in">plot</span>(vi,di,<span class="number">125</span>,<span class="number">480.14</span>,<span class="string">&#x27;rp&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>沙盘制作问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">0</span>:<span class="number">200</span>:<span class="number">1800</span>;</span><br><span class="line">y=x&#x27;;</span><br><span class="line">z=[<span class="number">2000</span>,<span class="number">2000</span>,<span class="number">2001</span>,<span class="number">1992</span>,<span class="number">1954</span>,<span class="number">1938</span>,<span class="number">1972</span>,<span class="number">1995</span>,<span class="number">1999</span>,<span class="number">1999</span>;<span class="number">2000</span>,<span class="number">2002</span>,<span class="number">2006</span>,<span class="number">1908</span>,<span class="number">1533</span>,<span class="number">1381</span>,<span class="number">1728</span>,<span class="number">1959</span>,<span class="number">1998</span>,<span class="number">2000</span>;</span><br><span class="line"> <span class="number">2000</span>,<span class="number">2005</span>,<span class="number">2043</span>,<span class="number">1921</span>,<span class="number">977</span>,<span class="number">897</span>,<span class="number">1310</span>,<span class="number">1930</span>,<span class="number">2003</span>,<span class="number">2000</span>;<span class="number">1997</span>,<span class="number">1978</span>,<span class="number">2009</span>,<span class="number">2463</span>,<span class="number">2374</span>,<span class="number">1445</span>,<span class="number">1931</span>,<span class="number">2209</span>,<span class="number">2050</span>,<span class="number">2003</span>;</span><br><span class="line"> <span class="number">1992</span>,<span class="number">1892</span>,<span class="number">1566</span>,<span class="number">1971</span>,<span class="number">2768</span>,<span class="number">2111</span>,<span class="number">2653</span>,<span class="number">2610</span>,<span class="number">2121</span>,<span class="number">2007</span>;<span class="number">1991</span>,<span class="number">1875</span>,<span class="number">1511</span>,<span class="number">1556</span>,<span class="number">2221</span>,<span class="number">1986</span>,<span class="number">2660</span>,<span class="number">2601</span>,<span class="number">2119</span>,<span class="number">2007</span>;</span><br><span class="line"> <span class="number">1996</span>,<span class="number">1950</span>,<span class="number">1797</span>,<span class="number">2057</span>,<span class="number">2849</span>,<span class="number">2798</span>,<span class="number">2608</span>,<span class="number">2303</span>,<span class="number">2052</span>,<span class="number">2003</span>;<span class="number">1999</span>,<span class="number">1999</span>,<span class="number">2079</span>,<span class="number">2685</span>,<span class="number">3390</span>,<span class="number">3384</span>,<span class="number">2781</span>,<span class="number">2165</span>,<span class="number">2016</span>,<span class="number">2000</span>;</span><br><span class="line"> <span class="number">2000</span>,<span class="number">2002</span>,<span class="number">2043</span>,<span class="number">2271</span>,<span class="number">2668</span>,<span class="number">2668</span>,<span class="number">2277</span>,<span class="number">2049</span>,<span class="number">2003</span>,<span class="number">2000</span>;<span class="number">2000</span>,<span class="number">2000</span>,<span class="number">2004</span>,<span class="number">2027</span>,<span class="number">2067</span>,<span class="number">2067</span>,<span class="number">2027</span>,<span class="number">2004</span>,<span class="number">2000</span>,<span class="number">2000</span>];</span><br><span class="line">surf(x,y,z);</span><br><span class="line">x1=<span class="number">0</span>:<span class="number">100</span>:<span class="number">1800</span>;</span><br><span class="line">y1=x1&#x27;;</span><br><span class="line">z1=interp2(x,y,z,x1,y1,<span class="string">&#x27;spline&#x27;</span>);</span><br><span class="line">surf(x1,y1,z1);</span><br><span class="line">x2=<span class="number">0</span>:<span class="number">50</span>:<span class="number">1800</span>;</span><br><span class="line">y2=x2&#x27;;</span><br><span class="line">z2=interp2(x1,y1,z1,x2,y2,<span class="string">&#x27;spline&#x27;</span>);</span><br><span class="line">surf(x2,y2,z2);</span><br><span class="line">contour(x2,y2,z2,<span class="number">12</span>)</span><br></pre></td></tr></table></figure>
<h2 id="5-5-曲线拟合（一种函数逼近的方法）"><a href="#5-5-曲线拟合（一种函数逼近的方法）" class="headerlink" title="5.5 曲线拟合（一种函数逼近的方法）"></a>5.5 曲线拟合（一种函数逼近的方法）</h2><blockquote>
<p>Polyfit：求得最小二乘拟合多项式系数</p>
<p>原理：函数逼近；多项式函数；误差最小（最小二乘法/最小平方法）；</p>
<p>曲线拟合的实现方法：问题分析；</p>
<p>（若前面系数为0，则表明拟合次数太高，需要纠正）</p>
</blockquote>
<p>引例—人口增长预测问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> x=<span class="number">1790</span>:<span class="number">10</span>:<span class="number">2010</span>;</span><br><span class="line"> y=[<span class="number">3.9</span>,<span class="number">5.3</span>,<span class="number">7.2</span>,<span class="number">9.6</span>,<span class="number">12.9</span>,<span class="number">17.1</span>,<span class="number">23.2</span>,<span class="number">31.4</span>,<span class="number">38.6</span>, <span class="number">50.2</span>,<span class="number">63.0</span>,<span class="number">76.0</span>,<span class="number">92.0</span>,<span class="number">105.7</span>,<span class="number">122.8</span>,<span class="number">131.7</span>,<span class="number">150.7</span>,<span class="number">179.3</span>,<span class="number">203.2</span>,<span class="number">226.5</span>,<span class="number">248.7</span>,<span class="number">281.4</span>,<span class="number">308.7</span>];</span><br><span class="line"> <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line"> p=polyfit(x,y,<span class="number">3</span>);</span><br><span class="line"> polyval(p,<span class="number">2020</span>)</span><br><span class="line"> <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>,x,polyval(p,x));</span><br><span class="line"></span><br><span class="line">\&gt;&gt; polyval(p,<span class="number">2016</span>)</span><br><span class="line"> </span><br><span class="line"> \&gt;&gt; x=<span class="number">1950</span>:<span class="number">10</span>:<span class="number">2010</span>;</span><br><span class="line"> \&gt;&gt; y=[<span class="number">150.7</span>,<span class="number">179.3</span>,<span class="number">203.2</span>,<span class="number">226.5</span>,<span class="number">248.7</span>,<span class="number">281.4</span>,<span class="number">308.7</span>];</span><br><span class="line"> \&gt;&gt; p=polyfit(x,y,<span class="number">3</span>)</span><br><span class="line"> </span><br><span class="line"> \&gt;&gt; p=polyfit(x,y,<span class="number">2</span>);</span><br><span class="line"> \&gt;&gt; <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>,x,polyval(p,x))</span><br><span class="line"> \&gt;&gt; polyval(p,<span class="number">2016</span>)</span><br><span class="line"> </span><br><span class="line"> \&gt;&gt; polyval(p,<span class="number">2020</span>)</span><br></pre></td></tr></table></figure>
<p> >&gt; x=1950:10:2010;<br> >&gt; y=[150.7,179.3,203.2,226.5,248.7,281.4,308.7];<br> >&gt; p=polyfit(x,y,3)</p>
<p> >&gt; p=polyfit(x,y,2);<br> >&gt; plot(x,y,’*’,x,polyval(p,x))<br> >&gt; polyval(p,2016)</p>
<p> >&gt; polyval(p,2020)</p>
<p>家庭储蓄规律问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; x=[<span class="number">0.6</span>,<span class="number">1.0</span>,<span class="number">1.4</span>,<span class="number">1.8</span>,<span class="number">2.2</span>,<span class="number">2.6</span>,<span class="number">3.0</span>,<span class="number">3.4</span>,<span class="number">3.8</span>,<span class="number">4</span> ];</span><br><span class="line">\&gt;&gt; y=[<span class="number">0.08</span>,<span class="number">0.22</span>,<span class="number">0.31</span>,<span class="number">0.4</span>,<span class="number">0.48</span>,<span class="number">0.56</span>,<span class="number">0.67</span>,<span class="number">0.75</span>,<span class="number">0.8</span>,<span class="number">1.0</span> ];</span><br><span class="line">\&gt;&gt; p=polyfit(x,y,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>,x,polyval(p,x))</span><br></pre></td></tr></table></figure>
<h2 id="5-6-曲线拟合应用举例"><a href="#5-6-曲线拟合应用举例" class="headerlink" title="5.6 曲线拟合应用举例"></a>5.6 曲线拟合应用举例</h2><p>股票预测问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; x=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">29</span>,<span class="number">30</span>];</span><br><span class="line">\&gt;&gt; y=[<span class="number">7.74</span>,<span class="number">7.84</span>,<span class="number">7.82</span>,<span class="number">7.78</span>,<span class="number">7.91</span>,<span class="number">7.97</span>,<span class="number">7.9</span>,<span class="number">7.76</span>,<span class="number">7.9</span>,<span class="number">8.04</span>,<span class="number">8.06</span>,<span class="number">8.11</span>,<span class="number">8.08</span>,<span class="number">8.13</span>,<span class="number">8.03</span>,<span class="number">8.01</span>,<span class="number">8.06</span>,<span class="number">8.0</span>,<span class="number">8.3</span>,<span class="number">8.41</span>,<span class="number">8.28</span>];</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x,y, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">\&gt;&gt; p=polyfit(x,y,<span class="number">3</span>);</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>,x,polyval(p,x));</span><br><span class="line">\&gt;&gt; x1=[<span class="number">31</span>,<span class="number">32</span>,<span class="number">33</span>];</span><br><span class="line">\&gt;&gt; xi=[x,x1];</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>,xi,polyval(p,xi));</span><br><span class="line">\&gt;&gt; y1=[<span class="number">8.27</span>,<span class="number">8.17</span>,<span class="number">9.54</span>];</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x,y,<span class="string">&#x27;*&#x27;</span>,xi,polyval(p,xi),x1,y1,<span class="string">&#x27;rp&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>算法的参数优化问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=<span class="number">0.03</span>:<span class="number">0.03</span>:<span class="number">0.3</span>;</span><br><span class="line">y1=[<span class="number">0.01</span>,<span class="number">0.01</span>,<span class="number">0.02</span>,<span class="number">0.03</span>,<span class="number">0.06</span>,<span class="number">0.07</span>,<span class="number">0.13</span>,<span class="number">0.17</span>,<span class="number">0.25</span>,<span class="number">0.37</span>];</span><br><span class="line">y2=[<span class="number">0.85</span>,<span class="number">0.76</span>,<span class="number">0.68</span>,<span class="number">0.62</span>,<span class="number">0.56</span>,<span class="number">0.52</span>,<span class="number">0.49</span>,<span class="number">0.46</span>,<span class="number">0.43</span>,<span class="number">0.39</span>];</span><br><span class="line"><span class="built_in">plot</span>(x,y1,<span class="string">&#x27;*&#x27;</span>,x,y2,<span class="string">&#x27;o&#x27;</span>);</span><br><span class="line">p1=polyfit(x,y1,<span class="number">2</span>);</span><br><span class="line">p2=polyfit(x,y2,<span class="number">2</span>);</span><br><span class="line">p=p1-p2;</span><br><span class="line">xi=roots(p);</span><br><span class="line">xj=<span class="number">0</span>:<span class="number">0.03</span>:<span class="number">0.36</span>;</span><br><span class="line">yj1=polyval(p1,xj);</span><br><span class="line">yj2=polyval(p2,xj);</span><br><span class="line">yi=polyval(p1,xi(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">plot</span>(x,y1,<span class="string">&#x27;*&#x27;</span>,x,y2,<span class="string">&#x27;o&#x27;</span>,xj,yj1,xj,yj2,xi(<span class="number">2</span>),yi,<span class="string">&#x27;rp&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="专题五总结"><a href="#专题五总结" class="headerlink" title="专题五总结"></a>专题五总结</h2><h1 id="6数值微积分与方程求解"><a href="#6数值微积分与方程求解" class="headerlink" title="6数值微积分与方程求解"></a>6数值微积分与方程求解</h1><h2 id="6-1数值微分与数值积分"><a href="#6-1数值微分与数值积分" class="headerlink" title="6.1数值微分与数值积分"></a>6.1数值微分与数值积分</h2><blockquote>
<p>数值微分：</p>
<p>数值差分：向前差分；向后差分；中心差分；；diff</p>
<p>差商：向前差商；向后差商；中心差商；；</p>
<p>数值积分：牛顿-莱布尼兹公式；梯形法；辛普森法；高斯求积公式；</p>
</blockquote>
<p>例1 设f(x)=sinx，在[0，2π]范围内随机采样，计算f’(x)的近似值，并与理论值f’(x)=cosx 进行比较。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; x=[<span class="number">0</span>,<span class="built_in">sort</span>(<span class="number">2</span>*<span class="built_in">pi</span>*<span class="built_in">rand</span>(<span class="number">1</span>,<span class="number">5000</span>)),<span class="number">2</span>*<span class="built_in">pi</span>];</span><br><span class="line">\&gt;&gt; y=<span class="built_in">sin</span>(x);</span><br><span class="line">\&gt;&gt; f1=diff(y)./diff(x);</span><br><span class="line">\&gt;&gt; f2=<span class="built_in">cos</span>(x(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>));</span><br><span class="line">\&gt;&gt; <span class="built_in">plot</span>(x(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>),f1,x(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>),f2);</span><br><span class="line">\&gt;&gt; d=norm(f1-f2)</span><br></pre></td></tr></table></figure>
<p>例2 分别用quad函数和quadl函数求定积分的近似值，并在相同的积分精度下，比较被积函数的调用次数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; format long</span><br><span class="line">\&gt;&gt; f=@(x) <span class="number">4.</span>/(<span class="number">1</span>+x.^<span class="number">2</span>);</span><br><span class="line">\&gt;&gt; [I,n]=quad(f,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1e-8</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; [I,n]=quadl(f,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1e-8</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; (<span class="built_in">atan</span>(<span class="number">1</span>)-<span class="built_in">atan</span>(<span class="number">0</span>))*<span class="number">4</span></span><br><span class="line"></span><br><span class="line">\&gt;&gt; format short</span><br></pre></td></tr></table></figure>
<p>例3 求定积分。<br> 被积函数文件fe.m：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">fe</span><span class="params">(x)</span></span></span><br><span class="line"> f=<span class="number">1.</span>/(x.*<span class="built_in">sqrt</span>(<span class="number">1</span>-<span class="built_in">log</span>(x).^<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">\&gt;&gt; I=integral(@fe,<span class="number">1</span>,<span class="built_in">exp</span>(<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>例4 求定积分。<br> 被积函数文件fsx.m：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">f</span>=<span class="title">fsx</span><span class="params">(x)</span></span></span><br><span class="line"> f=<span class="built_in">sin</span>(<span class="number">1.</span>/x)./x.^<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">\&gt;&gt; I=quadgk(@fsx,<span class="number">2</span>/<span class="built_in">pi</span>,+Inf)</span><br></pre></td></tr></table></figure>
<p>例5 设x=1:6，y=[6,8,11,7,5,2],用trapz函数计算定积分。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> \&gt;&gt; x=<span class="number">1</span>:<span class="number">6</span>;</span><br><span class="line"> \&gt;&gt; y=[<span class="number">6</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">2</span>];</span><br><span class="line"> \&gt;&gt; <span class="built_in">plot</span>(x,y,<span class="string">&#x27;-ko&#x27;</span>);</span><br><span class="line"> \&gt;&gt; grid on</span><br><span class="line"> \&gt;&gt; axis([<span class="number">1</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">11</span>]);</span><br><span class="line"> \&gt;&gt; I1=trapz(x,y)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; I2=sum(diff(x).*(y(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>)+y(<span class="number">2</span>:<span class="keyword">end</span>))/<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>例6 分别求二重积分和三重积分。 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> \&gt;&gt; f1=@(x,y) <span class="built_in">exp</span>(-x.^<span class="number">2</span>/<span class="number">2</span>).*<span class="built_in">sin</span>(x.^<span class="number">2</span>+y);</span><br><span class="line"> \&gt;&gt; I1=quad2d(f1,<span class="number">-2</span>,<span class="number">2</span>,<span class="number">-1</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; f2=@(x,y,z) <span class="number">4</span>*x.*z.*<span class="built_in">exp</span>(-z.*z.*y-x.*x);</span><br><span class="line"> \&gt;&gt; I2=integral3(f2,<span class="number">0</span>,<span class="built_in">pi</span>,<span class="number">0</span>,<span class="built_in">pi</span>,<span class="number">0</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="6-2线性方程组求解"><a href="#6-2线性方程组求解" class="headerlink" title="6.2线性方程组求解"></a>6.2线性方程组求解</h2><p>直接法：高斯消去法；列主消元法（左除）；矩阵的三角分解法；lu分解</p>
<p>例1 用左除运算符求解下列线性方程组。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; A=[<span class="number">2</span>,<span class="number">1</span>,<span class="number">-5</span>,<span class="number">1</span>;<span class="number">1</span>,<span class="number">-5</span>,<span class="number">0</span>,<span class="number">7</span>;<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">-1</span>;<span class="number">1</span>,<span class="number">6</span>,<span class="number">-1</span>,<span class="number">-4</span>];</span><br><span class="line">\&gt;&gt; b=[<span class="number">13</span>,<span class="number">-9</span>,<span class="number">6</span>,<span class="number">0</span>]&#x27;;</span><br><span class="line">\&gt;&gt; x=A\b</span><br></pre></td></tr></table></figure>
<p>例2 用LU分解求解例1中的线性方程组。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; A=[<span class="number">2</span>,<span class="number">1</span>,<span class="number">-5</span>,<span class="number">1</span>;<span class="number">1</span>,<span class="number">-5</span>,<span class="number">0</span>,<span class="number">7</span>;<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">-1</span>;<span class="number">1</span>,<span class="number">6</span>,<span class="number">-1</span>,<span class="number">-4</span>];</span><br><span class="line">\&gt;&gt; b=[<span class="number">13</span>,<span class="number">-9</span>,<span class="number">6</span>,<span class="number">0</span>]&#x27;;</span><br><span class="line">\&gt;&gt; [L,U]=lu(A);</span><br><span class="line">\&gt;&gt; x=U\(L\b)</span><br></pre></td></tr></table></figure>
<p> 雅可比迭代法的函数文件jacobi.m：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[y,n]</span>=<span class="title">jacobi</span><span class="params">(A,b,x0,ep)</span></span></span><br><span class="line">D=<span class="built_in">diag</span>(<span class="built_in">diag</span>(A));</span><br><span class="line">L=-<span class="built_in">tril</span>(A,<span class="number">-1</span>);</span><br><span class="line">U=-<span class="built_in">triu</span>(A,<span class="number">1</span>);</span><br><span class="line">B=D\(L+U);</span><br><span class="line">f=D\b;</span><br><span class="line">y=B*x0+f;</span><br><span class="line">n=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> norm(y-x0)&gt;=ep</span><br><span class="line">  x0=y;</span><br><span class="line">  y=B*x0+f;</span><br><span class="line">  n=n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Gauss-Serdel迭代法的函数文件gauseidel.m：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[y,n]</span>=<span class="title">gauseidel</span><span class="params">(A,b,x0,ep)</span></span></span><br><span class="line">D=<span class="built_in">diag</span>(<span class="built_in">diag</span>(A));</span><br><span class="line">L=-<span class="built_in">tril</span>(A,<span class="number">-1</span>); </span><br><span class="line">U=-<span class="built_in">triu</span>(A,<span class="number">1</span>);</span><br><span class="line">B=(D-L)\U;</span><br><span class="line">f=(D-L)\b;</span><br><span class="line">y=B*x0+f;</span><br><span class="line">n=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> norm(y-x0)&gt;=ep</span><br><span class="line">  x0=y;</span><br><span class="line">  y=B*x0+f;</span><br><span class="line">  n=n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>例3 分别用雅可比迭代法和高斯-赛德尔迭代法求解线性方程组。设迭代初值为0，迭代精度为10^(-6)。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> \&gt;&gt; A=[<span class="number">4</span>,<span class="number">-2</span>,<span class="number">-1</span>;<span class="number">-2</span>,<span class="number">4</span>,<span class="number">3</span>;<span class="number">-1</span>,<span class="number">-3</span>,<span class="number">3</span>];</span><br><span class="line"> \&gt;&gt; b=[<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>]&#x27;;</span><br><span class="line"> \&gt;&gt; [x,n]=jacobi(A,b,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]&#x27;,<span class="number">1.0e-6</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; [x,n]=gauseidel(A,b,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]&#x27;,<span class="number">1.0e-6</span>)</span><br></pre></td></tr></table></figure>
<p> 例4 分别用雅可比迭代法和高斯-赛德尔迭代法求解下列线性方程组，看是否收敛。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> \&gt;&gt; A=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">-2</span>;<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>;<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>];</span><br><span class="line"> \&gt;&gt; b=[<span class="number">9</span>;<span class="number">7</span>;<span class="number">6</span>];</span><br><span class="line"> \&gt;&gt; [x,n]=jacobi(A,b,[<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>],<span class="number">1.0e-6</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; [x,n]=gauseidel(A,b,[<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>],<span class="number">1.0e-6</span>)</span><br></pre></td></tr></table></figure>
<h2 id="6-3-线性方程组应用举例"><a href="#6-3-线性方程组应用举例" class="headerlink" title="6.3 线性方程组应用举例"></a>6.3 线性方程组应用举例</h2><p>1．平面桁架结构受力分析问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">alpha=<span class="built_in">sqrt</span>(<span class="number">2</span>)/<span class="number">2</span>;</span><br><span class="line">A=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> alpha,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,-alpha,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> alpha,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,alpha,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,alpha,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,-alpha,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,alpha,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,alpha,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,alpha,<span class="number">0</span>,<span class="number">0</span>,-alpha,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,alpha,<span class="number">0</span>,<span class="number">1</span>,alpha,<span class="number">0</span>;</span><br><span class="line"> <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,alpha,<span class="number">1</span>];</span><br><span class="line">b=[<span class="number">0</span>;<span class="number">10</span>;<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>;<span class="number">15</span>;<span class="number">0</span>;<span class="number">20</span>;<span class="number">0</span>;<span class="number">0</span>;<span class="number">0</span>];</span><br><span class="line">f=A\b;</span><br><span class="line"><span class="built_in">disp</span>(f&#x27;)</span><br></pre></td></tr></table></figure>
<p>2．小行星运行轨道计算问题</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">xi=[<span class="number">1.02</span>,<span class="number">0.87</span>,<span class="number">0.67</span>,<span class="number">0.44</span>,<span class="number">0.16</span>];</span><br><span class="line">yi=[<span class="number">0.39</span>,<span class="number">0.27</span>,<span class="number">0.18</span>,<span class="number">0.13</span>,<span class="number">0.13</span>];</span><br><span class="line">A=<span class="built_in">zeros</span>(<span class="built_in">length</span>(xi));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(xi)</span><br><span class="line">  A(<span class="built_in">i</span>,:)=[xi(<span class="built_in">i</span>)*xi(<span class="built_in">i</span>),<span class="number">2</span>*xi(<span class="built_in">i</span>)*yi(<span class="built_in">i</span>),yi(<span class="built_in">i</span>)*yi(<span class="built_in">i</span>),<span class="number">2</span>*xi(<span class="built_in">i</span>),<span class="number">2</span>*yi(<span class="built_in">i</span>)];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">b=-<span class="built_in">ones</span>(<span class="built_in">length</span>(xi),<span class="number">1</span>);</span><br><span class="line">ai=A\b</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> xi=[<span class="number">1.02</span>,<span class="number">0.87</span>,<span class="number">0.67</span>,<span class="number">0.44</span>,<span class="number">0.16</span>]&#x27;;</span><br><span class="line"> yi=[<span class="number">0.39</span>,<span class="number">0.27</span>,<span class="number">0.18</span>,<span class="number">0.13</span>,<span class="number">0.13</span>]&#x27;;</span><br><span class="line"> A=[xi.*xi,<span class="number">2</span>*xi.*yi,yi.*yi,<span class="number">2</span>*xi,<span class="number">2</span>*yi];</span><br><span class="line"> b=-<span class="built_in">ones</span>(<span class="built_in">length</span>(xi),<span class="number">1</span>);</span><br><span class="line"> ai=A\b</span><br><span class="line">\&gt;&gt; f=@(x,y) <span class="number">2.4645</span>*x.^<span class="number">2</span><span class="number">-0.8846</span>*x.*y+<span class="number">6.4917</span>*y.^<span class="number">2</span><span class="number">-1.3638</span>*x<span class="number">-7.2016</span>*y+<span class="number">1</span>;</span><br><span class="line"> \&gt;&gt; h=ezplot(f,[<span class="number">-0.5</span>,<span class="number">1.2</span>,<span class="number">0</span>,<span class="number">1.2</span>]);</span><br></pre></td></tr></table></figure>
<h2 id="6-4-非线性方程求解与函数极值计算"><a href="#6-4-非线性方程求解与函数极值计算" class="headerlink" title="6.4 非线性方程求解与函数极值计算"></a>6.4 非线性方程求解与函数极值计算</h2><blockquote>
<p>代法；二分法；割线法</p>
<p>Fzero</p>
<p>Fsolve</p>
<p>求极小值</p>
<p>Fminbnd</p>
<p>Fminsearch</p>
<p>Fminunc</p>
<p>fmincon</p>
</blockquote>
<p>例1 求f(x)=0在x0=-5和x0=1作为迭代初值时的根。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> \&gt;&gt; f=@(x) x<span class="number">-1.</span>/x+<span class="number">5</span>;</span><br><span class="line"> \&gt;&gt; x1=fzero(f,<span class="number">-5</span>)</span><br><span class="line"></span><br><span class="line"> \&gt;&gt; x2=fzero(f,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"> \&gt;&gt; x3=fzero(f,<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; f=@(x) x<span class="number">-1.</span>/x+<span class="number">5</span>;</span><br><span class="line"> \&gt;&gt; x1=fsolve(f,<span class="number">-5</span>,optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;off&#x27;</span>))</span><br><span class="line"></span><br><span class="line"> \&gt;&gt; x2=fsolve(f,<span class="number">1</span>,optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;off&#x27;</span>))</span><br><span class="line"></span><br><span class="line"> \&gt;&gt; x3=fsolve(f,<span class="number">0.1</span>,optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;off&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>f(x)=x^2-1=0的根</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">f=@(x) x.^<span class="number">2</span><span class="number">-1</span>;</span><br><span class="line">x=[];</span><br><span class="line">x0=<span class="number">-0.25</span>:<span class="number">0.001</span>:<span class="number">0.25</span>;</span><br><span class="line"><span class="keyword">for</span> x00=x0</span><br><span class="line">  x=[x,fzero(f,x00)];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">plot</span>(x0,x,<span class="string">&#x27;-o&#x27;</span>)</span><br><span class="line">xlabel(<span class="string">&#x27;初值&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;方程的根&#x27;</span>);</span><br><span class="line">axis([<span class="number">-0.25</span>,<span class="number">0.25</span>,<span class="number">-1</span>,<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>例2 求下列方程组在（1，1，1）附近的解并对结果进行验证。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; f=@(x) [<span class="built_in">sin</span>(x(<span class="number">1</span>))+x(<span class="number">2</span>)+x(<span class="number">3</span>)^<span class="number">2</span>*<span class="built_in">exp</span>(x(<span class="number">1</span>)),x(<span class="number">1</span>)+x(<span class="number">2</span>)+x(<span class="number">3</span>),x(<span class="number">1</span>)*x(<span class="number">2</span>)*x(<span class="number">3</span>)];</span><br><span class="line">\&gt;&gt; f([<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">\&gt;&gt; x=fsolve(f,[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;off&#x27;</span>))</span><br><span class="line"></span><br><span class="line">\&gt;&gt; f(x)</span><br></pre></td></tr></table></figure>
<p>例3 求函数f(x)在区间(-10，-1)和(1，10)上的最小值点。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">\&gt;&gt; f=@(x) x<span class="number">-1.</span>/x+<span class="number">5</span>;</span><br><span class="line">\&gt;&gt; [xmin,fmin]=fminbnd(f,<span class="number">-10</span>,<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; [xmin,fmin]=fminbnd(f,<span class="number">1</span>,<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p>例4 求解有约束最优化问题。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">f=@(x) <span class="number">0.4</span>*x(<span class="number">2</span>)+x(<span class="number">1</span>)^<span class="number">2</span>+x(<span class="number">2</span>)^<span class="number">2</span>-x(<span class="number">1</span>)*x(<span class="number">2</span>)+<span class="number">1</span>/<span class="number">30</span>*x(<span class="number">1</span>)^<span class="number">3</span>;</span><br><span class="line">x0=[<span class="number">0.5</span>;<span class="number">0.5</span>];</span><br><span class="line">A=[<span class="number">-1</span>,<span class="number">-0.5</span>;<span class="number">-0.5</span>,<span class="number">-1</span>];</span><br><span class="line">b=[<span class="number">-0.4</span>;<span class="number">-0.5</span>];</span><br><span class="line">lb=[<span class="number">0</span>;<span class="number">0</span>];</span><br><span class="line">option=optimset(<span class="string">&#x27;Display&#x27;</span>,<span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">[xmin,fmin]=fmincon(f,x0,A,b,[],[],lb,[],[],option)</span><br></pre></td></tr></table></figure>
<p>例5 要使每周送货车的里程最小，仓库应建在xy平面的什么位置？</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">a=[<span class="number">10</span>,<span class="number">30</span>,<span class="number">16.667</span>,<span class="number">0.555</span>,<span class="number">22.2221</span>];</span><br><span class="line">b=[<span class="number">10</span>,<span class="number">50</span>,<span class="number">29</span>,<span class="number">29.888</span>,<span class="number">49.988</span>];</span><br><span class="line">c=[<span class="number">10</span>,<span class="number">18</span>,<span class="number">20</span>,<span class="number">14</span>,<span class="number">25</span>];</span><br><span class="line">f=@(x) sum(c.*<span class="built_in">sqrt</span>((x(<span class="number">1</span>)-a).^<span class="number">2</span>+(x(<span class="number">2</span>)-b).^<span class="number">2</span>));</span><br><span class="line">[xmin,fmin]=fminsearch(f,[<span class="number">15</span>,<span class="number">30</span>])</span><br></pre></td></tr></table></figure>
<p>例6 在例5中，如果由于地域的限制，仓库必须建在曲线y=x^2上，则它应该建在何处？</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> 非线性约束的函数文件funny.m：</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="params">[c,h]</span>=<span class="title">funny</span><span class="params">(x)</span></span></span><br><span class="line"> c=[];</span><br><span class="line"> h=x(<span class="number">2</span>)-x(<span class="number">1</span>)^<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">\&gt;&gt; a=[<span class="number">10</span>,<span class="number">30</span>,<span class="number">16.667</span>,<span class="number">0.555</span>,<span class="number">22.2221</span>];</span><br><span class="line"> \&gt;&gt; b=[<span class="number">10</span>,<span class="number">50</span>,<span class="number">29</span>,<span class="number">29.888</span>,<span class="number">49.988</span>];</span><br><span class="line"> \&gt;&gt; c=[<span class="number">10</span>,<span class="number">18</span>,<span class="number">20</span>,<span class="number">14</span>,<span class="number">25</span>];</span><br><span class="line"> \&gt;&gt; f=@(x) sum(c.*<span class="built_in">sqrt</span>((x(<span class="number">1</span>)-a).^<span class="number">2</span>+(x(<span class="number">2</span>)-b).^<span class="number">2</span>));</span><br><span class="line"> \&gt;&gt; [xmin,fmin]=fmincon(f,[<span class="number">15</span>,<span class="number">30</span>],[],[],[],[],[],[],<span class="string">&#x27;funny&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="6-5-常微分方程数值求解"><a href="#6-5-常微分方程数值求解" class="headerlink" title="6.5 常微分方程数值求解"></a>6.5 常微分方程数值求解</h2><p>单步法；</p>
<p>多步法</p>
<p>Solver</p>
<p>例1 求解微分方程初值问题，并与精确解进行比较。 </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">f=@(t,y) (y^<span class="number">2</span>-t<span class="number">-2</span>)/<span class="number">4</span>/(t+<span class="number">1</span>);</span><br><span class="line">[t,y]=ode23(f,[<span class="number">0</span>,<span class="number">10</span>],<span class="number">2</span>);</span><br><span class="line">y1=<span class="built_in">sqrt</span>(t+<span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">plot</span>(t,y,<span class="string">&#x27;b:&#x27;</span>,t,y1,<span class="string">&#x27;r&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>例2 已知一个二阶线性系统的微分方程，取a=2，绘制系统的时间响应曲线和相平面图。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">f=@(t,x) [<span class="number">-2</span>,<span class="number">0</span>;<span class="number">0</span>,<span class="number">1</span>]*[x(<span class="number">2</span>);x(<span class="number">1</span>)]; </span><br><span class="line">[t,x]=ode45(f,[<span class="number">0</span>,<span class="number">20</span>],[<span class="number">1</span>,<span class="number">0</span>]); </span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>);<span class="built_in">plot</span>(t,x(:,<span class="number">2</span>));</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>);<span class="built_in">plot</span>(x(:,<span class="number">2</span>),x(:,<span class="number">1</span>));</span><br></pre></td></tr></table></figure>
<p>例3 假如点燃一个火柴，已知火焰球简化模型，分析λ的大小对方程求解过程的影响。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"> lamda=<span class="number">0.01</span>;</span><br><span class="line"> f=@(t,y) y^<span class="number">2</span>-y^<span class="number">3</span>;</span><br><span class="line"> tic;[t,y]=ode45(f,[<span class="number">0</span>,<span class="number">2</span>/lamda],lamda);toc</span><br><span class="line"> <span class="built_in">disp</span>([‘ode45计算的点数<span class="string">&#x27; num2str(length(t))]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">lamda=1e-5;</span></span><br><span class="line"><span class="string"> f=@(t,y) y^2-y^3;</span></span><br><span class="line"><span class="string"> tic;[t,y]=ode45(f,[0,2/lamda],lamda);toc</span></span><br><span class="line"><span class="string"> disp([&#x27;</span>ode45计算的点数<span class="string">&#x27; num2str(length(t))]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">lamda=1e-5;</span></span><br><span class="line"><span class="string"> f=@(t,y) y^2-y^3;</span></span><br><span class="line"><span class="string"> tic;[t,y]=ode15s(f,[0,2/lamda],lamda);toc</span></span><br><span class="line"><span class="string"> disp([&#x27;</span>ode15s计算的点数<span class="string">&#x27; num2str(length(t))]);</span></span><br></pre></td></tr></table></figure>
<h2 id="6-6-常微分方程应用举例"><a href="#6-6-常微分方程应用举例" class="headerlink" title="6.6 常微分方程应用举例"></a>6.6 常微分方程应用举例</h2><p>1．Lotka-Volterra模型<br> 第①问：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">30</span>],[<span class="number">300</span>,<span class="number">150</span>])</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>);<span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;-&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;-*&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)&#x27;</span>,<span class="string">&#x27;x2(t)&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>);<span class="built_in">plot</span>(x(:,<span class="number">1</span>),x(:,<span class="number">2</span>))</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p>第④问：<br> 取λ=0.01， 所以稳定平衡点（1/λ，2/λ）即是（100，200），以此点作为初值时，画出其图像。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));...</span><br><span class="line">         x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">30</span>],[<span class="number">100</span>,<span class="number">200</span>]);</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;-o&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;-*&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)-兔子&#x27;</span>,<span class="string">&#x27;x2(t)-狐狸&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>当将初始值变为（98,195）时，即向下十分接近平衡点，画出其图像。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));...</span><br><span class="line">         x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">30</span>],[<span class="number">98</span>,<span class="number">195</span>]);</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;-o&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;-*&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)-兔子&#x27;</span>,<span class="string">&#x27;x2(t)-狐狸&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>当将初始值变为（70,150）时（向下偏离平衡点比较远时），画出其图像。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));...</span><br><span class="line">         x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">30</span>],[<span class="number">70</span>,<span class="number">150</span>]);</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),<span class="string">&#x27;-o&#x27;</span>,t,x(:,<span class="number">2</span>),<span class="string">&#x27;-*&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)-兔子&#x27;</span>,<span class="string">&#x27;x2(t)-狐狸&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>当将初始值变为（900,1600）时（向上偏离平衡点十分远时），画出其图像。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));...</span><br><span class="line">         x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">500</span>],[<span class="number">900</span>,<span class="number">1600</span>]);</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),t,x(:,<span class="number">2</span>));</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)-兔子&#x27;</span>,<span class="string">&#x27;x2(t)-狐狸&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br></pre></td></tr></table></figure>
<ol>
<li><p>Lotka-Volterra改进模型<br> 第①问：在原模型下，绘制狐狸和兔子数量的时间函数曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));...</span><br><span class="line">         x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),t,x(:,<span class="number">2</span>));</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)-兔子&#x27;</span>,<span class="string">&#x27;x2(t)-狐狸&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br><span class="line">title(<span class="string">&#x27;原模型下，狐狸和兔子数量的函数曲线&#x27;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>第②问：在改进模型下，狐狸和兔子数量的时间函数曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [<span class="number">2</span>*x(<span class="number">1</span>)*(<span class="number">1</span>-x(<span class="number">1</span>)/<span class="number">400</span><span class="number">-0.005</span>*x(<span class="number">2</span>));...</span><br><span class="line">        x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">50</span>],[<span class="number">300</span>,<span class="number">150</span>]);</span><br><span class="line"><span class="built_in">plot</span>(t,x(:,<span class="number">1</span>),t,x(:,<span class="number">2</span>));</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;x1(t)-兔子&#x27;</span>,<span class="string">&#x27;x2(t)-狐狸&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;时间&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;物种数量&#x27;</span>);</span><br><span class="line">title(<span class="string">&#x27;改进模型下，狐狸和兔子数量的函数曲线&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>第③问：在原模型下，绘制狐狸数量相对于兔子数量的关系曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [x(<span class="number">1</span>)*(<span class="number">2</span><span class="number">-0.01</span>*x(<span class="number">2</span>));...</span><br><span class="line">         x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">50</span>],[<span class="number">300</span>,<span class="number">150</span>]);</span><br><span class="line"><span class="built_in">plot</span>(x(:,<span class="number">1</span>),x(:,<span class="number">2</span>));</span><br><span class="line">xlabel(<span class="string">&#x27;兔子数量&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;狐狸数量&#x27;</span>);</span><br><span class="line">title(<span class="string">&#x27;原模型下，狐狸数量相对于兔子数量的关系曲线&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>第④问：在改进模型下，狐狸数量相对于兔子数量的关系曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rabbitFox=@(t,x) [<span class="number">2</span>*x(<span class="number">1</span>)*(<span class="number">1</span>-x(<span class="number">1</span>)/<span class="number">400</span><span class="number">-0.005</span>*x(<span class="number">2</span>));...</span><br><span class="line">        x(<span class="number">2</span>)*(<span class="number">-1</span>+<span class="number">0.01</span>*x(<span class="number">1</span>))];</span><br><span class="line">[t,x]=ode45(rabbitFox,[<span class="number">0</span>,<span class="number">50</span>],[<span class="number">300</span>,<span class="number">150</span>]);</span><br><span class="line"><span class="built_in">plot</span>(x(:,<span class="number">1</span>),x(:,<span class="number">2</span>));</span><br><span class="line">xlabel(<span class="string">&#x27;兔子数量&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;狐狸数量&#x27;</span>);</span><br><span class="line">title(<span class="string">&#x27;改进模型下，狐狸数量相对于兔子数量的关系曲线&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="专题六总结"><a href="#专题六总结" class="headerlink" title="专题六总结"></a>专题六总结</h2><h1 id="7-matlab-符号计算"><a href="#7-matlab-符号计算" class="headerlink" title="7 matlab 符号计算"></a>7 matlab 符号计算</h1><h2 id="7-1-符号对象-symbol"><a href="#7-1-符号对象-symbol" class="headerlink" title="7.1 符号对象: symbol"></a>7.1 符号对象: symbol</h2><blockquote>
<p>符号计算的结果是一个精确的数学表达式:符号推演，精确解。</p>
<p>数值计算的结果是一个数值：有舍入误差，近似解。</p>
<p>eval(): 将符号表达式转化成数值结果。</p>
<p>syms命令，定义符号变量</p>
<p>assume(condition)</p>
<p>assume(expr,set)</p>
<p>符号对象的运算：</p>
<ul>
<li>四则运算</li>
<li>关系运算</li>
<li>逻辑运算</li>
<li>因式分解和展开运算：factor(s);expand(s);collect(s);collect(s,v)</li>
<li>其他运算</li>
</ul>
<p>符号矩阵</p>
</blockquote>
<p> 梅森素数的验证问题。请验证M19 、 M23 、 M29 、 M31是否为梅森素数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms p;</span><br><span class="line">\&gt;&gt; m=<span class="number">2</span>^p<span class="number">-1</span>;</span><br><span class="line">\&gt;&gt; p=<span class="number">19</span>;</span><br><span class="line">\&gt;&gt; m19=eval(m)</span><br><span class="line">\&gt;&gt; <span class="built_in">factor</span>(m19)</span><br><span class="line">\&gt;&gt; p=<span class="number">23</span>;</span><br><span class="line">\&gt;&gt; m23=eval(m)</span><br><span class="line">\&gt;&gt; <span class="built_in">factor</span>(m23)</span><br><span class="line">\&gt;&gt; p=<span class="number">29</span>;</span><br><span class="line">\&gt;&gt; m29=eval(m)</span><br><span class="line">\&gt;&gt; <span class="built_in">factor</span>(m29)</span><br><span class="line">\&gt;&gt; p=<span class="number">31</span>;</span><br><span class="line">\&gt;&gt; m31=eval(m)</span><br><span class="line">\&gt;&gt; <span class="built_in">factor</span>(m31)</span><br></pre></td></tr></table></figure>
<p>例1 求方程ax^2+bx+c=0的根。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms a b c x;</span><br><span class="line">\&gt;&gt; f=a*x^<span class="number">2</span>+b*x+c</span><br><span class="line">\&gt;&gt; g=coeffs(f,x)</span><br><span class="line">\&gt;&gt; g=g(<span class="keyword">end</span>:<span class="number">-1</span>:<span class="number">1</span>)</span><br><span class="line">\&gt;&gt; roots(g)</span><br></pre></td></tr></table></figure>
<p>例2 当λ取何值时，以下齐次线性方程组有非零解。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">syms lamda;</span><br><span class="line">A=[<span class="number">1</span>-lamda,<span class="number">-2</span>,<span class="number">4</span>;<span class="number">2</span>,<span class="number">3</span>-lamda,<span class="number">1</span>;<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>-lamda];</span><br><span class="line">D=det(A);</span><br><span class="line"><span class="built_in">factor</span>(D)</span><br></pre></td></tr></table></figure>
<h2 id="7-2-符号微积分"><a href="#7-2-符号微积分" class="headerlink" title="7.2 符号微积分"></a>7.2 符号微积分</h2><blockquote>
<ol>
<li><p>极限：limit(f,x,a,’right/left’)</p>
</li>
<li><p>倒数：diff(f,x,n)</p>
</li>
<li><p>积分：</p>
<ul>
<li>不定积分：int(f,x)</li>
<li>定积分：int(f,x,a,b); 无限：inf</li>
</ul>
</li>
</ol>
</blockquote>
<p>例1 求下列极限。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms a m x n;</span><br><span class="line">\&gt;&gt; f=(x^(<span class="number">1</span>/m)-a^(<span class="number">1</span>/m))/(x-a);</span><br><span class="line">\&gt;&gt; limit(f,x,a)</span><br><span class="line">\&gt;&gt; g=(<span class="number">1</span>+<span class="number">1</span>/n)^n;</span><br><span class="line">\&gt;&gt; limit(g,n,<span class="built_in">inf</span>)</span><br></pre></td></tr></table></figure>
<p>例2 求下列函数的导数。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x y z;</span><br><span class="line">\&gt;&gt; f=<span class="built_in">sqrt</span>(<span class="number">1</span>+<span class="built_in">exp</span>(x));</span><br><span class="line">\&gt;&gt; diff(f)  </span><br><span class="line"></span><br><span class="line">\&gt;&gt; g=x*<span class="built_in">exp</span>(y)/y^<span class="number">2</span>;</span><br><span class="line">\&gt;&gt; diff(g,x)</span><br><span class="line">     </span><br><span class="line">\&gt;&gt; diff(g,y) </span><br></pre></td></tr></table></figure>
<p>例3 求下列不定积分。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x t;</span><br><span class="line">\&gt;&gt; f=(<span class="number">3</span>-x^<span class="number">2</span>)^<span class="number">3</span>;</span><br><span class="line">\&gt;&gt; int(f)</span><br><span class="line">\&gt;&gt; g=<span class="number">5</span>*x*t/(<span class="number">1</span>+x^<span class="number">2</span>);</span><br><span class="line">\&gt;&gt; int(g,t)    </span><br></pre></td></tr></table></figure>
<p>​     </p>
<p>例4 求下列定积分。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x t;</span><br><span class="line">\&gt;&gt; int(<span class="built_in">abs</span>(<span class="number">1</span>-x),<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; int(<span class="number">1</span>/(<span class="number">1</span>+x^<span class="number">2</span>),-<span class="built_in">inf</span>,<span class="built_in">inf</span>)</span><br><span class="line"></span><br><span class="line">\&gt;&gt; int(<span class="number">4</span>*x/t,t,<span class="number">2</span>,<span class="built_in">sin</span>(x))</span><br></pre></td></tr></table></figure>
<p>河道水流量的估算问题。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">xi=<span class="number">0</span>:<span class="number">50</span>:<span class="number">600</span>;</span><br><span class="line">yi=[<span class="number">4.4</span>,<span class="number">4.5</span>,<span class="number">4.6</span>,<span class="number">4.8</span>,<span class="number">4.9</span>,<span class="number">5.1</span>,<span class="number">5.4</span>,<span class="number">5.2</span>,<span class="number">5.5</span>,<span class="number">5.2</span>,<span class="number">4.9</span>,<span class="number">4.8</span>,<span class="number">4.7</span>];</span><br><span class="line">p=polyfit(xi,yi,<span class="number">3</span>);</span><br><span class="line"><span class="built_in">plot</span>(xi,yi,<span class="string">&#x27;o&#x27;</span>,xi,polyval(p,xi));</span><br><span class="line">syms y x;</span><br><span class="line">y=poly2sym(p,x);</span><br><span class="line">s=int(y,x,<span class="number">0</span>,<span class="number">600</span>);   </span><br><span class="line">v=s*<span class="number">0.6</span>;       </span><br><span class="line">eval(v)</span><br><span class="line"></span><br><span class="line">yn=-yi;</span><br><span class="line">p=polyfit(xi,yn,<span class="number">3</span>);</span><br><span class="line"><span class="built_in">plot</span>(xi,yn,<span class="string">&#x27;o&#x27;</span>,xi,polyval(p,xi));</span><br><span class="line">syms y x yii;</span><br><span class="line">y=poly2sym(p,x);</span><br><span class="line">yii=diff(y,x); </span><br><span class="line">x=<span class="number">50</span>:<span class="number">60</span>;                  </span><br><span class="line">k=eval(yii);                </span><br><span class="line">all(<span class="built_in">abs</span>(k)&lt;<span class="number">1</span>/<span class="number">1.5</span>)</span><br></pre></td></tr></table></figure>
<h2 id="7-3-级数"><a href="#7-3-级数" class="headerlink" title="7.3 级数"></a>7.3 级数</h2><blockquote>
<ol>
<li>级数求和<ul>
<li>sum()</li>
<li>symsum(s,v,n,m)</li>
</ul>
</li>
<li><p>泰勒级数：将任意函数表示为幂级数</p>
<ul>
<li>taylor(f,v,a,Name,Value)</li>
</ul>
</li>
<li><p>复杂函数的计算方法问题</p>
<ul>
<li>加法= 逻辑电路</li>
<li>减法 = 加法转换</li>
<li>乘除 = 加法 + 移位</li>
<li>复杂函数 = 转换成四则运算，例泰勒级数</li>
</ul>
</li>
</ol>
</blockquote>
<p>例1 求下列级数之和。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms n;</span><br><span class="line">\&gt;&gt; s1=symsum(n^<span class="number">2</span>,<span class="number">1</span>,<span class="number">100</span>)</span><br><span class="line">\&gt;&gt; s2=symsum((<span class="number">-1</span>)^(n<span class="number">-1</span>)/n,<span class="number">1</span>,<span class="built_in">inf</span>)</span><br><span class="line">\&gt;&gt; s3=symsum((<span class="number">-1</span>)^(n<span class="number">-1</span>)/(<span class="number">2</span>*n<span class="number">-1</span>),n,<span class="number">1</span>,<span class="built_in">inf</span>)</span><br><span class="line">\&gt;&gt; hypergeom([<span class="number">-1</span>/<span class="number">2</span>, <span class="number">1</span>], <span class="number">1</span>/<span class="number">2</span>, <span class="number">-1</span>)   <span class="comment">%超几何函数</span></span><br><span class="line">\&gt;&gt; eval(s3)*<span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>银行利率的计算问题。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms k r;</span><br><span class="line">\&gt;&gt; p2=symsum(<span class="number">50000</span>*(<span class="number">1</span>+<span class="number">0.045</span>/k)^k,k,<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">\&gt;&gt; eval(p2)</span><br><span class="line">\&gt;&gt; p4=symsum(<span class="number">50000</span>*(<span class="number">1</span>+<span class="number">0.045</span>/k)^k,k,<span class="number">4</span>,<span class="number">4</span>);</span><br><span class="line">\&gt;&gt; eval(p4)</span><br><span class="line">\&gt;&gt; p12=symsum(<span class="number">50000</span>*(<span class="number">1</span>+<span class="number">0.045</span>/k)^k,k,<span class="number">12</span>,<span class="number">12</span>);</span><br><span class="line">\&gt;&gt; eval(p12)</span><br><span class="line">\&gt;&gt; limit((<span class="number">1</span>+r/k)^k,k,<span class="built_in">inf</span>)</span><br><span class="line">\&gt;&gt; <span class="number">50000</span>*<span class="built_in">exp</span>(<span class="number">0.045</span>)</span><br></pre></td></tr></table></figure>
<p>例2 求函数f(x)在x=1处的5阶泰勒级数展开式。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x;</span><br><span class="line">\&gt;&gt; f=(<span class="number">1</span>+x+x^<span class="number">2</span>)/(<span class="number">1</span>-x+x^<span class="number">2</span>);</span><br><span class="line">\&gt;&gt; taylor(f,x,<span class="number">1</span>,<span class="string">&#x27;Order&#x27;</span>,<span class="number">6</span>)</span><br><span class="line">\&gt;&gt;expand(<span class="built_in">ans</span>)</span><br></pre></td></tr></table></figure>
<p>例3 利用泰勒展开式计算三角函数的值。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x;</span><br><span class="line">\&gt;&gt; f=taylor(<span class="built_in">cos</span>(x),x,<span class="built_in">pi</span>)</span><br><span class="line">\&gt;&gt; x=<span class="number">3</span>;</span><br><span class="line">\&gt;&gt; eval(f)</span><br><span class="line">\&gt;&gt; <span class="built_in">cos</span>(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h2 id="7-4-符号方程求解"><a href="#7-4-符号方程求解" class="headerlink" title="7.4 符号方程求解"></a>7.4 符号方程求解</h2><blockquote>
<ol>
<li>代数方程： <ul>
<li>solve(s) ;不一定准确</li>
<li>solve(s,v)</li>
<li>solve(s1,sn,v1,vn)</li>
</ul>
</li>
<li>常微分方程 equation;condition;variable<ul>
<li>D表示倒数: Dy;D2y</li>
<li>dsolve(e,c,v)</li>
<li>dsolve(e1,e2,c1,cn,v)</li>
</ul>
</li>
</ol>
</blockquote>
<p>例1 解方程ax^2+bx+c=0。    </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x y a b c; </span><br><span class="line">\&gt;&gt; solve(a*x^<span class="number">2</span>+b*x+c==<span class="number">0</span>)</span><br><span class="line">\&gt;&gt; f=a*x^<span class="number">2</span>+b*x+c==<span class="number">0</span>;</span><br><span class="line">\&gt;&gt; solve(f) </span><br><span class="line">\&gt;&gt; solve(a*x^<span class="number">2</span>+b*x+c)</span><br><span class="line">\&gt;&gt; f=a*x^<span class="number">2</span>+b*x+c</span><br><span class="line">\&gt;&gt; solve(f)</span><br></pre></td></tr></table></figure>
<p>例2 求下列微分方程或方程组的解。  </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms x y t;</span><br><span class="line">\&gt;&gt; y=dsolve(<span class="string">&#x27;Dy-(x^2+y^2)/x^2/2&#x27;</span>,x)</span><br><span class="line">\&gt;&gt; [x,y]=dsolve(<span class="string">&#x27;Dx=4*x-2*y&#x27;</span>,<span class="string">&#x27;Dy=2*x-y&#x27;</span>,t)</span><br></pre></td></tr></table></figure>
<p>疾病传染问题。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt;&gt; syms a b c y t;</span><br><span class="line">\&gt;&gt; f=dsolve(<span class="string">&#x27;Dy=a*y*(1-y)-c*y&#x27;</span>, <span class="string">&#x27;y(0)=b&#x27;</span>,t)</span><br><span class="line">\&gt;&gt; f=dsolve(<span class="string">&#x27;Dy=a*y*(1-y)-a*y&#x27;</span>, <span class="string">&#x27;y(0)=b&#x27;</span>,t)</span><br></pre></td></tr></table></figure>
<h2 id="专题七知识点总结"><a href="#专题七知识点总结" class="headerlink" title="专题七知识点总结"></a>专题七知识点总结</h2><h1 id="8-matlab-图形用户界面设计"><a href="#8-matlab-图形用户界面设计" class="headerlink" title="8 matlab 图形用户界面设计"></a>8 matlab 图形用户界面设计</h1><h2 id="8-1-图形窗口与坐标轴"><a href="#8-1-图形窗口与坐标轴" class="headerlink" title="8.1 图形窗口与坐标轴"></a>8.1 图形窗口与坐标轴</h2><blockquote>
<ol>
<li><p>图形对象：曲线、曲面、坐标轴、图形窗口</p>
<ul>
<li><p>句柄</p>
</li>
<li><p>属性</p>
<blockquote>
<p>points 磅</p>
</blockquote>
</li>
</ul>
</li>
<li><p>图形窗口对象</p>
</li>
<li><p>坐标轴对象</p>
</li>
</ol>
</blockquote>
<p>例1 绘制多个图形，并保存图形句柄。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t=<span class="number">0</span>:<span class="built_in">pi</span>/<span class="number">10</span>:<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">h1=<span class="built_in">plot3</span>(t+<span class="built_in">pi</span>,t<span class="number">-2</span>*<span class="built_in">pi</span>,<span class="built_in">sin</span>(t),<span class="string">&#x27;r&#x27;</span>); </span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line">[x,y]=<span class="built_in">meshgrid</span>(t);</span><br><span class="line">z=<span class="built_in">sin</span>(x);</span><br><span class="line">h2=mesh(t<span class="number">-2</span>*<span class="built_in">pi</span>,t+<span class="built_in">pi</span>,z);</span><br><span class="line">[x3,y3,z3]=cylinder(t);</span><br><span class="line">h3=surf(x3,y3,z3);</span><br></pre></td></tr></table></figure>
<p>例2 分别在两个子图中绘制曲线和曲面。然后设置子图1的背景色为黄色，曲线线条颜色为红色，设置子图2的背景色为青色。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">h1=fplot(@(t)t.*<span class="built_in">sin</span>(t),@(t)t.*<span class="built_in">cos</span>(t),[<span class="number">0</span>,<span class="number">6</span>*<span class="built_in">pi</span>] );</span><br><span class="line">axis equal</span><br><span class="line">subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">[x,y,z]=peaks(<span class="number">20</span>);</span><br><span class="line">h2=mesh(x,y,z);</span><br><span class="line">h10=h1.Parent;</span><br><span class="line">h10.Color=<span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">h1.Color=<span class="string">&#x27;r&#x27;</span>;</span><br><span class="line">h2.Parent.Color=<span class="string">&#x27;cyan&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>例3 建立一个图形窗口。该图形窗口没有菜单条，标题名称为“图形窗口示例”，起始于屏幕左下角、宽度和高度分别为300像素点和150像素点，背景颜色为青色，且当用户从键盘按下任意一个键时，然后在窗口中单击鼠标左键，在鼠标指针所在位置将显示“Hello,World!” 。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">hf=<span class="built_in">figure</span>;</span><br><span class="line">hf.Color=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>];</span><br><span class="line">hf.Position=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">300</span>,<span class="number">150</span>];</span><br><span class="line">hf.Name=<span class="string">&#x27;图形窗口示例&#x27;</span>;</span><br><span class="line">hf.NumberTitle=<span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">hf.MenuBar=<span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">hf.ButtonDownFcn=<span class="string">&#x27;gtext(&#x27;&#x27;Hello,World!&#x27;&#x27;)&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>例4 利用坐标轴对象实现图形窗口的分割。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ha1=axes(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.1</span>,<span class="number">0.1</span>,<span class="number">0.7</span>,<span class="number">0.7</span>]);</span><br><span class="line">contour(peaks(<span class="number">20</span>))</span><br><span class="line">ha1.Title=title(<span class="string">&#x27;等高线&#x27;</span>);</span><br><span class="line">ha1.YLabel=ylabel(<span class="string">&#x27;南北向&#x27;</span>);</span><br><span class="line">ha1.XLabel=xlabel(<span class="string">&#x27;东西向&#x27;</span>);</span><br><span class="line">ha2=axes(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.65</span>,<span class="number">0.7</span>,<span class="number">0.28</span>,<span class="number">0.28</span>]);</span><br><span class="line">surf(peaks(<span class="number">20</span>))</span><br><span class="line">ha2.View=[<span class="number">-30</span>,<span class="number">45</span>];</span><br></pre></td></tr></table></figure>
<p>例5 定义包含4种颜色的ColorOrder属性，绘制6条曲线。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">x=[<span class="number">0</span>,<span class="number">0</span>];y=[<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line">ha=axes;</span><br><span class="line">ha.ColorOrder=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>; <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>; <span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>; <span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(x,y, x+<span class="number">0.5</span>,y, x+<span class="number">1</span>,y, x+<span class="number">1.5</span>,y, x+<span class="number">2</span>,y, x+<span class="number">2.5</span>,y);</span><br><span class="line">ha.XLim=[<span class="number">-0.2</span>,<span class="number">3</span>];</span><br><span class="line">ha.YLim=[<span class="number">-0.2</span>,<span class="number">1.2</span>];</span><br></pre></td></tr></table></figure>
<h2 id="8-2-曲线与曲面对象"><a href="#8-2-曲线与曲面对象" class="headerlink" title="8.2 曲线与曲面对象"></a>8.2 曲线与曲面对象</h2><blockquote>
<ol>
<li><p>曲线对象</p>
<ul>
<li><p>line(x,y,z)</p>
<blockquote>
<p>plot 函数每调用一次，就会刷新坐标轴，清空原有图形再绘制新的曲线</p>
</blockquote>
</li>
</ul>
</li>
<li><p>曲面对象</p>
<ul>
<li><p>surface(x,y,z,c)</p>
<blockquote>
<p>surf函数每调用一次，就会刷新坐标轴，清空原有图形再绘制新的曲面</p>
</blockquote>
</li>
</ul>
</li>
<li><p>关照处理</p>
<ul>
<li>light（）</li>
</ul>
</li>
<li><p>图形对象的反射特性</p>
<ul>
<li></li>
</ul>
</li>
</ol>
</blockquote>
<p>例1 利用曲线对象绘制五环图案。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">t=<span class="number">-0.1</span> : <span class="number">0.1</span> : <span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line">x=<span class="built_in">cos</span>(t); y=<span class="built_in">sin</span>(t);</span><br><span class="line">line(x,y,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">line(x+<span class="number">1.2</span>,y<span class="number">-1</span>,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">line(x+<span class="number">2.4</span>,y,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">line(x+<span class="number">3.6</span>,y<span class="number">-1</span>,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">line(x+<span class="number">4.8</span>,y,<span class="string">&#x27;Color&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ha=gca; <span class="comment">%获取当前坐标轴句柄</span></span><br><span class="line"><span class="keyword">for</span> n=<span class="number">1</span>:<span class="built_in">size</span>(ha.Children)</span><br><span class="line">  ha.Children(n).LineWidth=<span class="number">5</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">ha.XLim=[<span class="number">-2</span>,<span class="number">7</span>];</span><br><span class="line">ha.YLim=[<span class="number">-3</span>,<span class="number">2</span>];</span><br><span class="line">axis equal <span class="comment">%使圆呈现正圆</span></span><br></pre></td></tr></table></figure>
<p>例2 利用曲面对象绘制立体圆环</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">r=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>);</span><br><span class="line">[u,v]=<span class="built_in">meshgrid</span>(r);</span><br><span class="line">x=(<span class="number">8</span>+<span class="number">3</span>*<span class="built_in">cos</span>(v)).*<span class="built_in">cos</span>(u);</span><br><span class="line">y=(<span class="number">8</span>+<span class="number">3</span>*<span class="built_in">cos</span>(v)).*<span class="built_in">sin</span>(u);</span><br><span class="line">z=<span class="number">3</span>*<span class="built_in">sin</span>(v);</span><br><span class="line">axes(<span class="string">&#x27;view&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>])</span><br><span class="line">hs=surface(x,y,z);</span><br><span class="line">axis equal;</span><br><span class="line"></span><br><span class="line">hs.EdgeColor=<span class="string">&#x27;none&#x27;</span>; <span class="comment">%无网格线</span></span><br><span class="line">hs.FaceColor=<span class="string">&#x27;interp&#x27;</span>; <span class="comment">%曲面网格用插值模式填充</span></span><br></pre></td></tr></table></figure>
<p>例3 绘制光照处理后的圆环面并观察不同光照模式下的效果。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">r=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>); [u,v]=<span class="built_in">meshgrid</span>(r);</span><br><span class="line">x=(<span class="number">8</span>+<span class="number">3</span>*<span class="built_in">cos</span>(v)).*<span class="built_in">cos</span>(u); y=(<span class="number">8</span>+<span class="number">3</span>*<span class="built_in">cos</span>(v)).*<span class="built_in">sin</span>(u); z=<span class="number">3</span>*<span class="built_in">sin</span>(v);</span><br><span class="line">axes(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.05</span>,<span class="number">0.675</span>,<span class="number">1.0</span>,<span class="number">0.3</span>], <span class="string">&#x27;View&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>]);</span><br><span class="line">hs1=surface(x,y,z); axis equal;</span><br><span class="line">hs1.EdgeColor=<span class="string">&#x27;none&#x27;</span>; hs1.FaceColor=<span class="string">&#x27;interp&#x27;</span>;</span><br><span class="line">axes(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.05</span>,<span class="number">0.35</span>,<span class="number">1.0</span>,<span class="number">0.3</span>], <span class="string">&#x27;View&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>]);</span><br><span class="line">hs2=surface(x,y,z); axis equal;</span><br><span class="line">hs2.EdgeColor=<span class="string">&#x27;none&#x27;</span>; hs2.FaceColor=<span class="string">&#x27;interp&#x27;</span>;</span><br><span class="line">light(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>])</span><br><span class="line">lighting flat</span><br><span class="line">axes(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.05</span>,<span class="number">0.025</span>,<span class="number">1.0</span>,<span class="number">0.3</span>], <span class="string">&#x27;View&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>]);</span><br><span class="line">hs3=surface(x,y,z); axis equal;</span><br><span class="line">hs3.EdgeColor=<span class="string">&#x27;none&#x27;</span>; hs3.FaceColor=<span class="string">&#x27;interp&#x27;</span>;</span><br><span class="line">light(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>])</span><br><span class="line">lighting phong</span><br></pre></td></tr></table></figure>
<p>例4 绘制具有不同反射特性的圆环面并观察反射特性对图形效果的影响。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">r=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>); [u,v]=<span class="built_in">meshgrid</span>(r);</span><br><span class="line">x=(<span class="number">8</span>+<span class="number">3</span>*<span class="built_in">cos</span>(v)).*<span class="built_in">cos</span>(u); y=(<span class="number">8</span>+<span class="number">3</span>*<span class="built_in">cos</span>(v)).*<span class="built_in">sin</span>(u); z=<span class="number">3</span>*<span class="built_in">sin</span>(v);</span><br><span class="line">axes(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.05</span>,<span class="number">0.675</span>,<span class="number">1.0</span>,<span class="number">0.3</span>],<span class="string">&#x27;View&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>]);</span><br><span class="line">hs1=surface(x,y,z);axis equal;</span><br><span class="line">hs1.EdgeColor=<span class="string">&#x27;none&#x27;</span>;hs1.FaceColor=<span class="string">&#x27;interp&#x27;</span>;</span><br><span class="line">light(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>]) ;lighting phong</span><br><span class="line">hs1.SpecularStrength=<span class="number">0.1</span>;</span><br><span class="line">axes(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.05</span>,<span class="number">0.35</span>,<span class="number">1.0</span>,<span class="number">0.3</span>],<span class="string">&#x27;View&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>]);</span><br><span class="line">hs2=surface(x,y,z);axis equal;</span><br><span class="line">hs2.EdgeColor=<span class="string">&#x27;none&#x27;</span>;hs2.FaceColor=<span class="string">&#x27;interp&#x27;</span>;</span><br><span class="line">light(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>]) ;lighting phong</span><br><span class="line">hs2.SpecularStrength=<span class="number">0.5</span>;</span><br><span class="line">axes(<span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.05</span>,<span class="number">0.025</span>,<span class="number">1.0</span>,<span class="number">0.3</span>],<span class="string">&#x27;View&#x27;</span>,[<span class="number">-37.5</span>,<span class="number">30</span>]);</span><br><span class="line">hs3=surface(x,y,z);axis equal;</span><br><span class="line">hs3.EdgeColor=<span class="string">&#x27;none&#x27;</span>;hs3.FaceColor=<span class="string">&#x27;interp&#x27;</span>;</span><br><span class="line">light(<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>]) ;lighting phong ;</span><br><span class="line">hs3.SpecularStrength=<span class="number">1.0</span>;</span><br></pre></td></tr></table></figure>
<h2 id="8-3-图形用户界面设计方法"><a href="#8-3-图形用户界面设计方法" class="headerlink" title="8.3 图形用户界面设计方法"></a>8.3 图形用户界面设计方法</h2><blockquote>
<p>Graphical User Interface(GUI)</p>
<ol>
<li>控件函数<ul>
<li>uicontrol() </li>
</ul>
</li>
<li>GUIDE</li>
</ol>
</blockquote>
<p>例1  在图形窗口中建立三个按钮对象，当单击按钮时分别绘制正弦曲线、显示或隐藏坐标轴的网格、清除坐标轴的图形。</p>
<blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ha= axes(<span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;pixels&#x27;</span>,<span class="string">&#x27;Position&#x27;</span>,[<span class="number">40</span>,<span class="number">40</span>,<span class="number">360</span>,<span class="number">360</span>]);  </span><br><span class="line">ptgrid=uicontrol(<span class="string">&#x27;Style&#x27;</span>,<span class="string">&#x27;pushbutton&#x27;</span>,...</span><br><span class="line">   <span class="string">&#x27;String&#x27;</span>,<span class="string">&#x27;网格&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">450</span>,<span class="number">120</span>,<span class="number">48</span>,<span class="number">20</span>],...</span><br><span class="line">  <span class="string">&#x27;Callback&#x27;</span>,<span class="string">&#x27;grid&#x27;</span> );</span><br><span class="line">btncla = uicontrol(<span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">  <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;清除&#x27;</span>,<span class="string">&#x27;Position&#x27;</span>, [<span class="number">450</span>,<span class="number">80</span>,<span class="number">48</span>,<span class="number">20</span>],...</span><br><span class="line">  <span class="string">&#x27;Callback&#x27;</span>,<span class="string">&#x27;cla&#x27;</span> );  </span><br><span class="line">btnplot = uicontrol(<span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">   <span class="string">&#x27;String&#x27;</span>,<span class="string">&#x27;绘图&#x27;</span>,<span class="string">&#x27;Position&#x27;</span>, [<span class="number">450</span>,<span class="number">160</span>,<span class="number">48</span>,<span class="number">20</span>]); </span><br><span class="line"><span class="comment">%设置“绘图”按钮的Callback属性值是plot_sin函数句柄。</span></span><br><span class="line">btnplot.Callback=@plot_sin;</span><br></pre></td></tr></table></figure>
<p>新建回调函数文件plot_sin.m</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">plot_sin</span><span class="params">(source, callbackdata)</span></span></span><br><span class="line">  t=-<span class="built_in">pi</span>:<span class="built_in">pi</span>/<span class="number">20</span>:<span class="built_in">pi</span>;</span><br><span class="line">  <span class="built_in">plot</span>(t,<span class="built_in">sin</span>(t));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>例2 在例1的界面中添加“图形选项”菜单项，其中包括一个二级菜单项“线型”，其下又有3个子菜单项，分别为“实线”、“虚线”、“双划线”。</p>
<blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">hopt=uimenu(gcf,<span class="string">&#x27;Label&#x27;</span>,<span class="string">&#x27;图形选项&#x27;</span>,<span class="string">&#x27;Accelerator&#x27;</span>,<span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">hLStyle=uimenu(hopt,<span class="string">&#x27;Label&#x27;</span>,<span class="string">&#x27;线型&#x27;</span>,<span class="string">&#x27;Tag&#x27;</span>,<span class="string">&#x27;LStyle&#x27;</span>, <span class="string">&#x27;Enable&#x27;</span>,<span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">hL_Solid=uimenu(hLStyle,<span class="string">&#x27;Label&#x27;</span>,<span class="string">&#x27;实线&#x27;</span>,...</span><br><span class="line">  <span class="string">&#x27;Tag&#x27;</span>,<span class="string">&#x27;Solid&#x27;</span>,<span class="string">&#x27;Callback&#x27;</span>, @MLine_Type);</span><br><span class="line">hL_Dotted=uimenu(hLStyle,<span class="string">&#x27;Label&#x27;</span>,<span class="string">&#x27;虚线&#x27;</span>,...</span><br><span class="line">  <span class="string">&#x27;Tag&#x27;</span>,<span class="string">&#x27;Dotted&#x27;</span>,<span class="string">&#x27;Callback&#x27;</span>, @MLine_Type);</span><br><span class="line">hL_Dashed=uimenu(hLStyle,<span class="string">&#x27;Label&#x27;</span>,<span class="string">&#x27;双划线&#x27;</span>,...</span><br><span class="line">  <span class="string">&#x27;Tag&#x27;</span>,<span class="string">&#x27;Dashed&#x27;</span>,<span class="string">&#x27;Callback&#x27;</span>, @MLine_Type);</span><br></pre></td></tr></table></figure>
<p>新建回调函数文件MLine_Type.m</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MLine_Type</span><span class="params">(source,callbackdata)</span></span></span><br><span class="line">  hline=findobj(<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;line&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> strcmp(source.Tag,<span class="string">&#x27;Solid&#x27;</span> )==<span class="number">1</span></span><br><span class="line">    hline.LineStyle=<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">  <span class="keyword">elseif</span> strcmp(source.Tag,<span class="string">&#x27;Dotted&#x27;</span> )==<span class="number">1</span></span><br><span class="line">    hline.LineStyle=<span class="string">&#x27;:&#x27;</span>; </span><br><span class="line">  <span class="keyword">elseif</span> strcmp(source.Tag,<span class="string">&#x27;Dashed&#x27;</span> )==<span class="number">1</span></span><br><span class="line">    hline.LineStyle=<span class="string">&#x27;--&#x27;</span>;  </span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>修改回调函数文件plot_sin.m</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">&gt; <span class="function"><span class="keyword">function</span> <span class="title">plot_sin</span><span class="params">(source, callbackdata)</span></span></span><br><span class="line">&gt;   t=-<span class="built_in">pi</span>:<span class="built_in">pi</span>/<span class="number">20</span>:<span class="built_in">pi</span>;</span><br><span class="line">&gt;   <span class="built_in">plot</span>(t,<span class="built_in">sin</span>(t));</span><br><span class="line">&gt;   h1=findobj(<span class="string">&#x27;Tag&#x27;</span>,<span class="string">&#x27;LStyle&#x27;</span>);</span><br><span class="line">&gt;   h1.Enable=<span class="string">&#x27;On&#x27;</span>;  <span class="comment">%使得 “线型”菜单项可用</span></span><br><span class="line">&gt; <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="8-4-用户界面设计工具"><a href="#8-4-用户界面设计工具" class="headerlink" title="8.4 用户界面设计工具"></a>8.4 用户界面设计工具</h2><blockquote>
<ol>
<li>回调函数Callback</li>
</ol>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%“绘图”按钮的Callback函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pushbutton1_Callback</span><span class="params">(hObject, eventdata, handles)</span></span></span><br><span class="line">A=eval(handles.editfz.String);</span><br><span class="line">f=eval(handles.editpl.String)/<span class="number">50</span>;</span><br><span class="line">theta=eval(handles.editxj.String)/<span class="number">180</span>*<span class="built_in">pi</span>;</span><br><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>);</span><br><span class="line"><span class="keyword">if</span> handles.OpSin.Value==<span class="number">1</span></span><br><span class="line">  y=A*<span class="built_in">sin</span>(f*x+theta);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  y=A*<span class="built_in">cos</span>(f*x+theta);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">plot</span>(x,y);</span><br><span class="line">handles.PStyle.Enable=<span class="string">&#x27;On&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%“实线”菜单项的回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Solid_Callback</span><span class="params">(hObject, eventdata, handles)</span></span></span><br><span class="line">hline=findobj(<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;line&#x27;</span>);</span><br><span class="line">hline.LineStyle=<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">handles.Solid.Checked=<span class="string">&#x27;On&#x27;</span>;</span><br><span class="line">handles.Dotted.Checked=<span class="string">&#x27;Off&#x27;</span>;</span><br><span class="line">handles.Dashed.Checked=<span class="string">&#x27;Off&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%“红”菜单项的回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">r_Callback</span><span class="params">(hObject, eventdata, handles)</span></span></span><br><span class="line">hline=findobj(<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;line&#x27;</span>);</span><br><span class="line">hline.Color=<span class="string">&#x27;r&#x27;</span>;</span><br><span class="line">handles.r.Checked=<span class="string">&#x27;On&#x27;</span>;</span><br><span class="line">handles.g.Checked=<span class="string">&#x27;Off&#x27;</span>;</span><br><span class="line">handles.b.Checked=<span class="string">&#x27;Off&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="8-5-APP-设计工具"><a href="#8-5-APP-设计工具" class="headerlink" title="8.5 APP 设计工具"></a>8.5 APP 设计工具</h2><blockquote>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%绘图按钮的回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Draw_Plot</span><span class="params">(app)</span></span></span><br><span class="line">f=eval(app.DiscreteKnob.Value); <span class="comment">%获取离散旋钮对象的Value属性值</span></span><br><span class="line">theta=app.Knob.Value/<span class="number">180</span>*<span class="built_in">pi</span>; <span class="comment">%获取旋钮对象的Value属性值</span></span><br><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">60</span>);</span><br><span class="line"><span class="keyword">if</span> app.RadioButton.Value==<span class="number">1</span> </span><br><span class="line">y=<span class="built_in">sin</span>(f*x+theta);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">y=<span class="built_in">cos</span>(f*x+theta);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% plot函数的第1个参数必须是坐标轴对象句柄</span></span><br><span class="line"><span class="comment">%plot函数默认的线条宽度为1，App程序的线条宽度必须小于0.4</span></span><br><span class="line"><span class="built_in">plot</span>(app.UIAxes,x,y,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">0.2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%清空按钮的回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Clear_Axes</span><span class="params">(app)</span></span></span><br><span class="line">cla(app.UIAxes)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="8-6-图形用户界面应用举例"><a href="#8-6-图形用户界面应用举例" class="headerlink" title="8.6 图形用户界面应用举例"></a>8.6 图形用户界面应用举例</h2><blockquote>
</blockquote>
<p>例1 利用GUIDE设计工具设计如图所示的用户界面。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%图形窗口的打开事件响应</span></span><br><span class="line">handles.peaks=peaks(<span class="number">34</span>);</span><br><span class="line">handles.membrane=membrane;</span><br><span class="line">[x,y]=<span class="built_in">meshgrid</span>(<span class="number">-8</span>:<span class="number">0.3</span>:<span class="number">8</span>);</span><br><span class="line">r=<span class="built_in">sqrt</span>(x.^<span class="number">2</span>+y.^<span class="number">2</span>);</span><br><span class="line">sinc=<span class="built_in">sin</span>(r)./(r+<span class="built_in">eps</span>);</span><br><span class="line">handles.sinc=sinc;</span><br><span class="line">handles.current_data=handles.sinc;</span><br><span class="line">colormap(spring);</span><br><span class="line"></span><br><span class="line"><span class="comment">%Mseh_Callback函数</span></span><br><span class="line">    mesh(handles.current_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">%Surf_Callback函数</span></span><br><span class="line">    surf(handles.current_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">%Contour3_Callback函数</span></span><br><span class="line">    contour3(handles.current_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">%切换按钮的Callback函数</span></span><br><span class="line"><span class="keyword">if</span> hObject.Value==<span class="number">1</span></span><br><span class="line">  grid on</span><br><span class="line">  hObject.String=<span class="string">&#x27;隐藏网格&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">  grid off</span><br><span class="line">  hObject.String=<span class="string">&#x27;显示网格&#x27;</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%列表框的Callback函数</span></span><br><span class="line">str=hObject.String;</span><br><span class="line">val=hObject.Value;</span><br><span class="line"><span class="keyword">switch</span> strtrim(str&#123;val&#125;)</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;Peaks&#x27;</span> </span><br><span class="line">  handles.current_data=handles.peaks;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;Membrane&#x27;</span> </span><br><span class="line">  handles.current_data=handles.membrane;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;Sinc&#x27;</span></span><br><span class="line">  handles.current_data=handles.sinc;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">guidata(hObject,handles)</span><br><span class="line"></span><br><span class="line"><span class="comment">%色图弹出式菜单的Callback函数</span></span><br><span class="line">str=hObject.String;</span><br><span class="line">cm=hObject.Value;</span><br><span class="line">colormap( eval(str&#123;cm&#125;) );</span><br><span class="line"></span><br><span class="line"><span class="comment">%视点设置按钮的Callback函数</span></span><br><span class="line">el=eval(handles.edit_el.String);</span><br><span class="line">az=eval(handles.edit_az.String);</span><br><span class="line">view(az,el)</span><br><span class="line"></span><br><span class="line"><span class="comment">%着色方式按钮组ChooseShading的SelectionChanged函数</span></span><br><span class="line"><span class="keyword">switch</span> eventdata.NewValue.Tag</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;rb_flat&#x27;</span></span><br><span class="line">    shading flat;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;rb_interp&#x27;</span></span><br><span class="line">    shading interp;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;rb_faceted&#x27;</span></span><br><span class="line">    shading faceted;</span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>例2 生成一个用于观察周期信号波形叠加效果的程序模块。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%“开始”按钮的回调函数</span></span><br><span class="line">amr=eval(app.ARadio.Value);</span><br><span class="line">theta=app.PhDiff.Value/<span class="number">180</span>*<span class="built_in">pi</span>;</span><br><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">10</span>*<span class="built_in">pi</span>,<span class="number">300</span>);</span><br><span class="line">y=<span class="built_in">sin</span>(x)+<span class="built_in">sin</span>(<span class="number">3</span>*x+theta)/amr;</span><br><span class="line"><span class="keyword">if</span> strcmp(app.Noise.Value,<span class="string">&#x27;On&#x27;</span>)</span><br><span class="line">        y=awgn(y,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">app.WaveA.Value=<span class="built_in">max</span>(y);</span><br><span class="line"><span class="built_in">plot</span>(app.UIAxes,x,y,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">0.1</span>);</span><br></pre></td></tr></table></figure>
<h2 id="专题八总结"><a href="#专题八总结" class="headerlink" title="专题八总结"></a>专题八总结</h2><h1 id="Simulink-系统仿真"><a href="#Simulink-系统仿真" class="headerlink" title="Simulink 系统仿真"></a>Simulink 系统仿真</h1><h2 id="9-1-simulink-仿真基础"><a href="#9-1-simulink-仿真基础" class="headerlink" title="9.1 simulink 仿真基础"></a>9.1 simulink 仿真基础</h2><blockquote>
<p><strong>启动</strong></p>
<ol>
<li>“主页”选项卡：新建</li>
<li>“主页”选项卡：simulink</li>
<li>命令行窗口，simulink</li>
</ol>
<p><strong>模型</strong></p>
<p><strong>模块</strong></p>
<p><strong>模型存盘</strong></p>
<p><strong>模块参数</strong></p>
<p><strong>步骤</strong></p>
<ol>
<li>建立系统仿真模型</li>
<li>设置仿真参数</li>
<li>启动仿真并分析仿真结果</li>
</ol>
</blockquote>
<h2 id="9-2-子系统的创建与封装"><a href="#9-2-子系统的创建与封装" class="headerlink" title="9.2 子系统的创建与封装"></a>9.2 子系统的创建与封装</h2><p><strong>创建</strong></p>
<ol>
<li>新建</li>
<li>模块转换</li>
</ol>
<p><strong>封装</strong></p>
<p><strong>条件执行</strong></p>
<h2 id="9-3-s函数的设计与应用"><a href="#9-3-s函数的设计与应用" class="headerlink" title="9.3 s函数的设计与应用"></a>9.3 s函数的设计与应用</h2><blockquote>
<p>S函数： 系统函数，system function</p>
</blockquote>
<p>采用S函数实现y=kx+b。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%①主函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[sys,x0,str,ts]</span>=<span class="title">timekb</span><span class="params">(t,x,u,flag,k,b)</span></span></span><br><span class="line"><span class="keyword">switch</span> flag</span><br><span class="line">  <span class="keyword">case</span> <span class="number">0</span></span><br><span class="line">    [sys,x0,str,ts]=mdlInitializeSizes; <span class="comment">%初始化</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">3</span></span><br><span class="line">    sys=mdlOutputs(t,x,u,k,b);     <span class="comment">%计算输出量</span></span><br><span class="line">  <span class="keyword">case</span> &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>&#125;</span><br><span class="line">    sys=[];</span><br><span class="line">  <span class="keyword">otherwise</span>                <span class="comment">%出错处理</span></span><br><span class="line">    error(num2str(flag))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%②初始化子函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[sys,x0,str,ts]</span>=<span class="title">mdlInitializeSizes</span><span class="params">()</span></span></span><br><span class="line">sizes=simsizes;</span><br><span class="line">sizes.NumContStates=<span class="number">0</span>;  <span class="comment">%无连续状态</span></span><br><span class="line">sizes.NumDiscStates=<span class="number">0</span>;   <span class="comment">%无离散状态</span></span><br><span class="line">sizes.NumOutputs=<span class="number">1</span>;       <span class="comment">%有一个输出量</span></span><br><span class="line">sizes.NumInputs=<span class="number">1</span>;     <span class="comment">%有一个输入信号</span></span><br><span class="line">sizes.DirFeedthrough=<span class="number">1</span>;  <span class="comment">%输出量中含有输入量</span></span><br><span class="line">sizes.NumSampleTimes=<span class="number">1</span>;  <span class="comment">%单个采样周期</span></span><br><span class="line">sys=simsizes(sizes);</span><br><span class="line"><span class="comment">%给其他返回参数赋值</span></span><br><span class="line">x0=[];          <span class="comment">%设置初始状态为零状态</span></span><br><span class="line">str=[];          <span class="comment">%将str变量设置为空字符串</span></span><br><span class="line">ts=[<span class="number">-1</span>,<span class="number">0</span>];         <span class="comment">%假定继承输入信号的采样周期</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%③输出子函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sys</span>=<span class="title">mdlOutputs</span><span class="params">(t,x,u,k,b)</span></span></span><br><span class="line">sys=k*u+b;</span><br></pre></td></tr></table></figure>
<h2 id="9-4-simulink仿真应用举例"><a href="#9-4-simulink仿真应用举例" class="headerlink" title="9.4 simulink仿真应用举例"></a>9.4 simulink仿真应用举例</h2><p>仿真求解：</p>
<p>（1）求最大安全体重</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> m=<span class="number">100</span>:<span class="number">-0.5</span>:<span class="number">20</span></span><br><span class="line">  [t,x,y_w]=sim(<span class="string">&#x27;bengji&#x27;</span>,<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">100</span>);</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">min</span>(y_w)&gt;<span class="number">1.5</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;最大安全体重是&#x27;</span>,num2str(m)])</span><br><span class="line">dis=<span class="built_in">min</span>(y_w);</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;最小的安全距离是&#x27;</span>,num2str(dis)])</span><br><span class="line"><span class="built_in">plot</span>(t,y_w)</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<p>（2）求最小弹性系数</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">m=<span class="number">65</span>; </span><br><span class="line"><span class="keyword">for</span> k=<span class="number">10</span>:<span class="number">0.1</span>:<span class="number">50</span></span><br><span class="line">  [t,x,y_w]=sim(<span class="string">&#x27;bengji&#x27;</span>,<span class="number">0</span>:<span class="number">0.01</span>:<span class="number">100</span>);</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">min</span>(y_w)&gt;<span class="number">1.5</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;最小弹性系数k是&#x27;</span>,num2str(k)])</span><br><span class="line">dis=<span class="built_in">min</span>(y_w);</span><br><span class="line"><span class="built_in">disp</span>([<span class="string">&#x27;最小的安全距离是&#x27;</span>,num2str(dis)])</span><br><span class="line"><span class="built_in">plot</span>(t,y_w)</span><br><span class="line">grid on</span><br></pre></td></tr></table></figure>
<h2 id="专题九总结"><a href="#专题九总结" class="headerlink" title="专题九总结"></a>专题九总结</h2><h1 id="10-外部程序接口"><a href="#10-外部程序接口" class="headerlink" title="10 外部程序接口"></a>10 外部程序接口</h1><h2 id="10-1-在Excel中使用matlab"><a href="#10-1-在Excel中使用matlab" class="headerlink" title="10.1 在Excel中使用matlab"></a>10.1 在Excel中使用matlab</h2><p>Spreadsheet Link</p>
<h2 id="10-2-matlab-文件操作"><a href="#10-2-matlab-文件操作" class="headerlink" title="10.2 matlab 文件操作"></a>10.2 matlab 文件操作</h2><ol>
<li>fid = fopen(filename,permission)<ul>
<li>fid, 文件识别号，不成功时为-1</li>
<li>permission，’r’，只读；’w’,写；’a’,追加；‘r+’,读写。</li>
</ul>
</li>
<li>status=fclose(fid)<ul>
<li>fid,文件标识号，为all时，关闭已所有打开的文件</li>
<li>status，0，关闭成功；-1，关闭不成功</li>
</ul>
</li>
<li>读写文本文件<ul>
<li><code>[A,count]=fscanf(fid,fmt,size)</code></li>
<li><code>count=fprintf(fid,fmt,A)</code></li>
</ul>
</li>
<li>读写二进制文件<ul>
<li><code>[A,count]=fread(fid,size,precision,skip)</code></li>
<li><code>count=fwrite(fid,A,precious)</code></li>
</ul>
</li>
<li>数据文件定位：文件位置指针<ul>
<li>fseek(fid,offset,origin)</li>
<li>ftell(fid)</li>
<li>status=feof(fid)</li>
</ul>
</li>
</ol>
<p>例1 文件“观测记录.txt”的内容如图所示，读取文件前10行的数据。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">fid=fopen(<span class="string">&#x27;观测记录.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">title=fscanf(fid,<span class="string">&#x27;%s&#x27;</span>,<span class="number">6</span>);</span><br><span class="line">qxsj=[];</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">10</span></span><br><span class="line">  qxsj&#123;<span class="built_in">i</span>,<span class="number">1</span>&#125;=fscanf(fid,<span class="string">&#x27;%s&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">  qxsj&#123;<span class="built_in">i</span>,<span class="number">2</span>&#125;=fscanf(fid,<span class="string">&#x27;%s&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">  qxsj&#123;<span class="built_in">i</span>,<span class="number">3</span>&#125;=fscanf(fid,<span class="string">&#x27;%f&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">  qxsj&#123;<span class="built_in">i</span>,<span class="number">4</span>&#125;=fscanf(fid,<span class="string">&#x27;%f&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">  qxsj&#123;<span class="built_in">i</span>,<span class="number">5</span>&#125;=fscanf(fid,<span class="string">&#x27;%f&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">  qxsj&#123;<span class="built_in">i</span>,<span class="number">6</span>&#125;=fscanf(fid,<span class="string">&#x27;%s&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">fclose(fid);</span><br></pre></td></tr></table></figure>
<p>例2 计算y=exp(x)sinx，其中x∈[0,2π]。将x、y写入二进制文件“模拟数据.dat”。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">fid=fopen(<span class="string">&#x27;模拟数据.dat&#x27;</span>,<span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">pi</span>,<span class="number">100</span>);</span><br><span class="line">y=<span class="built_in">exp</span>(x).*<span class="built_in">sin</span>(x);</span><br><span class="line">count=fwrite(fid, [x; y], <span class="string">&#x27;double&#x27;</span>);</span><br><span class="line">fclose(fid);</span><br></pre></td></tr></table></figure>
<p>例3 读取例2生成的文件中的后40组数据，并绘制图形。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">fid=fopen(<span class="string">&#x27;模拟数据.dat&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">status=fseek(fid, <span class="number">-40</span>*<span class="number">2</span>*<span class="number">8</span>, <span class="string">&#x27;eof&#x27;</span>);</span><br><span class="line">x=[]; y=[];</span><br><span class="line"><span class="keyword">while</span> ~feof(fid)</span><br><span class="line">  x=[x; fread(fid,<span class="number">1</span>,<span class="string">&#x27;double&#x27;</span>)];</span><br><span class="line">  y=[y; fread(fid,<span class="number">1</span>,<span class="string">&#x27;double&#x27;</span>)];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">plot</span>(x,y);</span><br><span class="line">fclose(fid);</span><br></pre></td></tr></table></figure>
<h2 id="10-3-在其他语言程序中读写matlab的数据文件"><a href="#10-3-在其他语言程序中读写matlab的数据文件" class="headerlink" title="10.3 在其他语言程序中读写matlab的数据文件"></a>10.3 在其他语言程序中读写matlab的数据文件</h2><blockquote>
<p><strong>接口函数</strong></p>
<p><strong>mat文件</strong>：matlab存储数据的标准格式；变量的名称、类型和值均保存。</p>
<ul>
<li>save</li>
<li>load</li>
<li></li>
</ul>
</blockquote>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mat.h&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> MATFile *pmat; <span class="comment">/* 定义MAT文件指针*/</span></span><br><span class="line"> mxArray *pa1, *pa2, *pa3;</span><br><span class="line">  <span class="comment">//定义要写入的数据</span></span><br><span class="line"> <span class="keyword">double</span> data[<span class="number">9</span>] = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>, <span class="number">4.4</span>, <span class="number">5.5</span>, <span class="number">6.6</span>, <span class="number">7.7</span>, <span class="number">8.8</span>, <span class="number">9.9</span>&#125;;</span><br><span class="line"> <span class="keyword">const</span> <span class="keyword">char</span> *file = <span class="string">&quot;mattest.mat&quot;</span>;<span class="comment">//定义要操作的文件</span></span><br><span class="line"> <span class="keyword">int</span> status; <span class="comment">//定义存储函数返回值的变量</span></span><br><span class="line"> <span class="comment">/* 打开一个MAT文件，如果不存在则创建一个MAT文件，如果打开失败，则返回 */</span></span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;生成文件 : &quot;</span> &lt;&lt; file &lt;&lt; endl;</span><br><span class="line"> pmat = <span class="built_in">matOpen</span>(file, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"> <span class="keyword">if</span> (pmat == <span class="literal">NULL</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;不能创建文件 : &quot;</span> &lt;&lt; file &lt;&lt; endl;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;(请确认是否有权限访问指定文件夹?)\n&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">/* 创建3个mxArray对象，其中pa1存储一个实数，pa2为3×3的双精度实型矩阵，*/</span></span><br><span class="line"> <span class="comment">/* pa3存储字符串，如果创建失败则返回 */</span></span><br><span class="line"> pa1 = <span class="built_in">mxCreateDoubleScalar</span>(<span class="number">1.234</span>);</span><br><span class="line"> <span class="keyword">if</span> (pa1 == <span class="literal">NULL</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;不能创建变量。\n&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> pa2 = <span class="built_in">mxCreateDoubleMatrix</span>(<span class="number">3</span>, <span class="number">3</span>, mxREAL);</span><br><span class="line"> <span class="keyword">if</span> (pa2 == <span class="literal">NULL</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;不能创建矩阵。\n&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="built_in">memcpy</span>((<span class="keyword">void</span> *)(<span class="built_in">mxGetPr</span>(pa2)), (<span class="keyword">void</span> *)data, <span class="built_in"><span class="keyword">sizeof</span></span>(data));</span><br><span class="line"> pa3 = <span class="built_in">mxCreateString</span>(<span class="string">&quot;MAT文件示例&quot;</span>);</span><br><span class="line"> <span class="keyword">if</span> (pa3 == <span class="literal">NULL</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;不能创建字符串。\n&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">/* 向MAT文件中写数据，失败则返回 */</span></span><br><span class="line"> status = <span class="built_in">matPutVariable</span>(pmat, <span class="string">&quot;LocalDouble&quot;</span>, pa1);</span><br><span class="line"> <span class="keyword">if</span> (status != <span class="number">0</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;写入局部变量时发生错误。\n &quot;</span> ;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> status = <span class="built_in">matPutVariableAsGlobal</span>(pmat, <span class="string">&quot;GlobalDouble&quot;</span>, pa2);</span><br><span class="line"> <span class="keyword">if</span> (status != <span class="number">0</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;写入全局变量时发生错误。\n&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> status = <span class="built_in">matPutVariable</span>(pmat, <span class="string">&quot;LocalString&quot;</span>, pa3);</span><br><span class="line"> <span class="keyword">if</span> (status != <span class="number">0</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;: 写入String类型数据时发生错误。\n &quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">/* 清除矩阵 */</span></span><br><span class="line"> <span class="built_in">mxDestroyArray</span>(pa1);</span><br><span class="line"> <span class="built_in">mxDestroyArray</span>(pa2);</span><br><span class="line"> <span class="built_in">mxDestroyArray</span>(pa3);</span><br><span class="line"> <span class="comment">/* 关闭MAT文件 */</span></span><br><span class="line"> <span class="keyword">if</span> (<span class="built_in">matClose</span>(pmat) != <span class="number">0</span>) &#123;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;关闭文件时发生错误 &quot;</span> &lt;&lt; endl;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> cout &lt;&lt; <span class="string">&quot;文件创建成功！\n&quot;</span>;</span><br><span class="line"> <span class="keyword">return</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="10-4-在matlab中调用其他语言编写的程序"><a href="#10-4-在matlab中调用其他语言编写的程序" class="headerlink" title="10.4 在matlab中调用其他语言编写的程序"></a>10.4 在matlab中调用其他语言编写的程序</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mex.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isCoprime</span><span class="params">(<span class="keyword">double</span> *inx,<span class="keyword">double</span> *outy)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="keyword">int</span> x=*inx,y=*outy,tmp;</span><br><span class="line">    <span class="keyword">if</span> (x&lt;y) </span><br><span class="line">    &#123;tmp=x; x=y; y=tmp;&#125;</span><br><span class="line">    tmp=x%y; </span><br><span class="line">    <span class="keyword">while</span> (tmp) </span><br><span class="line">    &#123; </span><br><span class="line">       x=y; y=tmp; tmp=x%y; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span> (y==<span class="number">1</span>)     <span class="comment">//最大公约数为1,所以互质 </span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">    <span class="keyword">else</span>       <span class="comment">//最大公约数大于1，所以不互质 </span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mexFunction</span><span class="params">( <span class="keyword">int</span> nlhs, mxArray *plhs[], <span class="keyword">int</span> nrhs, <span class="keyword">const</span> mxArray *prhs[] )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="keyword">double</span> *result;</span><br><span class="line"> <span class="keyword">int</span> m,n,i;</span><br><span class="line"> <span class="comment">//检查调用时输入、输出是否符合要求</span></span><br><span class="line"> <span class="keyword">if</span>(nrhs!=<span class="number">2</span>) &#123;</span><br><span class="line">   <span class="built_in">mexErrMsgTxt</span>(<span class="string">&quot;输入参数应有两个！&quot;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(nlhs!=<span class="number">1</span>) &#123;</span><br><span class="line">   <span class="built_in">mexErrMsgTxt</span>(<span class="string">&quot;输出参数应只有1个！&quot;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)&#123;</span><br><span class="line">   m = <span class="built_in"><span class="keyword">int</span></span>(<span class="built_in">mxGetM</span>(prhs[i]));</span><br><span class="line">   n = <span class="built_in"><span class="keyword">int</span></span>(<span class="built_in">mxGetN</span>(prhs[i]));</span><br><span class="line">   <span class="keyword">if</span>( !<span class="built_in">mxIsDouble</span>(prhs[i]) || m!=<span class="number">1</span> || n!=<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">mexErrMsgTxt</span>(<span class="string">&quot;输入参数必须是单个的数！&quot;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> <span class="comment">//在MATLAB工作区建立一个矩阵，用于存放计算结果，</span></span><br><span class="line"> <span class="comment">//矩阵的大小与输入实参的大小相同。 </span></span><br><span class="line"> plhs[<span class="number">0</span>] = <span class="built_in">mxCreateDoubleMatrix</span>(m,n, mxREAL);</span><br><span class="line"> result = <span class="built_in">mxGetPr</span>(plhs[<span class="number">0</span>]);</span><br><span class="line"> <span class="keyword">if</span> (<span class="built_in">isCoprime</span>(<span class="built_in">mxGetPr</span>(prhs[<span class="number">0</span>]),<span class="built_in">mxGetPr</span>(prhs[<span class="number">1</span>])))</span><br><span class="line">   *result=<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">   *result=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="10-5-在其他语言程序中调用matlab函数"><a href="#10-5-在其他语言程序中调用matlab函数" class="headerlink" title="10.5 在其他语言程序中调用matlab函数"></a>10.5 在其他语言程序中调用matlab函数</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;engine.h&gt;</span></span></span><br><span class="line">\<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//定义一个engine类型的指针ep，用于操作引擎对象。</span></span><br><span class="line">  Engine *ep; </span><br><span class="line">  <span class="comment">//定义mxArray 类型的指针，用于指向所调用MATLAB函数的输入对象。</span></span><br><span class="line">  mxArray *T = <span class="literal">NULL</span>, *R = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="comment">//定义存储数据的变量，并按给定表达式生成数据。</span></span><br><span class="line">  <span class="keyword">double</span> t[<span class="number">180</span>],r[<span class="number">180</span>];</span><br><span class="line">  <span class="keyword">double</span> a,b;</span><br><span class="line">  a=<span class="number">2</span>;b=<span class="number">3</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">180</span>;i++)  &#123;</span><br><span class="line">    t[i]=i*<span class="number">0.1</span>;</span><br><span class="line">    r[i]=a+b*t[i]; &#125;</span><br><span class="line">  <span class="comment">//启动MATLAB计算引擎</span></span><br><span class="line">  <span class="comment">//Windows系统中，engOpen函数的参数为空字符串，指定在本机启动计算引擎。 </span></span><br><span class="line">  <span class="keyword">if</span> (!(ep = <span class="built_in">engOpen</span>(<span class="string">&quot;&quot;</span>)))  &#123;</span><br><span class="line">    cout&lt;&lt; <span class="string">&quot;\n不能启动MATLAB引擎\n&quot;</span>; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//建立MATLAB变量，调用MATLAB函数</span></span><br><span class="line">  T = <span class="built_in">mxCreateDoubleMatrix</span>(<span class="number">1</span>, <span class="number">180</span>, mxREAL);</span><br><span class="line">  <span class="built_in">memcpy</span>((<span class="keyword">void</span> *)<span class="built_in">mxGetPr</span>(T), (<span class="keyword">void</span> *)t, <span class="built_in"><span class="keyword">sizeof</span></span>(t));</span><br><span class="line">  <span class="built_in">engPutVariable</span>(ep, <span class="string">&quot;T&quot;</span>, T); </span><br><span class="line">  R = <span class="built_in">mxCreateDoubleMatrix</span>(<span class="number">1</span>, <span class="number">180</span>, mxREAL);</span><br><span class="line">  <span class="built_in">memcpy</span>((<span class="keyword">void</span> *)<span class="built_in">mxGetPr</span>(R), (<span class="keyword">void</span> *)r, <span class="built_in"><span class="keyword">sizeof</span></span>(r));</span><br><span class="line">  <span class="built_in">engPutVariable</span>(ep, <span class="string">&quot;R&quot;</span>, R); </span><br><span class="line">  <span class="built_in">engEvalString</span>(ep, <span class="string">&quot;polar(T,R);&quot;</span>);</span><br><span class="line">  <span class="built_in">engEvalString</span>(ep, <span class="string">&quot;title(&#x27;阿基米德螺线&#x27;);&quot;</span>);  </span><br><span class="line">  <span class="comment">//释放内存空间，关闭计算引擎</span></span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="built_in">mxDestroyArray</span>(T);</span><br><span class="line">  <span class="built_in">mxDestroyArray</span>(R);</span><br><span class="line">  <span class="built_in">engClose</span>(ep);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="专题十总结"><a href="#专题十总结" class="headerlink" title="专题十总结"></a>专题十总结</h2><h1 id="其他学习资源"><a href="#其他学习资源" class="headerlink" title="其他学习资源"></a>其他学习资源</h1><p><a href="https://matlabacademy.mathworks.com/cn">https://matlabacademy.mathworks.com/cn</a></p>
<p><a href="https://ww2.mathworks.cn/videos/getting-started-with-matlab-68985.html">https://ww2.mathworks.cn/videos/getting-started-with-matlab-68985.html</a></p>
]]></content>
  </entry>
</search>
